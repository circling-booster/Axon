{"version":3,"file":"index.js","sources":["../../electron/main/state.ts","../../node_modules/env-paths/index.js","../../electron/main/constant.ts","../../electron/main/store.ts","../../electron/main/service.ts","../../electron/main/util.ts","../../shared/oap.ts","../../node_modules/ws/lib/constants.js","../../node_modules/ws/lib/buffer-util.js","../../node_modules/ws/lib/limiter.js","../../node_modules/ws/lib/permessage-deflate.js","../../node_modules/ws/lib/validation.js","../../node_modules/ws/lib/receiver.js","../../node_modules/ws/lib/sender.js","../../node_modules/ws/lib/event-target.js","../../node_modules/ws/lib/extension.js","../../node_modules/ws/lib/websocket.js","../../node_modules/ws/lib/stream.js","../../node_modules/ws/lib/subprotocol.js","../../node_modules/ws/lib/websocket-server.js","../../electron/main/oap.ts","../../electron/main/update.ts","../../electron/main/ipc/env.ts","../../electron/main/platform/appimage.ts","../../electron/main/tray.ts","../../electron/main/ipc/system.ts","../../electron/main/deeplink.ts","../../node_modules/which/node_modules/isexe/dist/cjs/posix.js","../../node_modules/which/node_modules/isexe/dist/cjs/win32.js","../../node_modules/which/node_modules/isexe/dist/cjs/options.js","../../node_modules/which/node_modules/isexe/dist/cjs/index.js","../../node_modules/which/lib/index.js","../../node_modules/mime-db/index.js","../../node_modules/mime-types/index.js","../../electron/main/ipc/util.ts","../../electron/main/ipc/llm.ts","../../electron/main/ipc/menu.ts","../../electron/main/ipc/oap.ts","../../electron/main/ipc/lipc.ts","../../electron/main/ipc/index.ts","../../electron/main/protocol.ts","../../node_modules/electron-log/src/node/packageJson.js","../../node_modules/electron-log/src/node/NodeExternalApi.js","../../node_modules/electron-log/src/main/ElectronExternalApi.js","../../node_modules/electron-log/src/renderer/electron-log-preload.js","../../node_modules/electron-log/src/main/initialize.js","../../node_modules/electron-log/src/core/scope.js","../../node_modules/electron-log/src/core/Buffering.js","../../node_modules/electron-log/src/core/Logger.js","../../node_modules/electron-log/src/node/ErrorHandler.js","../../node_modules/electron-log/src/node/EventLogger.js","../../node_modules/electron-log/src/core/transforms/transform.js","../../node_modules/electron-log/src/core/transforms/format.js","../../node_modules/electron-log/src/node/transforms/object.js","../../node_modules/electron-log/src/core/transforms/style.js","../../node_modules/electron-log/src/node/transports/console.js","../../node_modules/electron-log/src/node/transports/file/File.js","../../node_modules/electron-log/src/node/transports/file/NullFile.js","../../node_modules/electron-log/src/node/transports/file/FileRegistry.js","../../node_modules/electron-log/src/node/transports/file/index.js","../../node_modules/electron-log/src/node/transports/ipc.js","../../node_modules/electron-log/src/node/transports/remote.js","../../node_modules/electron-log/src/node/createDefaultLogger.js","../../node_modules/electron-log/src/main/index.js","../../node_modules/electron-log/main.js","../../electron/main/server.ts","../../electron/main/index.ts"],"sourcesContent":["class AppState {\r\n  public isQuitting = true\r\n\r\n  public setIsQuitting(isQuitting: boolean) {\r\n    this.isQuitting = isQuitting\r\n  }\r\n}\r\n\r\nexport default new AppState()\r\n","import path from 'node:path';\nimport os from 'node:os';\nimport process from 'node:process';\n\nconst homedir = os.homedir();\nconst tmpdir = os.tmpdir();\nconst {env} = process;\n\nconst macos = name => {\n\tconst library = path.join(homedir, 'Library');\n\n\treturn {\n\t\tdata: path.join(library, 'Application Support', name),\n\t\tconfig: path.join(library, 'Preferences', name),\n\t\tcache: path.join(library, 'Caches', name),\n\t\tlog: path.join(library, 'Logs', name),\n\t\ttemp: path.join(tmpdir, name),\n\t};\n};\n\nconst windows = name => {\n\tconst appData = env.APPDATA || path.join(homedir, 'AppData', 'Roaming');\n\tconst localAppData = env.LOCALAPPDATA || path.join(homedir, 'AppData', 'Local');\n\n\treturn {\n\t\t// Data/config/cache/log are invented by me as Windows isn't opinionated about this\n\t\tdata: path.join(localAppData, name, 'Data'),\n\t\tconfig: path.join(appData, name, 'Config'),\n\t\tcache: path.join(localAppData, name, 'Cache'),\n\t\tlog: path.join(localAppData, name, 'Log'),\n\t\ttemp: path.join(tmpdir, name),\n\t};\n};\n\n// https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\nconst linux = name => {\n\tconst username = path.basename(homedir);\n\n\treturn {\n\t\tdata: path.join(env.XDG_DATA_HOME || path.join(homedir, '.local', 'share'), name),\n\t\tconfig: path.join(env.XDG_CONFIG_HOME || path.join(homedir, '.config'), name),\n\t\tcache: path.join(env.XDG_CACHE_HOME || path.join(homedir, '.cache'), name),\n\t\t// https://wiki.debian.org/XDGBaseDirectorySpecification#state\n\t\tlog: path.join(env.XDG_STATE_HOME || path.join(homedir, '.local', 'state'), name),\n\t\ttemp: path.join(tmpdir, username, name),\n\t};\n};\n\nexport default function envPaths(name, {suffix = 'nodejs'} = {}) {\n\tif (typeof name !== 'string') {\n\t\tthrow new TypeError(`Expected a string, got ${typeof name}`);\n\t}\n\n\tif (suffix) {\n\t\t// Add suffix to prevent possible conflict with native apps\n\t\tname += `-${suffix}`;\n\t}\n\n\tif (process.platform === 'darwin') {\n\t\treturn macos(name);\n\t}\n\n\tif (process.platform === 'win32') {\n\t\treturn windows(name);\n\t}\n\n\treturn linux(name);\n}\n","import { app } from \"electron\"\r\nimport envPaths from \"env-paths\"\r\nimport os from \"os\"\r\nimport path from \"path\"\r\nimport { fileURLToPath } from \"url\"\r\n\r\nexport const __dirname = path.dirname(fileURLToPath(import.meta.url))\r\n\r\n// The built directory structure\r\n//\r\n// ├─┬ dist-electron\r\n// │ ├─┬ main\r\n// │ │ └── index.js    > Electron-Main\r\n// │ └─┬ preload\r\n// │   └── index.mjs   > Preload-Scripts\r\n// ├─┬ dist\r\n// │ └── index.html    > Electron-Renderer\r\n//\r\nprocess.env.APP_ROOT = path.join(__dirname, \"../..\")\r\n\r\nexport const MAIN_DIST = path.join(process.env.APP_ROOT, \"dist-electron\")\r\nexport const RENDERER_DIST = path.join(process.env.APP_ROOT, \"dist\")\r\nexport const VITE_DEV_SERVER_URL = process.env.VITE_DEV_SERVER_URL\r\n\r\nprocess.env.VITE_PUBLIC = VITE_DEV_SERVER_URL\r\n  ? path.join(process.env.APP_ROOT, \"public\")\r\n  : RENDERER_DIST\r\n\r\nexport const envPath = envPaths(app.getName(), {suffix: \"\"})\r\nexport const cacheDir = envPath.cache\r\nexport const homeDir = os.homedir()\r\nexport const appDir = path.join(homeDir, \".dive\")\r\nexport const scriptsDir = path.join(appDir, \"scripts\")\r\nexport const configDir = app.isPackaged ? path.join(appDir, \"config\") : path.join(process.cwd(), \".config\")\r\nexport const hostCacheDir = path.join(appDir, \"host_cache\")\r\nexport const logDir = path.join(appDir, \"log\")\r\n\r\nexport const binDirList = [\r\n  path.join(process.resourcesPath, \"node\"),\r\n  path.join(process.resourcesPath, \"uv\"),\r\n  path.join(process.resourcesPath, \"python\", \"bin\"),\r\n]\r\n\r\nexport const darwinPathList = [\r\n  \"/opt/homebrew/bin\",\r\n  \"/usr/local/bin\",\r\n  \"/usr/bin\",\r\n  path.join(process.resourcesPath, \"node\", \"bin\"),\r\n  path.join(process.resourcesPath, \"uv\"),\r\n]\r\n\r\nexport const DEF_MCP_SERVER_NAME = \"__SYSTEM_DIVE_SERVER__\"\r\n\r\nexport const DEF_MCP_BIN_NAME = process.platform === \"win32\"\r\n  ? \"dive-mcp.exe\"\r\n  : process.platform === \"darwin\"\r\n    ? process.arch === \"arm64\" ? \"dive-mcp-aarch64\" : \"dive-mcp-x86_64\"\r\n    : \"dive-mcp\"\r\n\r\nexport const getDefMcpBinPath = () => {\r\n  if (app.isPackaged) {\r\n    return path.join(process.resourcesPath, \"prebuilt\", DEF_MCP_BIN_NAME)\r\n  }\r\n  return path.join(process.cwd(), \"target\", \"release\", DEF_MCP_BIN_NAME)\r\n}\r\n\r\nexport const getDefMcpServerConfig = () => {\r\n  const defMcpBinPath = getDefMcpBinPath()\r\n  return {\r\n    \"mcpServers\": {\r\n      [DEF_MCP_SERVER_NAME]: {\r\n        \"transport\": \"stdio\",\r\n        \"enabled\": true,\r\n        \"command\": defMcpBinPath\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const DEF_MCP_SERVER_CONFIG = {\r\n  \"mcpServers\": {}\r\n}\r\n\r\nexport const DEF_MODEL_CONFIG = {\r\n  \"activeProvider\": \"none\",\r\n  \"configs\": {},\r\n  \"enableTools\": true\r\n}\r\n\r\nexport const DEF_PLUGIN_CONFIG = [\r\n  {\r\n    \"name\": \"oap-platform\",\r\n    \"module\": \"dive_mcp_host.oap_plugin\",\r\n    \"config\": {},\r\n    \"ctx_manager\": \"dive_mcp_host.oap_plugin.OAPPlugin\",\r\n    \"static_callbacks\": \"dive_mcp_host.oap_plugin.get_static_callbacks\"\r\n  }\r\n]\r\n\r\nconst dbPath = path.join(configDir, \"db.sqlite\")\r\nexport const DEF_DIVE_HTTPD_CONFIG = {\r\n  \"db\": {\r\n    \"uri\": `sqlite:///${dbPath}`,\r\n    \"pool_size\": 5,\r\n    \"pool_recycle\": 60,\r\n    \"max_overflow\": 10,\r\n    \"echo\": false,\r\n    \"pool_pre_ping\": true,\r\n    \"migrate\": true\r\n  },\r\n  \"checkpointer\": {\r\n    \"uri\": `sqlite:///${dbPath}`\r\n  }\r\n}\r\n\r\nexport const cwd = app.isPackaged ? path.join(__dirname, \"../..\") : process.cwd()\r\n","import Store from \"electron-store\"\r\n\r\nexport const preferencesStore = new Store({\r\n  name: \"preferences\",\r\n  defaults: {\r\n    autoLaunch: false,\r\n    minimalToTray: true,\r\n  }\r\n})\r\n\r\nexport const oapStore = new Store({\r\n  name: \"oap\",\r\n  defaults: {\r\n    oap: {\r\n      token: \"\",\r\n    }\r\n  }\r\n})\r\n\r\nexport const hostCache = new Store({\r\n  name: \"host-cache\",\r\n  defaults: {\r\n    lockHash: \"\",\r\n  }\r\n})","import packageJson from \"../../package.json\"\r\nimport { app, BrowserWindow } from \"electron\"\r\nimport path from \"node:path\"\r\nimport fse, { mkdirp } from \"fs-extra\"\r\nimport {\r\n  configDir,\r\n  DEF_MCP_SERVER_CONFIG,\r\n  cwd,\r\n  DEF_MODEL_CONFIG,\r\n  DEF_DIVE_HTTPD_CONFIG,\r\n  hostCacheDir,\r\n  __dirname,\r\n  envPath,\r\n  VITE_DEV_SERVER_URL,\r\n  DEF_PLUGIN_CONFIG,\r\n  DEF_MCP_SERVER_NAME,\r\n  getDefMcpBinPath,\r\n} from \"./constant.js\"\r\nimport spawn from \"cross-spawn\"\r\nimport { ChildProcess, SpawnOptions, StdioOptions } from \"node:child_process\"\r\nimport { EventEmitter } from \"node:events\"\r\nimport { Writable } from \"node:stream\"\r\nimport crypto from \"node:crypto\"\r\nimport { hostCache } from \"./store.js\"\r\n\r\nconst baseConfigDir = app.isPackaged ? configDir : path.join(__dirname, \"..\", \"..\", \".config\")\r\n\r\nconst onServiceUpCallbacks: ((ip: string, port: number) => Promise<void>)[] = []\r\nexport const clearServiceUpCallbacks = () => onServiceUpCallbacks.length = 0\r\nexport const setServiceUpCallback = (callback: (ip: string, port: number) => Promise<void>) => onServiceUpCallbacks.push(callback)\r\n\r\nexport const serviceStatus = {\r\n  ip: \"localhost\",\r\n  port: 0,\r\n}\r\n\r\nlet hostProcess: ChildProcess | null = null\r\nconst ipcEventEmitter = new EventEmitter()\r\n\r\nconst spawned: Set<ChildProcess> = new Set()\r\n\r\nlet installHostDependenciesLog: string[] = []\r\nexport const getInstallHostDependenciesLog = () => installHostDependenciesLog\r\n\r\nasync function initApp() {\r\n  // create dirs\r\n  await fse.mkdir(baseConfigDir, { recursive: true })\r\n\r\n  // create config file if not exists\r\n  const mcpServerConfigPath = path.join(baseConfigDir, \"mcp_config.json\")\r\n  const defMcpBinPath = getDefMcpBinPath()\r\n  const defMcpBinExists = await fse.pathExists(defMcpBinPath)\r\n  if (!defMcpBinExists) {\r\n    console.warn(\"defalut mcp server not found\")\r\n  }\r\n\r\n  // Use config with DEF_MCP_SERVER_NAME if the binary exists, otherwise use empty config\r\n  // const initialMcpConfig = defMcpBinExists ? getDefMcpServerConfig() : DEF_MCP_SERVER_CONFIG\r\n  const initialMcpConfig = DEF_MCP_SERVER_CONFIG\r\n  await createFileIfNotExists(mcpServerConfigPath, JSON.stringify(initialMcpConfig, null, 2))\r\n\r\n  // Check if DEF_MCP_SERVER_NAME exists in mcp_config.json, add it if missing\r\n  if (defMcpBinExists && await fse.pathExists(mcpServerConfigPath)) {\r\n    try {\r\n      const mcpConfig = await fse.readJSON(mcpServerConfigPath)\r\n      if (mcpConfig.mcpServers && !mcpConfig.mcpServers[DEF_MCP_SERVER_NAME]) {\r\n        mcpConfig.mcpServers[DEF_MCP_SERVER_NAME] = {\r\n          \"transport\": \"stdio\",\r\n          \"enabled\": true,\r\n          \"command\": defMcpBinPath\r\n        }\r\n        await fse.writeJSON(mcpServerConfigPath, mcpConfig, { spaces: 2 })\r\n        console.log(`added ${DEF_MCP_SERVER_NAME} to mcp_config.json`)\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to check/update mcp_config.json:\", error)\r\n    }\r\n  }\r\n\r\n  // create custom rules file if not exists\r\n  const customRulesPath = path.join(baseConfigDir, \"customrules\")\r\n  await createFileIfNotExists(customRulesPath, \"\")\r\n\r\n  // create model config file if not exists\r\n  const modelConfigPath = path.join(baseConfigDir, \"model_config.json\")\r\n  await createFileIfNotExists(modelConfigPath, JSON.stringify(DEF_MODEL_CONFIG, null, 2))\r\n\r\n  // create dive_httpd config file if not exists\r\n  const diveHttpdConfigPath = path.join(baseConfigDir, \"dive_httpd.json\")\r\n  await createFileIfNotExists(diveHttpdConfigPath, JSON.stringify(DEF_DIVE_HTTPD_CONFIG, null, 2))\r\n\r\n  // create plugin config file if not exists\r\n  const pluginConfigPath = path.join(baseConfigDir, \"plugin_config.json\")\r\n  await createFileIfNotExists(pluginConfigPath, JSON.stringify(DEF_PLUGIN_CONFIG, null, 2))\r\n\r\n  // create command alias file if not exists\r\n  const commandAliasPath = path.join(baseConfigDir, \"command_alias.json\")\r\n  await createFileIfNotExists(commandAliasPath, JSON.stringify(process.platform === \"win32\" && app.isPackaged ? {\r\n    \"npx\": path.join(process.resourcesPath, \"node\", \"npx.cmd\"),\r\n    \"npm\": path.join(process.resourcesPath, \"node\", \"npm.cmd\"),\r\n  } : {}, null, 2))\r\n}\r\n\r\nasync function createFileIfNotExists(_path: string, content: string) {\r\n  if (!(await fse.pathExists(_path))) {\r\n    console.log(\"creating file\", _path)\r\n    await fse.ensureDir(path.dirname(_path))\r\n    await fse.writeFile(_path, content)\r\n  }\r\n}\r\n\r\nexport async function initMCPClient(win: BrowserWindow) {\r\n  const handler = (message: any) => {\r\n    if (message.server.listen.port) {\r\n      serviceStatus.ip = message.server.listen.ip\r\n      serviceStatus.port = message.server.listen.port\r\n      win.webContents.send(\"app-port\", message.server.listen.port)\r\n      ipcEventEmitter.off(\"ipc\", handler)\r\n\r\n      // wait for the service to be ready\r\n      setTimeout(() => {\r\n        // call the callback\r\n        onServiceUpCallbacks.forEach((callback) =>\r\n          callback(message.server.listen.ip, message.server.listen.port)\r\n            .catch((error) => console.error(\"Failed to call service up callback:\", error)))\r\n        clearServiceUpCallbacks()\r\n      }, 100)\r\n    }\r\n  }\r\n  ipcEventEmitter.on(\"ipc\", handler)\r\n\r\n  await initApp().catch(console.error)\r\n  await installHostDependencies(win).catch(console.error)\r\n  await startHostService().catch(console.error)\r\n}\r\n\r\nexport async function cleanup() {\r\n  console.log(\"cleanup\")\r\n\r\n  for (const child of spawned) {\r\n    if (!child.killed) {\r\n      child.kill(\"SIGTERM\")\r\n    }\r\n  }\r\n  spawned.clear()\r\n\r\n  if (hostProcess) {\r\n    console.log(\"killing host process\")\r\n    hostProcess.kill(\"SIGTERM\")\r\n    await new Promise(resolve => setTimeout(resolve, 100))\r\n    if (!hostProcess.killed) {\r\n      console.log(\"killing host process again\")\r\n      hostProcess?.kill(\"SIGKILL\")\r\n    }\r\n  }\r\n\r\n  // reset bus\r\n  await fse.writeFile(path.join(hostCacheDir, \"bus\"), \"\")\r\n}\r\n\r\nasync function startHostService() {\r\n  const isWindows = process.platform === \"win32\"\r\n  const resourcePath = app.isPackaged ? process.resourcesPath : cwd\r\n  const pyBinPath = path.join(resourcePath, \"python\", \"bin\")\r\n  const pyPath = isWindows ? path.join(resourcePath, \"python\", \"python.exe\") : path.join(pyBinPath, \"python3\")\r\n  const hostDepsPath = path.join(hostCacheDir, \"deps\")\r\n  const hostSrcPath = path.join(resourcePath, \"mcp-host\")\r\n\r\n  const httpdExec = app.isPackaged ? pyPath : \"uv\"\r\n  const httpdParam = app.isPackaged\r\n    ? process.platform === \"darwin\"\r\n      ? [\"-I\", path.join(pyBinPath, \"dive_httpd\")]\r\n      : [\"-I\", \"-c\", `import site; site.addsitedir('${hostSrcPath.replace(/\\\\/g, \"\\\\\\\\\")}'); site.addsitedir('${hostDepsPath.replace(/\\\\/g, \"\\\\\\\\\")}'); from dive_mcp_host.httpd._main import main; main()`]\r\n    : [\"run\", \"dive_httpd\"]\r\n\r\n  const httpdEnv: any = {\r\n    ...process.env,\r\n    DIVE_CONFIG_DIR: baseConfigDir,\r\n    RESOURCE_DIR: hostCacheDir,\r\n    DIVE_USER_AGENT: `Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Dive/${packageJson.version} (+https://github.com/OpenAgentPlatform/Dive)`,\r\n  }\r\n\r\n  console.log(\"httpd executing path: \", httpdExec)\r\n\r\n  const busPath = path.join(hostCacheDir, \"bus\")\r\n  await createFileIfNotExists(busPath, \"\")\r\n  if (process.platform !== \"win32\") {\r\n    await fse.chmod(busPath, 0o666)\r\n  }\r\n\r\n  fse.watch(busPath, async (eventType, filename) => {\r\n    if (!filename)\r\n      return\r\n\r\n    if (eventType !== \"change\")\r\n      return\r\n\r\n    const buffer = Buffer.alloc(1024 * 32)\r\n    await fse.read(await fse.open(busPath, \"r\"), buffer, 0, buffer.length, 0)\r\n\r\n    if (!buffer.length)\r\n      return\r\n\r\n    try {\r\n      const content = buffer.toString().trim().replace(/\\0/g, \"\")\r\n      if (!content)\r\n        return\r\n\r\n      const message = JSON.parse(content)\r\n      if (message) {\r\n        ipcEventEmitter.emit(\"ipc\", message)\r\n        console.log(\"received message from host service\", message)\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to parse bus content:\", buffer.toString().trim(), error)\r\n    }\r\n  })\r\n\r\n  const spawnParam = [\r\n    ...httpdParam,\r\n    \"--port\",\r\n    \"0\",\r\n    \"--report_status_file\",\r\n    busPath,\r\n    \"--cors\",\r\n    \"*\",\r\n    \"--log_dir\",\r\n    path.join(envPath.log, \"host\"),\r\n    \"--plugin_config\",\r\n    path.join(baseConfigDir, \"plugin_config.json\")\r\n  ]\r\n\r\n  const options: SpawnOptions = {\r\n    env: httpdEnv,\r\n    stdio: VITE_DEV_SERVER_URL ? \"inherit\" : \"pipe\",\r\n  }\r\n\r\n  if (VITE_DEV_SERVER_URL) {\r\n    options.cwd = path.join(__dirname, \"..\", \"..\", \"mcp-host\")\r\n  }\r\n\r\n  console.log(\"spawn host with\", httpdExec, spawnParam.join(\" \"))\r\n  hostProcess = spawn(httpdExec, spawnParam, options)\r\n\r\n  if (app.isPackaged) {\r\n    hostProcess?.stdout?.pipe(new Writable({\r\n      write(chunk, encoding, callback) {\r\n        console.log(\"[dived]\", chunk.toString())\r\n        callback()\r\n      }\r\n    }))\r\n\r\n    hostProcess?.stderr?.pipe(new Writable({\r\n      write(chunk, encoding, callback) {\r\n        const str = chunk.toString()\r\n        if (str.startsWith(\"INFO\") || str.startsWith(\"DEBUG\")) {\r\n          console.log(\"[dived]\", str)\r\n        } else if (str.startsWith(\"WARNING\")) {\r\n          console.warn(\"[dived]\", str)\r\n        } else {\r\n          console.error(\"[dived]\", str)\r\n        }\r\n        callback()\r\n      }\r\n    }))\r\n  }\r\n\r\n  hostProcess!.on(\"error\", (error) => {\r\n    console.error(\"Failed to start host process:\", error)\r\n  })\r\n\r\n  hostProcess!.on(\"close\", (code) => {\r\n    console.log(`host process exited with code ${code}`)\r\n  })\r\n\r\n  hostProcess!.on(\"spawn\", () => {\r\n    console.log(\"host process spawned\")\r\n  })\r\n}\r\n\r\nasync function installHostDependencies(win: BrowserWindow) {\r\n  const done = () => {\r\n    win.webContents.send(\"install-host-dependencies-log\", \"finish\")\r\n    installHostDependenciesLog = [\"finish\"]\r\n  }\r\n\r\n  if (!app.isPackaged || process.platform === \"darwin\") {\r\n    return done()\r\n  }\r\n\r\n  console.log(\"installing host dependencies\")\r\n  const isWindows = process.platform === \"win32\"\r\n  const pyBinPath = path.join(process.resourcesPath, \"python\", \"bin\")\r\n  const pyPath = isWindows ? path.join(process.resourcesPath, \"python\", \"python.exe\") : path.join(pyBinPath, \"python3\")\r\n  const uvPath = path.join(process.resourcesPath, \"uv\", isWindows ? \"uv.exe\" : \"uv\")\r\n  const requirementsPath = path.join(hostCacheDir, \"requirements.txt\")\r\n  const hostPath = path.join(process.resourcesPath, \"mcp-host\")\r\n\r\n  if (!(await fse.pathExists(path.join(hostPath, \"uv.lock\")))) {\r\n    return done()\r\n  }\r\n\r\n  const depsTargetPath = path.join(hostCacheDir, \"deps\")\r\n  const lockHash = await createMD5(path.join(hostPath, \"uv.lock\"))\r\n  if (lockHash === hostCache.get(\"lockHash\") && await fse.pathExists(depsTargetPath)) {\r\n    return done()\r\n  }\r\n\r\n  await mkdirp(depsTargetPath)\r\n\r\n  const pipParam = [\"pip\", \"install\", \"-r\", requirementsPath, \"--target\", depsTargetPath, \"--python\", pyPath]\r\n\r\n  return promiseSpawn(uvPath, [\"export\", \"-o\", requirementsPath], hostPath, \"ignore\")\r\n    .then(() => promiseSpawn(uvPath, pipParam, hostPath, \"pipe\", 60 * 1000 * 10, data => {\r\n      installHostDependenciesLog.push(data)\r\n      win.webContents.send(\"install-host-dependencies-log\", data)\r\n      hostCache.set(\"lockHash\", lockHash)\r\n    }))\r\n    .finally(done)\r\n}\r\n\r\nfunction promiseSpawn(command: string, args: any[], cwd: string, stdio: StdioOptions = \"inherit\", timeout = 60 * 1000 * 5, stdout?: (data: string) => void) {\r\n  return new Promise((resolve, reject) => {\r\n    // timeout after 5 minutes\r\n    setTimeout(reject, timeout)\r\n\r\n    const child = spawn(command, args, { cwd, stdio })\r\n    spawned.add(child)\r\n    child.on(\"close\", () => {\r\n      spawned.delete(child)\r\n      resolve(1)\r\n    })\r\n\r\n    child.on(\"error\", e => {\r\n      console.error(e)\r\n      spawned.delete(child)\r\n      reject(e)\r\n    })\r\n\r\n    child?.stdout?.pipe(new Writable({\r\n      write(chunk, encoding, callback) {\r\n        stdout?.(chunk.toString())\r\n        callback()\r\n      }\r\n    }))\r\n\r\n    child?.stderr?.pipe(new Writable({\r\n      write(chunk, encoding, callback) {\r\n        stdout?.(chunk.toString())\r\n        callback()\r\n      }\r\n    }))\r\n  })\r\n}\r\n\r\nfunction createMD5(filePath: string) {\r\n  return new Promise((res, _rej) => {\r\n    const hash = crypto.createHash(\"md5\")\r\n\r\n    const rStream = fse.createReadStream(filePath)\r\n    rStream.on(\"data\", (data) => {\r\n      hash.update(data)\r\n    })\r\n    rStream.on(\"end\", () => {\r\n      res(hash.digest(\"hex\"))\r\n    })\r\n  })\r\n}\r\n","import net from \"node:net\"\r\nimport path from \"node:path\"\r\nimport { spawn } from \"cross-spawn\"\r\nimport { app } from \"electron\"\r\nimport fse from \"fs-extra\"\r\nimport { exec } from \"node:child_process\"\r\n\r\nexport function isPortInUse(port: number): Promise<boolean> {\r\n  return new Promise((resolve) => {\r\n    const server = net.createServer()\r\n      .once(\"error\", (err: NodeJS.ErrnoException) => {\r\n        if (err.code === \"EADDRINUSE\") {\r\n          resolve(true)\r\n        }\r\n      })\r\n      .once(\"listening\", () => {\r\n        server.close()\r\n        resolve(false)\r\n      })\r\n      .listen(port)\r\n  })\r\n}\r\n\r\nexport function npmInstall(targetPath: string, args?: string[]): Promise<void> {\r\n  return new Promise((resolve, reject) => {\r\n    const npm = process.platform === \"win32\"\r\n      ? (app.isPackaged ? path.join(process.resourcesPath, \"node\", \"npm.cmd\") : \"npm.cmd\")\r\n      : \"npm\"\r\n\r\n    const installation = spawn(npm, args || [\"install\"], {\r\n      cwd: targetPath,\r\n      stdio: \"pipe\",\r\n      shell: process.platform === \"darwin\",\r\n      windowsHide: true,\r\n      windowsVerbatimArguments: true\r\n    })\r\n\r\n    installation.on(\"close\", (code) => {\r\n      if (code === 0) {\r\n        resolve()\r\n      } else {\r\n        reject(new Error(`npm install failed with code: ${code}`))\r\n      }\r\n    })\r\n\r\n    installation.on(\"error\", (err) => {\r\n      reject(err)\r\n    })\r\n  })\r\n}\r\n\r\nexport function modifyPath(customBinPath: string) {\r\n  const connector = process.platform === \"win32\" ? \";\" : \":\"\r\n  process.env.PATH = `${customBinPath}${connector}${process.env.PATH}`\r\n}\r\n\r\nexport function setNodePath() {\r\n  process.env.NODE_PATH = path.join(process.resourcesPath, \"node\", \"node_modules\")\r\n}\r\n\r\nexport function getLatestVersion(): Promise<string> {\r\n  return fetch(\"https://api.github.com/repos/OpenAgentPlatform/Dive/releases/latest\")\r\n    .then(res => res.json())\r\n    .then(data => data.tag_name.slice(1))\r\n}\r\n\r\nexport function compareFiles(filePath1: string, filePath2: string): boolean {\r\n  try {\r\n    const stat1 = fse.statSync(filePath1)\r\n    const stat2 = fse.statSync(filePath2)\r\n\r\n    // Compare size\r\n    if (stat1.size !== stat2.size) {\r\n      return false\r\n    }\r\n\r\n    // Compare modification time\r\n    if (stat1.mtimeMs !== stat2.mtimeMs) {\r\n      return false\r\n    }\r\n\r\n    // Files might be identical\r\n    return true\r\n  }\r\n  catch (error) {\r\n    console.error(\"Error comparing files:\", error);\r\n    return false\r\n  }\r\n}\r\n\r\nexport function compareFilesAndReplace(filePath1: string, filePath2: string) {\r\n  if (fse.existsSync(filePath1) && !compareFiles(filePath1, filePath2) || !fse.existsSync(filePath2)) {\r\n    fse.copyFileSync(filePath1, filePath2)\r\n  }\r\n}\r\n\r\nexport function getUnixSystemPath(): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    exec(\"echo $PATH\", (error, stdout, stderr) => {\r\n      if (error) {\r\n        reject(error)\r\n        return\r\n      }\r\n      resolve(stdout.trim())\r\n    })\r\n  })\r\n}\r\n","export const OAP_ROOT_URL = \"https://oaphub.ai\"\r\nexport const OAP_PROXY_URL = \"https://proxy.oaphub.ai\"\r\n","'use strict';\n\nconst BINARY_TYPES = ['nodebuffer', 'arraybuffer', 'fragments'];\nconst hasBlob = typeof Blob !== 'undefined';\n\nif (hasBlob) BINARY_TYPES.push('blob');\n\nmodule.exports = {\n  BINARY_TYPES,\n  EMPTY_BUFFER: Buffer.alloc(0),\n  GUID: '258EAFA5-E914-47DA-95CA-C5AB0DC85B11',\n  hasBlob,\n  kForOnEventAttribute: Symbol('kIsForOnEventAttribute'),\n  kListener: Symbol('kListener'),\n  kStatusCode: Symbol('status-code'),\n  kWebSocket: Symbol('websocket'),\n  NOOP: () => {}\n};\n","'use strict';\n\nconst { EMPTY_BUFFER } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\n\n/**\n * Merges an array of buffers into a new buffer.\n *\n * @param {Buffer[]} list The array of buffers to concat\n * @param {Number} totalLength The total length of buffers in the list\n * @return {Buffer} The resulting buffer\n * @public\n */\nfunction concat(list, totalLength) {\n  if (list.length === 0) return EMPTY_BUFFER;\n  if (list.length === 1) return list[0];\n\n  const target = Buffer.allocUnsafe(totalLength);\n  let offset = 0;\n\n  for (let i = 0; i < list.length; i++) {\n    const buf = list[i];\n    target.set(buf, offset);\n    offset += buf.length;\n  }\n\n  if (offset < totalLength) {\n    return new FastBuffer(target.buffer, target.byteOffset, offset);\n  }\n\n  return target;\n}\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nfunction _mask(source, mask, output, offset, length) {\n  for (let i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n}\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nfunction _unmask(buffer, mask) {\n  for (let i = 0; i < buffer.length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n}\n\n/**\n * Converts a buffer to an `ArrayBuffer`.\n *\n * @param {Buffer} buf The buffer to convert\n * @return {ArrayBuffer} Converted buffer\n * @public\n */\nfunction toArrayBuffer(buf) {\n  if (buf.length === buf.buffer.byteLength) {\n    return buf.buffer;\n  }\n\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.length);\n}\n\n/**\n * Converts `data` to a `Buffer`.\n *\n * @param {*} data The data to convert\n * @return {Buffer} The buffer\n * @throws {TypeError}\n * @public\n */\nfunction toBuffer(data) {\n  toBuffer.readOnly = true;\n\n  if (Buffer.isBuffer(data)) return data;\n\n  let buf;\n\n  if (data instanceof ArrayBuffer) {\n    buf = new FastBuffer(data);\n  } else if (ArrayBuffer.isView(data)) {\n    buf = new FastBuffer(data.buffer, data.byteOffset, data.byteLength);\n  } else {\n    buf = Buffer.from(data);\n    toBuffer.readOnly = false;\n  }\n\n  return buf;\n}\n\nmodule.exports = {\n  concat,\n  mask: _mask,\n  toArrayBuffer,\n  toBuffer,\n  unmask: _unmask\n};\n\n/* istanbul ignore else  */\nif (!process.env.WS_NO_BUFFER_UTIL) {\n  try {\n    const bufferUtil = require('bufferutil');\n\n    module.exports.mask = function (source, mask, output, offset, length) {\n      if (length < 48) _mask(source, mask, output, offset, length);\n      else bufferUtil.mask(source, mask, output, offset, length);\n    };\n\n    module.exports.unmask = function (buffer, mask) {\n      if (buffer.length < 32) _unmask(buffer, mask);\n      else bufferUtil.unmask(buffer, mask);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst kDone = Symbol('kDone');\nconst kRun = Symbol('kRun');\n\n/**\n * A very simple job queue with adjustable concurrency. Adapted from\n * https://github.com/STRML/async-limiter\n */\nclass Limiter {\n  /**\n   * Creates a new `Limiter`.\n   *\n   * @param {Number} [concurrency=Infinity] The maximum number of jobs allowed\n   *     to run concurrently\n   */\n  constructor(concurrency) {\n    this[kDone] = () => {\n      this.pending--;\n      this[kRun]();\n    };\n    this.concurrency = concurrency || Infinity;\n    this.jobs = [];\n    this.pending = 0;\n  }\n\n  /**\n   * Adds a job to the queue.\n   *\n   * @param {Function} job The job to run\n   * @public\n   */\n  add(job) {\n    this.jobs.push(job);\n    this[kRun]();\n  }\n\n  /**\n   * Removes a job from the queue and runs it if possible.\n   *\n   * @private\n   */\n  [kRun]() {\n    if (this.pending === this.concurrency) return;\n\n    if (this.jobs.length) {\n      const job = this.jobs.shift();\n\n      this.pending++;\n      job(this[kDone]);\n    }\n  }\n}\n\nmodule.exports = Limiter;\n","'use strict';\n\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./buffer-util');\nconst Limiter = require('./limiter');\nconst { kStatusCode } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst kPerMessageDeflate = Symbol('permessage-deflate');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} [options] Configuration options\n   * @param {(Boolean|Number)} [options.clientMaxWindowBits] Advertise support\n   *     for, or request, a custom client window size\n   * @param {Boolean} [options.clientNoContextTakeover=false] Advertise/\n   *     acknowledge disabling of client context takeover\n   * @param {Number} [options.concurrencyLimit=10] The number of concurrent\n   *     calls to zlib\n   * @param {(Boolean|Number)} [options.serverMaxWindowBits] Request/confirm the\n   *     use of a custom server window size\n   * @param {Boolean} [options.serverNoContextTakeover=false] Request/accept\n   *     disabling of server context takeover\n   * @param {Number} [options.threshold=1024] Size (in bytes) below which\n   *     messages should not be compressed if context takeover is disabled\n   * @param {Object} [options.zlibDeflateOptions] Options to pass to zlib on\n   *     deflate\n   * @param {Object} [options.zlibInflateOptions] Options to pass to zlib on\n   *     inflate\n   * @param {Boolean} [isServer=false] Create the instance in either server or\n   *     client mode\n   * @param {Number} [maxPayload=0] The maximum allowed message length\n   */\n  constructor(options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold =\n      this._options.threshold !== undefined ? this._options.threshold : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency =\n        this._options.concurrencyLimit !== undefined\n          ? this._options.concurrencyLimit\n          : 10;\n      zlibLimiter = new Limiter(concurrency);\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName() {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create an extension negotiation offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer() {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept an extension negotiation offer/response.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept(configurations) {\n    configurations = this.normalizeParams(configurations);\n\n    this.params = this._isServer\n      ? this.acceptAsServer(configurations)\n      : this.acceptAsClient(configurations);\n\n    return this.params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup() {\n    if (this._inflate) {\n      this._inflate.close();\n      this._inflate = null;\n    }\n\n    if (this._deflate) {\n      const callback = this._deflate[kCallback];\n\n      this._deflate.close();\n      this._deflate = null;\n\n      if (callback) {\n        callback(\n          new Error(\n            'The deflate stream was closed while data was being processed'\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   *  Accept an extension negotiation offer.\n   *\n   * @param {Array} offers The extension negotiation offers\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer(offers) {\n    const opts = this._options;\n    const accepted = offers.find((params) => {\n      if (\n        (opts.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (params.server_max_window_bits &&\n          (opts.serverMaxWindowBits === false ||\n            (typeof opts.serverMaxWindowBits === 'number' &&\n              opts.serverMaxWindowBits > params.server_max_window_bits))) ||\n        (typeof opts.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!accepted) {\n      throw new Error('None of the extension offers can be accepted');\n    }\n\n    if (opts.serverNoContextTakeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (opts.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof opts.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = opts.serverMaxWindowBits;\n    }\n    if (typeof opts.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = opts.clientMaxWindowBits;\n    } else if (\n      accepted.client_max_window_bits === true ||\n      opts.clientMaxWindowBits === false\n    ) {\n      delete accepted.client_max_window_bits;\n    }\n\n    return accepted;\n  }\n\n  /**\n   * Accept the extension negotiation response.\n   *\n   * @param {Array} response The extension negotiation response\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient(response) {\n    const params = response[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Unexpected parameter \"client_no_context_takeover\"');\n    }\n\n    if (!params.client_max_window_bits) {\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        params.client_max_window_bits = this._options.clientMaxWindowBits;\n      }\n    } else if (\n      this._options.clientMaxWindowBits === false ||\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        params.client_max_window_bits > this._options.clientMaxWindowBits)\n    ) {\n      throw new Error(\n        'Unexpected or invalid parameter \"client_max_window_bits\"'\n      );\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize parameters.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Array} The offers/response with normalized parameters\n   * @private\n   */\n  normalizeParams(configurations) {\n    configurations.forEach((params) => {\n      Object.keys(params).forEach((key) => {\n        let value = params[key];\n\n        if (value.length > 1) {\n          throw new Error(`Parameter \"${key}\" must have only a single value`);\n        }\n\n        value = value[0];\n\n        if (key === 'client_max_window_bits') {\n          if (value !== true) {\n            const num = +value;\n            if (!Number.isInteger(num) || num < 8 || num > 15) {\n              throw new TypeError(\n                `Invalid value for parameter \"${key}\": ${value}`\n              );\n            }\n            value = num;\n          } else if (!this._isServer) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else if (key === 'server_max_window_bits') {\n          const num = +value;\n          if (!Number.isInteger(num) || num < 8 || num > 15) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n          value = num;\n        } else if (\n          key === 'client_no_context_takeover' ||\n          key === 'server_no_context_takeover'\n        ) {\n          if (value !== true) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else {\n          throw new Error(`Unknown parameter \"${key}\"`);\n        }\n\n        params[key] = value;\n      });\n    });\n\n    return configurations;\n  }\n\n  /**\n   * Decompress data. Concurrency limited.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress(data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({\n        ...this._options.zlibInflateOptions,\n        windowBits\n      });\n      this._inflate[kPerMessageDeflate] = this;\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (this._inflate._readableState.endEmitted) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n\n        if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n          this._inflate.reset();\n        }\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress(data, fin, callback) {\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        ...this._options.zlibDeflateOptions,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kCallback] = callback;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      if (!this._deflate) {\n        //\n        // The deflate stream was closed while data was being processed.\n        //\n        return;\n      }\n\n      let data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) {\n        data = new FastBuffer(data.buffer, data.byteOffset, data.length - 4);\n      }\n\n      //\n      // Ensure that the callback will not be called again in\n      // `PerMessageDeflate#cleanup()`.\n      //\n      this._deflate[kCallback] = null;\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n        this._deflate.reset();\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData(chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData(chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kPerMessageDeflate]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kPerMessageDeflate]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new RangeError('Max payload size exceeded');\n  this[kError].code = 'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH';\n  this[kError][kStatusCode] = 1009;\n  this.removeListener('data', inflateOnData);\n\n  //\n  // The choice to employ `zlib.reset()` over `zlib.close()` is dictated by the\n  // fact that in Node.js versions prior to 13.10.0, the callback for\n  // `zlib.flush()` is not called if `zlib.close()` is used. Utilizing\n  // `zlib.reset()` ensures that either the callback is invoked or an error is\n  // emitted.\n  //\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError(err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kPerMessageDeflate]._inflate = null;\n\n  if (this[kError]) {\n    this[kCallback](this[kError]);\n    return;\n  }\n\n  err[kStatusCode] = 1007;\n  this[kCallback](err);\n}\n","'use strict';\n\nconst { isUtf8 } = require('buffer');\n\nconst { hasBlob } = require('./constants');\n\n//\n// Allowed token characters:\n//\n// '!', '#', '$', '%', '&', ''', '*', '+', '-',\n// '.', 0-9, A-Z, '^', '_', '`', a-z, '|', '~'\n//\n// tokenChars[32] === 0 // ' '\n// tokenChars[33] === 1 // '!'\n// tokenChars[34] === 0 // '\"'\n// ...\n//\n// prettier-ignore\nconst tokenChars = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0 - 15\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 16 - 31\n  0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, // 32 - 47\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, // 48 - 63\n  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 64 - 79\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, // 80 - 95\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 96 - 111\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0 // 112 - 127\n];\n\n/**\n * Checks if a status code is allowed in a close frame.\n *\n * @param {Number} code The status code\n * @return {Boolean} `true` if the status code is valid, else `false`\n * @public\n */\nfunction isValidStatusCode(code) {\n  return (\n    (code >= 1000 &&\n      code <= 1014 &&\n      code !== 1004 &&\n      code !== 1005 &&\n      code !== 1006) ||\n    (code >= 3000 && code <= 4999)\n  );\n}\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction _isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0) {\n      // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {\n      // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0 // Overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {\n      // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80) || // Overlong\n        (buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0) // Surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {\n      // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80) || // Overlong\n        (buf[i] === 0xf4 && buf[i + 1] > 0x8f) ||\n        buf[i] > 0xf4 // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Determines whether a value is a `Blob`.\n *\n * @param {*} value The value to be tested\n * @return {Boolean} `true` if `value` is a `Blob`, else `false`\n * @private\n */\nfunction isBlob(value) {\n  return (\n    hasBlob &&\n    typeof value === 'object' &&\n    typeof value.arrayBuffer === 'function' &&\n    typeof value.type === 'string' &&\n    typeof value.stream === 'function' &&\n    (value[Symbol.toStringTag] === 'Blob' ||\n      value[Symbol.toStringTag] === 'File')\n  );\n}\n\nmodule.exports = {\n  isBlob,\n  isValidStatusCode,\n  isValidUTF8: _isValidUTF8,\n  tokenChars\n};\n\nif (isUtf8) {\n  module.exports.isValidUTF8 = function (buf) {\n    return buf.length < 24 ? _isValidUTF8(buf) : isUtf8(buf);\n  };\n} /* istanbul ignore else  */ else if (!process.env.WS_NO_UTF_8_VALIDATE) {\n  try {\n    const isValidUTF8 = require('utf-8-validate');\n\n    module.exports.isValidUTF8 = function (buf) {\n      return buf.length < 32 ? _isValidUTF8(buf) : isValidUTF8(buf);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst { Writable } = require('stream');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  kStatusCode,\n  kWebSocket\n} = require('./constants');\nconst { concat, toArrayBuffer, unmask } = require('./buffer-util');\nconst { isValidStatusCode, isValidUTF8 } = require('./validation');\n\nconst FastBuffer = Buffer[Symbol.species];\n\nconst GET_INFO = 0;\nconst GET_PAYLOAD_LENGTH_16 = 1;\nconst GET_PAYLOAD_LENGTH_64 = 2;\nconst GET_MASK = 3;\nconst GET_DATA = 4;\nconst INFLATING = 5;\nconst DEFER_EVENT = 6;\n\n/**\n * HyBi Receiver implementation.\n *\n * @extends Writable\n */\nclass Receiver extends Writable {\n  /**\n   * Creates a Receiver instance.\n   *\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {String} [options.binaryType=nodebuffer] The type for binary data\n   * @param {Object} [options.extensions] An object containing the negotiated\n   *     extensions\n   * @param {Boolean} [options.isServer=false] Specifies whether to operate in\n   *     client or server mode\n   * @param {Number} [options.maxPayload=0] The maximum allowed message length\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   */\n  constructor(options = {}) {\n    super();\n\n    this._allowSynchronousEvents =\n      options.allowSynchronousEvents !== undefined\n        ? options.allowSynchronousEvents\n        : true;\n    this._binaryType = options.binaryType || BINARY_TYPES[0];\n    this._extensions = options.extensions || {};\n    this._isServer = !!options.isServer;\n    this._maxPayload = options.maxPayload | 0;\n    this._skipUTF8Validation = !!options.skipUTF8Validation;\n    this[kWebSocket] = undefined;\n\n    this._bufferedBytes = 0;\n    this._buffers = [];\n\n    this._compressed = false;\n    this._payloadLength = 0;\n    this._mask = undefined;\n    this._fragmented = 0;\n    this._masked = false;\n    this._fin = false;\n    this._opcode = 0;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragments = [];\n\n    this._errored = false;\n    this._loop = false;\n    this._state = GET_INFO;\n  }\n\n  /**\n   * Implements `Writable.prototype._write()`.\n   *\n   * @param {Buffer} chunk The chunk of data to write\n   * @param {String} encoding The character encoding of `chunk`\n   * @param {Function} cb Callback\n   * @private\n   */\n  _write(chunk, encoding, cb) {\n    if (this._opcode === 0x08 && this._state == GET_INFO) return cb();\n\n    this._bufferedBytes += chunk.length;\n    this._buffers.push(chunk);\n    this.startLoop(cb);\n  }\n\n  /**\n   * Consumes `n` bytes from the buffered data.\n   *\n   * @param {Number} n The number of bytes to consume\n   * @return {Buffer} The consumed bytes\n   * @private\n   */\n  consume(n) {\n    this._bufferedBytes -= n;\n\n    if (n === this._buffers[0].length) return this._buffers.shift();\n\n    if (n < this._buffers[0].length) {\n      const buf = this._buffers[0];\n      this._buffers[0] = new FastBuffer(\n        buf.buffer,\n        buf.byteOffset + n,\n        buf.length - n\n      );\n\n      return new FastBuffer(buf.buffer, buf.byteOffset, n);\n    }\n\n    const dst = Buffer.allocUnsafe(n);\n\n    do {\n      const buf = this._buffers[0];\n      const offset = dst.length - n;\n\n      if (n >= buf.length) {\n        dst.set(this._buffers.shift(), offset);\n      } else {\n        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);\n        this._buffers[0] = new FastBuffer(\n          buf.buffer,\n          buf.byteOffset + n,\n          buf.length - n\n        );\n      }\n\n      n -= buf.length;\n    } while (n > 0);\n\n    return dst;\n  }\n\n  /**\n   * Starts the parsing loop.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  startLoop(cb) {\n    this._loop = true;\n\n    do {\n      switch (this._state) {\n        case GET_INFO:\n          this.getInfo(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_16:\n          this.getPayloadLength16(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_64:\n          this.getPayloadLength64(cb);\n          break;\n        case GET_MASK:\n          this.getMask();\n          break;\n        case GET_DATA:\n          this.getData(cb);\n          break;\n        case INFLATING:\n        case DEFER_EVENT:\n          this._loop = false;\n          return;\n      }\n    } while (this._loop);\n\n    if (!this._errored) cb();\n  }\n\n  /**\n   * Reads the first two bytes of a frame.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getInfo(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(2);\n\n    if ((buf[0] & 0x30) !== 0x00) {\n      const error = this.createError(\n        RangeError,\n        'RSV2 and RSV3 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_2_3'\n      );\n\n      cb(error);\n      return;\n    }\n\n    const compressed = (buf[0] & 0x40) === 0x40;\n\n    if (compressed && !this._extensions[PerMessageDeflate.extensionName]) {\n      const error = this.createError(\n        RangeError,\n        'RSV1 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_1'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._fin = (buf[0] & 0x80) === 0x80;\n    this._opcode = buf[0] & 0x0f;\n    this._payloadLength = buf[1] & 0x7f;\n\n    if (this._opcode === 0x00) {\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (!this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          'invalid opcode 0',\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._opcode = this._fragmented;\n    } else if (this._opcode === 0x01 || this._opcode === 0x02) {\n      if (this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          `invalid opcode ${this._opcode}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._compressed = compressed;\n    } else if (this._opcode > 0x07 && this._opcode < 0x0b) {\n      if (!this._fin) {\n        const error = this.createError(\n          RangeError,\n          'FIN must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_FIN'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (\n        this._payloadLength > 0x7d ||\n        (this._opcode === 0x08 && this._payloadLength === 1)\n      ) {\n        const error = this.createError(\n          RangeError,\n          `invalid payload length ${this._payloadLength}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    } else {\n      const error = this.createError(\n        RangeError,\n        `invalid opcode ${this._opcode}`,\n        true,\n        1002,\n        'WS_ERR_INVALID_OPCODE'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (!this._fin && !this._fragmented) this._fragmented = this._opcode;\n    this._masked = (buf[1] & 0x80) === 0x80;\n\n    if (this._isServer) {\n      if (!this._masked) {\n        const error = this.createError(\n          RangeError,\n          'MASK must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_MASK'\n        );\n\n        cb(error);\n        return;\n      }\n    } else if (this._masked) {\n      const error = this.createError(\n        RangeError,\n        'MASK must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_MASK'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;\n    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;\n    else this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+16).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength16(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    this._payloadLength = this.consume(2).readUInt16BE(0);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+64).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength64(cb) {\n    if (this._bufferedBytes < 8) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(8);\n    const num = buf.readUInt32BE(0);\n\n    //\n    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned\n    // if payload length is greater than this number.\n    //\n    if (num > Math.pow(2, 53 - 32) - 1) {\n      const error = this.createError(\n        RangeError,\n        'Unsupported WebSocket frame: payload length > 2^53 - 1',\n        false,\n        1009,\n        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Payload length has been read.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  haveLength(cb) {\n    if (this._payloadLength && this._opcode < 0x08) {\n      this._totalPayloadLength += this._payloadLength;\n      if (this._totalPayloadLength > this._maxPayload && this._maxPayload > 0) {\n        const error = this.createError(\n          RangeError,\n          'Max payload size exceeded',\n          false,\n          1009,\n          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    }\n\n    if (this._masked) this._state = GET_MASK;\n    else this._state = GET_DATA;\n  }\n\n  /**\n   * Reads mask bytes.\n   *\n   * @private\n   */\n  getMask() {\n    if (this._bufferedBytes < 4) {\n      this._loop = false;\n      return;\n    }\n\n    this._mask = this.consume(4);\n    this._state = GET_DATA;\n  }\n\n  /**\n   * Reads data bytes.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getData(cb) {\n    let data = EMPTY_BUFFER;\n\n    if (this._payloadLength) {\n      if (this._bufferedBytes < this._payloadLength) {\n        this._loop = false;\n        return;\n      }\n\n      data = this.consume(this._payloadLength);\n\n      if (\n        this._masked &&\n        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0\n      ) {\n        unmask(data, this._mask);\n      }\n    }\n\n    if (this._opcode > 0x07) {\n      this.controlMessage(data, cb);\n      return;\n    }\n\n    if (this._compressed) {\n      this._state = INFLATING;\n      this.decompress(data, cb);\n      return;\n    }\n\n    if (data.length) {\n      //\n      // This message is not compressed so its length is the sum of the payload\n      // length of all fragments.\n      //\n      this._messageLength = this._totalPayloadLength;\n      this._fragments.push(data);\n    }\n\n    this.dataMessage(cb);\n  }\n\n  /**\n   * Decompresses data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Function} cb Callback\n   * @private\n   */\n  decompress(data, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    perMessageDeflate.decompress(data, this._fin, (err, buf) => {\n      if (err) return cb(err);\n\n      if (buf.length) {\n        this._messageLength += buf.length;\n        if (this._messageLength > this._maxPayload && this._maxPayload > 0) {\n          const error = this.createError(\n            RangeError,\n            'Max payload size exceeded',\n            false,\n            1009,\n            'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._fragments.push(buf);\n      }\n\n      this.dataMessage(cb);\n      if (this._state === GET_INFO) this.startLoop(cb);\n    });\n  }\n\n  /**\n   * Handles a data message.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  dataMessage(cb) {\n    if (!this._fin) {\n      this._state = GET_INFO;\n      return;\n    }\n\n    const messageLength = this._messageLength;\n    const fragments = this._fragments;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragmented = 0;\n    this._fragments = [];\n\n    if (this._opcode === 2) {\n      let data;\n\n      if (this._binaryType === 'nodebuffer') {\n        data = concat(fragments, messageLength);\n      } else if (this._binaryType === 'arraybuffer') {\n        data = toArrayBuffer(concat(fragments, messageLength));\n      } else if (this._binaryType === 'blob') {\n        data = new Blob(fragments);\n      } else {\n        data = fragments;\n      }\n\n      if (this._allowSynchronousEvents) {\n        this.emit('message', data, true);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', data, true);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    } else {\n      const buf = concat(fragments, messageLength);\n\n      if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n        const error = this.createError(\n          Error,\n          'invalid UTF-8 sequence',\n          true,\n          1007,\n          'WS_ERR_INVALID_UTF8'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (this._state === INFLATING || this._allowSynchronousEvents) {\n        this.emit('message', buf, false);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', buf, false);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    }\n  }\n\n  /**\n   * Handles a control message.\n   *\n   * @param {Buffer} data Data to handle\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  controlMessage(data, cb) {\n    if (this._opcode === 0x08) {\n      if (data.length === 0) {\n        this._loop = false;\n        this.emit('conclude', 1005, EMPTY_BUFFER);\n        this.end();\n      } else {\n        const code = data.readUInt16BE(0);\n\n        if (!isValidStatusCode(code)) {\n          const error = this.createError(\n            RangeError,\n            `invalid status code ${code}`,\n            true,\n            1002,\n            'WS_ERR_INVALID_CLOSE_CODE'\n          );\n\n          cb(error);\n          return;\n        }\n\n        const buf = new FastBuffer(\n          data.buffer,\n          data.byteOffset + 2,\n          data.length - 2\n        );\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          const error = this.createError(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._loop = false;\n        this.emit('conclude', code, buf);\n        this.end();\n      }\n\n      this._state = GET_INFO;\n      return;\n    }\n\n    if (this._allowSynchronousEvents) {\n      this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n      this._state = GET_INFO;\n    } else {\n      this._state = DEFER_EVENT;\n      setImmediate(() => {\n        this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n        this._state = GET_INFO;\n        this.startLoop(cb);\n      });\n    }\n  }\n\n  /**\n   * Builds an error object.\n   *\n   * @param {function(new:Error|RangeError)} ErrorCtor The error constructor\n   * @param {String} message The error message\n   * @param {Boolean} prefix Specifies whether or not to add a default prefix to\n   *     `message`\n   * @param {Number} statusCode The status code\n   * @param {String} errorCode The exposed error code\n   * @return {(Error|RangeError)} The error\n   * @private\n   */\n  createError(ErrorCtor, message, prefix, statusCode, errorCode) {\n    this._loop = false;\n    this._errored = true;\n\n    const err = new ErrorCtor(\n      prefix ? `Invalid WebSocket frame: ${message}` : message\n    );\n\n    Error.captureStackTrace(err, this.createError);\n    err.code = errorCode;\n    err[kStatusCode] = statusCode;\n    return err;\n  }\n}\n\nmodule.exports = Receiver;\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex\" }] */\n\n'use strict';\n\nconst { Duplex } = require('stream');\nconst { randomFillSync } = require('crypto');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst { EMPTY_BUFFER, kWebSocket, NOOP } = require('./constants');\nconst { isBlob, isValidStatusCode } = require('./validation');\nconst { mask: applyMask, toBuffer } = require('./buffer-util');\n\nconst kByteLength = Symbol('kByteLength');\nconst maskBuffer = Buffer.alloc(4);\nconst RANDOM_POOL_SIZE = 8 * 1024;\nlet randomPool;\nlet randomPoolPointer = RANDOM_POOL_SIZE;\n\nconst DEFAULT = 0;\nconst DEFLATING = 1;\nconst GET_BLOB_DATA = 2;\n\n/**\n * HyBi Sender implementation.\n */\nclass Sender {\n  /**\n   * Creates a Sender instance.\n   *\n   * @param {Duplex} socket The connection socket\n   * @param {Object} [extensions] An object containing the negotiated extensions\n   * @param {Function} [generateMask] The function used to generate the masking\n   *     key\n   */\n  constructor(socket, extensions, generateMask) {\n    this._extensions = extensions || {};\n\n    if (generateMask) {\n      this._generateMask = generateMask;\n      this._maskBuffer = Buffer.alloc(4);\n    }\n\n    this._socket = socket;\n\n    this._firstFragment = true;\n    this._compress = false;\n\n    this._bufferedBytes = 0;\n    this._queue = [];\n    this._state = DEFAULT;\n    this.onerror = NOOP;\n    this[kWebSocket] = undefined;\n  }\n\n  /**\n   * Frames a piece of data according to the HyBi WebSocket protocol.\n   *\n   * @param {(Buffer|String)} data The data to frame\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @return {(Buffer|String)[]} The framed data\n   * @public\n   */\n  static frame(data, options) {\n    let mask;\n    let merge = false;\n    let offset = 2;\n    let skipMasking = false;\n\n    if (options.mask) {\n      mask = options.maskBuffer || maskBuffer;\n\n      if (options.generateMask) {\n        options.generateMask(mask);\n      } else {\n        if (randomPoolPointer === RANDOM_POOL_SIZE) {\n          /* istanbul ignore else  */\n          if (randomPool === undefined) {\n            //\n            // This is lazily initialized because server-sent frames must not\n            // be masked so it may never be used.\n            //\n            randomPool = Buffer.alloc(RANDOM_POOL_SIZE);\n          }\n\n          randomFillSync(randomPool, 0, RANDOM_POOL_SIZE);\n          randomPoolPointer = 0;\n        }\n\n        mask[0] = randomPool[randomPoolPointer++];\n        mask[1] = randomPool[randomPoolPointer++];\n        mask[2] = randomPool[randomPoolPointer++];\n        mask[3] = randomPool[randomPoolPointer++];\n      }\n\n      skipMasking = (mask[0] | mask[1] | mask[2] | mask[3]) === 0;\n      offset = 6;\n    }\n\n    let dataLength;\n\n    if (typeof data === 'string') {\n      if (\n        (!options.mask || skipMasking) &&\n        options[kByteLength] !== undefined\n      ) {\n        dataLength = options[kByteLength];\n      } else {\n        data = Buffer.from(data);\n        dataLength = data.length;\n      }\n    } else {\n      dataLength = data.length;\n      merge = options.mask && options.readOnly && !skipMasking;\n    }\n\n    let payloadLength = dataLength;\n\n    if (dataLength >= 65536) {\n      offset += 8;\n      payloadLength = 127;\n    } else if (dataLength > 125) {\n      offset += 2;\n      payloadLength = 126;\n    }\n\n    const target = Buffer.allocUnsafe(merge ? dataLength + offset : offset);\n\n    target[0] = options.fin ? options.opcode | 0x80 : options.opcode;\n    if (options.rsv1) target[0] |= 0x40;\n\n    target[1] = payloadLength;\n\n    if (payloadLength === 126) {\n      target.writeUInt16BE(dataLength, 2);\n    } else if (payloadLength === 127) {\n      target[2] = target[3] = 0;\n      target.writeUIntBE(dataLength, 4, 6);\n    }\n\n    if (!options.mask) return [target, data];\n\n    target[1] |= 0x80;\n    target[offset - 4] = mask[0];\n    target[offset - 3] = mask[1];\n    target[offset - 2] = mask[2];\n    target[offset - 1] = mask[3];\n\n    if (skipMasking) return [target, data];\n\n    if (merge) {\n      applyMask(data, mask, target, offset, dataLength);\n      return [target];\n    }\n\n    applyMask(data, mask, data, 0, dataLength);\n    return [target, data];\n  }\n\n  /**\n   * Sends a close message to the other peer.\n   *\n   * @param {Number} [code] The status code component of the body\n   * @param {(String|Buffer)} [data] The message component of the body\n   * @param {Boolean} [mask=false] Specifies whether or not to mask the message\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  close(code, data, mask, cb) {\n    let buf;\n\n    if (code === undefined) {\n      buf = EMPTY_BUFFER;\n    } else if (typeof code !== 'number' || !isValidStatusCode(code)) {\n      throw new TypeError('First argument must be a valid error code number');\n    } else if (data === undefined || !data.length) {\n      buf = Buffer.allocUnsafe(2);\n      buf.writeUInt16BE(code, 0);\n    } else {\n      const length = Buffer.byteLength(data);\n\n      if (length > 123) {\n        throw new RangeError('The message must not be greater than 123 bytes');\n      }\n\n      buf = Buffer.allocUnsafe(2 + length);\n      buf.writeUInt16BE(code, 0);\n\n      if (typeof data === 'string') {\n        buf.write(data, 2);\n      } else {\n        buf.set(data, 2);\n      }\n    }\n\n    const options = {\n      [kByteLength]: buf.length,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x08,\n      readOnly: false,\n      rsv1: false\n    };\n\n    if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, buf, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(buf, options), cb);\n    }\n  }\n\n  /**\n   * Sends a ping message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  ping(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x09,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a pong message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  pong(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x0a,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a data message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Object} options Options object\n   * @param {Boolean} [options.binary=false] Specifies whether `data` is binary\n   *     or text\n   * @param {Boolean} [options.compress=false] Specifies whether or not to\n   *     compress `data`\n   * @param {Boolean} [options.fin=false] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  send(data, options, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n    let opcode = options.binary ? 2 : 1;\n    let rsv1 = options.compress;\n\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (this._firstFragment) {\n      this._firstFragment = false;\n      if (\n        rsv1 &&\n        perMessageDeflate &&\n        perMessageDeflate.params[\n          perMessageDeflate._isServer\n            ? 'server_no_context_takeover'\n            : 'client_no_context_takeover'\n        ]\n      ) {\n        rsv1 = byteLength >= perMessageDeflate._threshold;\n      }\n      this._compress = rsv1;\n    } else {\n      rsv1 = false;\n      opcode = 0;\n    }\n\n    if (options.fin) this._firstFragment = true;\n\n    const opts = {\n      [kByteLength]: byteLength,\n      fin: options.fin,\n      generateMask: this._generateMask,\n      mask: options.mask,\n      maskBuffer: this._maskBuffer,\n      opcode,\n      readOnly,\n      rsv1\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, this._compress, opts, cb]);\n      } else {\n        this.getBlobData(data, this._compress, opts, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, this._compress, opts, cb]);\n    } else {\n      this.dispatch(data, this._compress, opts, cb);\n    }\n  }\n\n  /**\n   * Gets the contents of a blob as binary data.\n   *\n   * @param {Blob} blob The blob\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     the data\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  getBlobData(blob, compress, options, cb) {\n    this._bufferedBytes += options[kByteLength];\n    this._state = GET_BLOB_DATA;\n\n    blob\n      .arrayBuffer()\n      .then((arrayBuffer) => {\n        if (this._socket.destroyed) {\n          const err = new Error(\n            'The socket was closed while the blob was being read'\n          );\n\n          //\n          // `callCallbacks` is called in the next tick to ensure that errors\n          // that might be thrown in the callbacks behave like errors thrown\n          // outside the promise chain.\n          //\n          process.nextTick(callCallbacks, this, err, cb);\n          return;\n        }\n\n        this._bufferedBytes -= options[kByteLength];\n        const data = toBuffer(arrayBuffer);\n\n        if (!compress) {\n          this._state = DEFAULT;\n          this.sendFrame(Sender.frame(data, options), cb);\n          this.dequeue();\n        } else {\n          this.dispatch(data, compress, options, cb);\n        }\n      })\n      .catch((err) => {\n        //\n        // `onError` is called in the next tick for the same reason that\n        // `callCallbacks` above is.\n        //\n        process.nextTick(onError, this, err, cb);\n      });\n  }\n\n  /**\n   * Dispatches a message.\n   *\n   * @param {(Buffer|String)} data The message to send\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     `data`\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  dispatch(data, compress, options, cb) {\n    if (!compress) {\n      this.sendFrame(Sender.frame(data, options), cb);\n      return;\n    }\n\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    this._bufferedBytes += options[kByteLength];\n    this._state = DEFLATING;\n    perMessageDeflate.compress(data, options.fin, (_, buf) => {\n      if (this._socket.destroyed) {\n        const err = new Error(\n          'The socket was closed while data was being compressed'\n        );\n\n        callCallbacks(this, err, cb);\n        return;\n      }\n\n      this._bufferedBytes -= options[kByteLength];\n      this._state = DEFAULT;\n      options.readOnly = false;\n      this.sendFrame(Sender.frame(buf, options), cb);\n      this.dequeue();\n    });\n  }\n\n  /**\n   * Executes queued send operations.\n   *\n   * @private\n   */\n  dequeue() {\n    while (this._state === DEFAULT && this._queue.length) {\n      const params = this._queue.shift();\n\n      this._bufferedBytes -= params[3][kByteLength];\n      Reflect.apply(params[0], this, params.slice(1));\n    }\n  }\n\n  /**\n   * Enqueues a send operation.\n   *\n   * @param {Array} params Send operation parameters.\n   * @private\n   */\n  enqueue(params) {\n    this._bufferedBytes += params[3][kByteLength];\n    this._queue.push(params);\n  }\n\n  /**\n   * Sends a frame.\n   *\n   * @param {(Buffer | String)[]} list The frame to send\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  sendFrame(list, cb) {\n    if (list.length === 2) {\n      this._socket.cork();\n      this._socket.write(list[0]);\n      this._socket.write(list[1], cb);\n      this._socket.uncork();\n    } else {\n      this._socket.write(list[0], cb);\n    }\n  }\n}\n\nmodule.exports = Sender;\n\n/**\n * Calls queued callbacks with an error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error to call the callbacks with\n * @param {Function} [cb] The first callback\n * @private\n */\nfunction callCallbacks(sender, err, cb) {\n  if (typeof cb === 'function') cb(err);\n\n  for (let i = 0; i < sender._queue.length; i++) {\n    const params = sender._queue[i];\n    const callback = params[params.length - 1];\n\n    if (typeof callback === 'function') callback(err);\n  }\n}\n\n/**\n * Handles a `Sender` error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error\n * @param {Function} [cb] The first pending callback\n * @private\n */\nfunction onError(sender, err, cb) {\n  callCallbacks(sender, err, cb);\n  sender.onerror(err);\n}\n","'use strict';\n\nconst { kForOnEventAttribute, kListener } = require('./constants');\n\nconst kCode = Symbol('kCode');\nconst kData = Symbol('kData');\nconst kError = Symbol('kError');\nconst kMessage = Symbol('kMessage');\nconst kReason = Symbol('kReason');\nconst kTarget = Symbol('kTarget');\nconst kType = Symbol('kType');\nconst kWasClean = Symbol('kWasClean');\n\n/**\n * Class representing an event.\n */\nclass Event {\n  /**\n   * Create a new `Event`.\n   *\n   * @param {String} type The name of the event\n   * @throws {TypeError} If the `type` argument is not specified\n   */\n  constructor(type) {\n    this[kTarget] = null;\n    this[kType] = type;\n  }\n\n  /**\n   * @type {*}\n   */\n  get target() {\n    return this[kTarget];\n  }\n\n  /**\n   * @type {String}\n   */\n  get type() {\n    return this[kType];\n  }\n}\n\nObject.defineProperty(Event.prototype, 'target', { enumerable: true });\nObject.defineProperty(Event.prototype, 'type', { enumerable: true });\n\n/**\n * Class representing a close event.\n *\n * @extends Event\n */\nclass CloseEvent extends Event {\n  /**\n   * Create a new `CloseEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {Number} [options.code=0] The status code explaining why the\n   *     connection was closed\n   * @param {String} [options.reason=''] A human-readable string explaining why\n   *     the connection was closed\n   * @param {Boolean} [options.wasClean=false] Indicates whether or not the\n   *     connection was cleanly closed\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kCode] = options.code === undefined ? 0 : options.code;\n    this[kReason] = options.reason === undefined ? '' : options.reason;\n    this[kWasClean] = options.wasClean === undefined ? false : options.wasClean;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get code() {\n    return this[kCode];\n  }\n\n  /**\n   * @type {String}\n   */\n  get reason() {\n    return this[kReason];\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get wasClean() {\n    return this[kWasClean];\n  }\n}\n\nObject.defineProperty(CloseEvent.prototype, 'code', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'reason', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'wasClean', { enumerable: true });\n\n/**\n * Class representing an error event.\n *\n * @extends Event\n */\nclass ErrorEvent extends Event {\n  /**\n   * Create a new `ErrorEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.error=null] The error that generated this event\n   * @param {String} [options.message=''] The error message\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kError] = options.error === undefined ? null : options.error;\n    this[kMessage] = options.message === undefined ? '' : options.message;\n  }\n\n  /**\n   * @type {*}\n   */\n  get error() {\n    return this[kError];\n  }\n\n  /**\n   * @type {String}\n   */\n  get message() {\n    return this[kMessage];\n  }\n}\n\nObject.defineProperty(ErrorEvent.prototype, 'error', { enumerable: true });\nObject.defineProperty(ErrorEvent.prototype, 'message', { enumerable: true });\n\n/**\n * Class representing a message event.\n *\n * @extends Event\n */\nclass MessageEvent extends Event {\n  /**\n   * Create a new `MessageEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.data=null] The message content\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kData] = options.data === undefined ? null : options.data;\n  }\n\n  /**\n   * @type {*}\n   */\n  get data() {\n    return this[kData];\n  }\n}\n\nObject.defineProperty(MessageEvent.prototype, 'data', { enumerable: true });\n\n/**\n * This provides methods for emulating the `EventTarget` interface. It's not\n * meant to be used directly.\n *\n * @mixin\n */\nconst EventTarget = {\n  /**\n   * Register an event listener.\n   *\n   * @param {String} type A string representing the event type to listen for\n   * @param {(Function|Object)} handler The listener to add\n   * @param {Object} [options] An options object specifies characteristics about\n   *     the event listener\n   * @param {Boolean} [options.once=false] A `Boolean` indicating that the\n   *     listener should be invoked at most once after being added. If `true`,\n   *     the listener would be automatically removed when invoked.\n   * @public\n   */\n  addEventListener(type, handler, options = {}) {\n    for (const listener of this.listeners(type)) {\n      if (\n        !options[kForOnEventAttribute] &&\n        listener[kListener] === handler &&\n        !listener[kForOnEventAttribute]\n      ) {\n        return;\n      }\n    }\n\n    let wrapper;\n\n    if (type === 'message') {\n      wrapper = function onMessage(data, isBinary) {\n        const event = new MessageEvent('message', {\n          data: isBinary ? data : data.toString()\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'close') {\n      wrapper = function onClose(code, message) {\n        const event = new CloseEvent('close', {\n          code,\n          reason: message.toString(),\n          wasClean: this._closeFrameReceived && this._closeFrameSent\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'error') {\n      wrapper = function onError(error) {\n        const event = new ErrorEvent('error', {\n          error,\n          message: error.message\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'open') {\n      wrapper = function onOpen() {\n        const event = new Event('open');\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else {\n      return;\n    }\n\n    wrapper[kForOnEventAttribute] = !!options[kForOnEventAttribute];\n    wrapper[kListener] = handler;\n\n    if (options.once) {\n      this.once(type, wrapper);\n    } else {\n      this.on(type, wrapper);\n    }\n  },\n\n  /**\n   * Remove an event listener.\n   *\n   * @param {String} type A string representing the event type to remove\n   * @param {(Function|Object)} handler The listener to remove\n   * @public\n   */\n  removeEventListener(type, handler) {\n    for (const listener of this.listeners(type)) {\n      if (listener[kListener] === handler && !listener[kForOnEventAttribute]) {\n        this.removeListener(type, listener);\n        break;\n      }\n    }\n  }\n};\n\nmodule.exports = {\n  CloseEvent,\n  ErrorEvent,\n  Event,\n  EventTarget,\n  MessageEvent\n};\n\n/**\n * Call an event listener\n *\n * @param {(Function|Object)} listener The listener to call\n * @param {*} thisArg The value to use as `this`` when calling the listener\n * @param {Event} event The event to pass to the listener\n * @private\n */\nfunction callListener(listener, thisArg, event) {\n  if (typeof listener === 'object' && listener.handleEvent) {\n    listener.handleEvent.call(listener, event);\n  } else {\n    listener.call(thisArg, event);\n  }\n}\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Adds an offer to the map of extension offers or a parameter to the map of\n * parameters.\n *\n * @param {Object} dest The map of extension offers or parameters\n * @param {String} name The extension or parameter name\n * @param {(Object|Boolean|String)} elem The extension parameters or the\n *     parameter value\n * @private\n */\nfunction push(dest, name, elem) {\n  if (dest[name] === undefined) dest[name] = [elem];\n  else dest[name].push(elem);\n}\n\n/**\n * Parses the `Sec-WebSocket-Extensions` header into an object.\n *\n * @param {String} header The field value of the header\n * @return {Object} The parsed object\n * @public\n */\nfunction parse(header) {\n  const offers = Object.create(null);\n  let params = Object.create(null);\n  let mustUnescape = false;\n  let isEscaping = false;\n  let inQuotes = false;\n  let extensionName;\n  let paramName;\n  let start = -1;\n  let code = -1;\n  let end = -1;\n  let i = 0;\n\n  for (; i < header.length; i++) {\n    code = header.charCodeAt(i);\n\n    if (extensionName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (\n        i !== 0 &&\n        (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n      ) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b /* ';' */ || code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        const name = header.slice(start, end);\n        if (code === 0x2c) {\n          push(offers, name, params);\n          params = Object.create(null);\n        } else {\n          extensionName = name;\n        }\n\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else if (paramName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (code === 0x20 || code === 0x09) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        push(params, header.slice(start, end), true);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        start = end = -1;\n      } else if (code === 0x3d /* '=' */ && start !== -1 && end === -1) {\n        paramName = header.slice(start, i);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else {\n      //\n      // The value of a quoted-string after unescaping must conform to the\n      // token ABNF, so only token characters are valid.\n      // Ref: https://tools.ietf.org/html/rfc6455#section-9.1\n      //\n      if (isEscaping) {\n        if (tokenChars[code] !== 1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (start === -1) start = i;\n        else if (!mustUnescape) mustUnescape = true;\n        isEscaping = false;\n      } else if (inQuotes) {\n        if (tokenChars[code] === 1) {\n          if (start === -1) start = i;\n        } else if (code === 0x22 /* '\"' */ && start !== -1) {\n          inQuotes = false;\n          end = i;\n        } else if (code === 0x5c /* '\\' */) {\n          isEscaping = true;\n        } else {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n      } else if (code === 0x22 && header.charCodeAt(i - 1) === 0x3d) {\n        inQuotes = true;\n      } else if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (start !== -1 && (code === 0x20 || code === 0x09)) {\n        if (end === -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        let value = header.slice(start, end);\n        if (mustUnescape) {\n          value = value.replace(/\\\\/g, '');\n          mustUnescape = false;\n        }\n        push(params, paramName, value);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        paramName = undefined;\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n  }\n\n  if (start === -1 || inQuotes || code === 0x20 || code === 0x09) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  if (end === -1) end = i;\n  const token = header.slice(start, end);\n  if (extensionName === undefined) {\n    push(offers, token, params);\n  } else {\n    if (paramName === undefined) {\n      push(params, token, true);\n    } else if (mustUnescape) {\n      push(params, paramName, token.replace(/\\\\/g, ''));\n    } else {\n      push(params, paramName, token);\n    }\n    push(offers, extensionName, params);\n  }\n\n  return offers;\n}\n\n/**\n * Builds the `Sec-WebSocket-Extensions` header field value.\n *\n * @param {Object} extensions The map of extensions and parameters to format\n * @return {String} A string representing the given object\n * @public\n */\nfunction format(extensions) {\n  return Object.keys(extensions)\n    .map((extension) => {\n      let configurations = extensions[extension];\n      if (!Array.isArray(configurations)) configurations = [configurations];\n      return configurations\n        .map((params) => {\n          return [extension]\n            .concat(\n              Object.keys(params).map((k) => {\n                let values = params[k];\n                if (!Array.isArray(values)) values = [values];\n                return values\n                  .map((v) => (v === true ? k : `${k}=${v}`))\n                  .join('; ');\n              })\n            )\n            .join('; ');\n        })\n        .join(', ');\n    })\n    .join(', ');\n}\n\nmodule.exports = { format, parse };\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex|Readable$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst https = require('https');\nconst http = require('http');\nconst net = require('net');\nconst tls = require('tls');\nconst { randomBytes, createHash } = require('crypto');\nconst { Duplex, Readable } = require('stream');\nconst { URL } = require('url');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst Receiver = require('./receiver');\nconst Sender = require('./sender');\nconst { isBlob } = require('./validation');\n\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  GUID,\n  kForOnEventAttribute,\n  kListener,\n  kStatusCode,\n  kWebSocket,\n  NOOP\n} = require('./constants');\nconst {\n  EventTarget: { addEventListener, removeEventListener }\n} = require('./event-target');\nconst { format, parse } = require('./extension');\nconst { toBuffer } = require('./buffer-util');\n\nconst closeTimeout = 30 * 1000;\nconst kAborted = Symbol('kAborted');\nconst protocolVersions = [8, 13];\nconst readyStates = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'];\nconst subprotocolRegex = /^[!#$%&'*+\\-.0-9A-Z^_`|a-z~]+$/;\n\n/**\n * Class representing a WebSocket.\n *\n * @extends EventEmitter\n */\nclass WebSocket extends EventEmitter {\n  /**\n   * Create a new `WebSocket`.\n   *\n   * @param {(String|URL)} address The URL to which to connect\n   * @param {(String|String[])} [protocols] The subprotocols\n   * @param {Object} [options] Connection options\n   */\n  constructor(address, protocols, options) {\n    super();\n\n    this._binaryType = BINARY_TYPES[0];\n    this._closeCode = 1006;\n    this._closeFrameReceived = false;\n    this._closeFrameSent = false;\n    this._closeMessage = EMPTY_BUFFER;\n    this._closeTimer = null;\n    this._errorEmitted = false;\n    this._extensions = {};\n    this._paused = false;\n    this._protocol = '';\n    this._readyState = WebSocket.CONNECTING;\n    this._receiver = null;\n    this._sender = null;\n    this._socket = null;\n\n    if (address !== null) {\n      this._bufferedAmount = 0;\n      this._isServer = false;\n      this._redirects = 0;\n\n      if (protocols === undefined) {\n        protocols = [];\n      } else if (!Array.isArray(protocols)) {\n        if (typeof protocols === 'object' && protocols !== null) {\n          options = protocols;\n          protocols = [];\n        } else {\n          protocols = [protocols];\n        }\n      }\n\n      initAsClient(this, address, protocols, options);\n    } else {\n      this._autoPong = options.autoPong;\n      this._isServer = true;\n    }\n  }\n\n  /**\n   * For historical reasons, the custom \"nodebuffer\" type is used by the default\n   * instead of \"blob\".\n   *\n   * @type {String}\n   */\n  get binaryType() {\n    return this._binaryType;\n  }\n\n  set binaryType(type) {\n    if (!BINARY_TYPES.includes(type)) return;\n\n    this._binaryType = type;\n\n    //\n    // Allow to change `binaryType` on the fly.\n    //\n    if (this._receiver) this._receiver._binaryType = type;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get bufferedAmount() {\n    if (!this._socket) return this._bufferedAmount;\n\n    return this._socket._writableState.length + this._sender._bufferedBytes;\n  }\n\n  /**\n   * @type {String}\n   */\n  get extensions() {\n    return Object.keys(this._extensions).join();\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get isPaused() {\n    return this._paused;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onclose() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onerror() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onopen() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onmessage() {\n    return null;\n  }\n\n  /**\n   * @type {String}\n   */\n  get protocol() {\n    return this._protocol;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get readyState() {\n    return this._readyState;\n  }\n\n  /**\n   * @type {String}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * Set up the socket and the internal resources.\n   *\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Object} options Options object\n   * @param {Boolean} [options.allowSynchronousEvents=false] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Number} [options.maxPayload=0] The maximum allowed message size\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @private\n   */\n  setSocket(socket, head, options) {\n    const receiver = new Receiver({\n      allowSynchronousEvents: options.allowSynchronousEvents,\n      binaryType: this.binaryType,\n      extensions: this._extensions,\n      isServer: this._isServer,\n      maxPayload: options.maxPayload,\n      skipUTF8Validation: options.skipUTF8Validation\n    });\n\n    const sender = new Sender(socket, this._extensions, options.generateMask);\n\n    this._receiver = receiver;\n    this._sender = sender;\n    this._socket = socket;\n\n    receiver[kWebSocket] = this;\n    sender[kWebSocket] = this;\n    socket[kWebSocket] = this;\n\n    receiver.on('conclude', receiverOnConclude);\n    receiver.on('drain', receiverOnDrain);\n    receiver.on('error', receiverOnError);\n    receiver.on('message', receiverOnMessage);\n    receiver.on('ping', receiverOnPing);\n    receiver.on('pong', receiverOnPong);\n\n    sender.onerror = senderOnError;\n\n    //\n    // These methods may not be available if `socket` is just a `Duplex`.\n    //\n    if (socket.setTimeout) socket.setTimeout(0);\n    if (socket.setNoDelay) socket.setNoDelay();\n\n    if (head.length > 0) socket.unshift(head);\n\n    socket.on('close', socketOnClose);\n    socket.on('data', socketOnData);\n    socket.on('end', socketOnEnd);\n    socket.on('error', socketOnError);\n\n    this._readyState = WebSocket.OPEN;\n    this.emit('open');\n  }\n\n  /**\n   * Emit the `'close'` event.\n   *\n   * @private\n   */\n  emitClose() {\n    if (!this._socket) {\n      this._readyState = WebSocket.CLOSED;\n      this.emit('close', this._closeCode, this._closeMessage);\n      return;\n    }\n\n    if (this._extensions[PerMessageDeflate.extensionName]) {\n      this._extensions[PerMessageDeflate.extensionName].cleanup();\n    }\n\n    this._receiver.removeAllListeners();\n    this._readyState = WebSocket.CLOSED;\n    this.emit('close', this._closeCode, this._closeMessage);\n  }\n\n  /**\n   * Start a closing handshake.\n   *\n   *          +----------+   +-----------+   +----------+\n   *     - - -|ws.close()|-->|close frame|-->|ws.close()|- - -\n   *    |     +----------+   +-----------+   +----------+     |\n   *          +----------+   +-----------+         |\n   * CLOSING  |ws.close()|<--|close frame|<--+-----+       CLOSING\n   *          +----------+   +-----------+   |\n   *    |           |                        |   +---+        |\n   *                +------------------------+-->|fin| - - - -\n   *    |         +---+                      |   +---+\n   *     - - - - -|fin|<---------------------+\n   *              +---+\n   *\n   * @param {Number} [code] Status code explaining why the connection is closing\n   * @param {(String|Buffer)} [data] The reason why the connection is\n   *     closing\n   * @public\n   */\n  close(code, data) {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this.readyState === WebSocket.CLOSING) {\n      if (\n        this._closeFrameSent &&\n        (this._closeFrameReceived || this._receiver._writableState.errorEmitted)\n      ) {\n        this._socket.end();\n      }\n\n      return;\n    }\n\n    this._readyState = WebSocket.CLOSING;\n    this._sender.close(code, data, !this._isServer, (err) => {\n      //\n      // This error is handled by the `'error'` listener on the socket. We only\n      // want to know if the close frame has been sent here.\n      //\n      if (err) return;\n\n      this._closeFrameSent = true;\n\n      if (\n        this._closeFrameReceived ||\n        this._receiver._writableState.errorEmitted\n      ) {\n        this._socket.end();\n      }\n    });\n\n    setCloseTimer(this);\n  }\n\n  /**\n   * Pause the socket.\n   *\n   * @public\n   */\n  pause() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = true;\n    this._socket.pause();\n  }\n\n  /**\n   * Send a ping.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the ping is sent\n   * @public\n   */\n  ping(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.ping(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Send a pong.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the pong is sent\n   * @public\n   */\n  pong(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.pong(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Resume the socket.\n   *\n   * @public\n   */\n  resume() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = false;\n    if (!this._receiver._writableState.needDrain) this._socket.resume();\n  }\n\n  /**\n   * Send a data message.\n   *\n   * @param {*} data The message to send\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.binary] Specifies whether `data` is binary or\n   *     text\n   * @param {Boolean} [options.compress] Specifies whether or not to compress\n   *     `data`\n   * @param {Boolean} [options.fin=true] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when data is written out\n   * @public\n   */\n  send(data, options, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = {};\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    const opts = {\n      binary: typeof data !== 'string',\n      mask: !this._isServer,\n      compress: true,\n      fin: true,\n      ...options\n    };\n\n    if (!this._extensions[PerMessageDeflate.extensionName]) {\n      opts.compress = false;\n    }\n\n    this._sender.send(data || EMPTY_BUFFER, opts, cb);\n  }\n\n  /**\n   * Forcibly close the connection.\n   *\n   * @public\n   */\n  terminate() {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this._socket) {\n      this._readyState = WebSocket.CLOSING;\n      this._socket.destroy();\n    }\n  }\n}\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n[\n  'binaryType',\n  'bufferedAmount',\n  'extensions',\n  'isPaused',\n  'protocol',\n  'readyState',\n  'url'\n].forEach((property) => {\n  Object.defineProperty(WebSocket.prototype, property, { enumerable: true });\n});\n\n//\n// Add the `onopen`, `onerror`, `onclose`, and `onmessage` attributes.\n// See https://html.spec.whatwg.org/multipage/comms.html#the-websocket-interface\n//\n['open', 'error', 'close', 'message'].forEach((method) => {\n  Object.defineProperty(WebSocket.prototype, `on${method}`, {\n    enumerable: true,\n    get() {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) return listener[kListener];\n      }\n\n      return null;\n    },\n    set(handler) {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) {\n          this.removeListener(method, listener);\n          break;\n        }\n      }\n\n      if (typeof handler !== 'function') return;\n\n      this.addEventListener(method, handler, {\n        [kForOnEventAttribute]: true\n      });\n    }\n  });\n});\n\nWebSocket.prototype.addEventListener = addEventListener;\nWebSocket.prototype.removeEventListener = removeEventListener;\n\nmodule.exports = WebSocket;\n\n/**\n * Initialize a WebSocket client.\n *\n * @param {WebSocket} websocket The client to initialize\n * @param {(String|URL)} address The URL to which to connect\n * @param {Array} protocols The subprotocols\n * @param {Object} [options] Connection options\n * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether any\n *     of the `'message'`, `'ping'`, and `'pong'` events can be emitted multiple\n *     times in the same tick\n * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n *     automatically send a pong in response to a ping\n * @param {Function} [options.finishRequest] A function which can be used to\n *     customize the headers of each http request before it is sent\n * @param {Boolean} [options.followRedirects=false] Whether or not to follow\n *     redirects\n * @param {Function} [options.generateMask] The function used to generate the\n *     masking key\n * @param {Number} [options.handshakeTimeout] Timeout in milliseconds for the\n *     handshake request\n * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n *     size\n * @param {Number} [options.maxRedirects=10] The maximum number of redirects\n *     allowed\n * @param {String} [options.origin] Value of the `Origin` or\n *     `Sec-WebSocket-Origin` header\n * @param {(Boolean|Object)} [options.perMessageDeflate=true] Enable/disable\n *     permessage-deflate\n * @param {Number} [options.protocolVersion=13] Value of the\n *     `Sec-WebSocket-Version` header\n * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n *     not to skip UTF-8 validation for text and close messages\n * @private\n */\nfunction initAsClient(websocket, address, protocols, options) {\n  const opts = {\n    allowSynchronousEvents: true,\n    autoPong: true,\n    protocolVersion: protocolVersions[1],\n    maxPayload: 100 * 1024 * 1024,\n    skipUTF8Validation: false,\n    perMessageDeflate: true,\n    followRedirects: false,\n    maxRedirects: 10,\n    ...options,\n    socketPath: undefined,\n    hostname: undefined,\n    protocol: undefined,\n    timeout: undefined,\n    method: 'GET',\n    host: undefined,\n    path: undefined,\n    port: undefined\n  };\n\n  websocket._autoPong = opts.autoPong;\n\n  if (!protocolVersions.includes(opts.protocolVersion)) {\n    throw new RangeError(\n      `Unsupported protocol version: ${opts.protocolVersion} ` +\n        `(supported versions: ${protocolVersions.join(', ')})`\n    );\n  }\n\n  let parsedUrl;\n\n  if (address instanceof URL) {\n    parsedUrl = address;\n  } else {\n    try {\n      parsedUrl = new URL(address);\n    } catch (e) {\n      throw new SyntaxError(`Invalid URL: ${address}`);\n    }\n  }\n\n  if (parsedUrl.protocol === 'http:') {\n    parsedUrl.protocol = 'ws:';\n  } else if (parsedUrl.protocol === 'https:') {\n    parsedUrl.protocol = 'wss:';\n  }\n\n  websocket._url = parsedUrl.href;\n\n  const isSecure = parsedUrl.protocol === 'wss:';\n  const isIpcUrl = parsedUrl.protocol === 'ws+unix:';\n  let invalidUrlMessage;\n\n  if (parsedUrl.protocol !== 'ws:' && !isSecure && !isIpcUrl) {\n    invalidUrlMessage =\n      'The URL\\'s protocol must be one of \"ws:\", \"wss:\", ' +\n      '\"http:\", \"https:\", or \"ws+unix:\"';\n  } else if (isIpcUrl && !parsedUrl.pathname) {\n    invalidUrlMessage = \"The URL's pathname is empty\";\n  } else if (parsedUrl.hash) {\n    invalidUrlMessage = 'The URL contains a fragment identifier';\n  }\n\n  if (invalidUrlMessage) {\n    const err = new SyntaxError(invalidUrlMessage);\n\n    if (websocket._redirects === 0) {\n      throw err;\n    } else {\n      emitErrorAndClose(websocket, err);\n      return;\n    }\n  }\n\n  const defaultPort = isSecure ? 443 : 80;\n  const key = randomBytes(16).toString('base64');\n  const request = isSecure ? https.request : http.request;\n  const protocolSet = new Set();\n  let perMessageDeflate;\n\n  opts.createConnection =\n    opts.createConnection || (isSecure ? tlsConnect : netConnect);\n  opts.defaultPort = opts.defaultPort || defaultPort;\n  opts.port = parsedUrl.port || defaultPort;\n  opts.host = parsedUrl.hostname.startsWith('[')\n    ? parsedUrl.hostname.slice(1, -1)\n    : parsedUrl.hostname;\n  opts.headers = {\n    ...opts.headers,\n    'Sec-WebSocket-Version': opts.protocolVersion,\n    'Sec-WebSocket-Key': key,\n    Connection: 'Upgrade',\n    Upgrade: 'websocket'\n  };\n  opts.path = parsedUrl.pathname + parsedUrl.search;\n  opts.timeout = opts.handshakeTimeout;\n\n  if (opts.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(\n      opts.perMessageDeflate !== true ? opts.perMessageDeflate : {},\n      false,\n      opts.maxPayload\n    );\n    opts.headers['Sec-WebSocket-Extensions'] = format({\n      [PerMessageDeflate.extensionName]: perMessageDeflate.offer()\n    });\n  }\n  if (protocols.length) {\n    for (const protocol of protocols) {\n      if (\n        typeof protocol !== 'string' ||\n        !subprotocolRegex.test(protocol) ||\n        protocolSet.has(protocol)\n      ) {\n        throw new SyntaxError(\n          'An invalid or duplicated subprotocol was specified'\n        );\n      }\n\n      protocolSet.add(protocol);\n    }\n\n    opts.headers['Sec-WebSocket-Protocol'] = protocols.join(',');\n  }\n  if (opts.origin) {\n    if (opts.protocolVersion < 13) {\n      opts.headers['Sec-WebSocket-Origin'] = opts.origin;\n    } else {\n      opts.headers.Origin = opts.origin;\n    }\n  }\n  if (parsedUrl.username || parsedUrl.password) {\n    opts.auth = `${parsedUrl.username}:${parsedUrl.password}`;\n  }\n\n  if (isIpcUrl) {\n    const parts = opts.path.split(':');\n\n    opts.socketPath = parts[0];\n    opts.path = parts[1];\n  }\n\n  let req;\n\n  if (opts.followRedirects) {\n    if (websocket._redirects === 0) {\n      websocket._originalIpc = isIpcUrl;\n      websocket._originalSecure = isSecure;\n      websocket._originalHostOrSocketPath = isIpcUrl\n        ? opts.socketPath\n        : parsedUrl.host;\n\n      const headers = options && options.headers;\n\n      //\n      // Shallow copy the user provided options so that headers can be changed\n      // without mutating the original object.\n      //\n      options = { ...options, headers: {} };\n\n      if (headers) {\n        for (const [key, value] of Object.entries(headers)) {\n          options.headers[key.toLowerCase()] = value;\n        }\n      }\n    } else if (websocket.listenerCount('redirect') === 0) {\n      const isSameHost = isIpcUrl\n        ? websocket._originalIpc\n          ? opts.socketPath === websocket._originalHostOrSocketPath\n          : false\n        : websocket._originalIpc\n          ? false\n          : parsedUrl.host === websocket._originalHostOrSocketPath;\n\n      if (!isSameHost || (websocket._originalSecure && !isSecure)) {\n        //\n        // Match curl 7.77.0 behavior and drop the following headers. These\n        // headers are also dropped when following a redirect to a subdomain.\n        //\n        delete opts.headers.authorization;\n        delete opts.headers.cookie;\n\n        if (!isSameHost) delete opts.headers.host;\n\n        opts.auth = undefined;\n      }\n    }\n\n    //\n    // Match curl 7.77.0 behavior and make the first `Authorization` header win.\n    // If the `Authorization` header is set, then there is nothing to do as it\n    // will take precedence.\n    //\n    if (opts.auth && !options.headers.authorization) {\n      options.headers.authorization =\n        'Basic ' + Buffer.from(opts.auth).toString('base64');\n    }\n\n    req = websocket._req = request(opts);\n\n    if (websocket._redirects) {\n      //\n      // Unlike what is done for the `'upgrade'` event, no early exit is\n      // triggered here if the user calls `websocket.close()` or\n      // `websocket.terminate()` from a listener of the `'redirect'` event. This\n      // is because the user can also call `request.destroy()` with an error\n      // before calling `websocket.close()` or `websocket.terminate()` and this\n      // would result in an error being emitted on the `request` object with no\n      // `'error'` event listeners attached.\n      //\n      websocket.emit('redirect', websocket.url, req);\n    }\n  } else {\n    req = websocket._req = request(opts);\n  }\n\n  if (opts.timeout) {\n    req.on('timeout', () => {\n      abortHandshake(websocket, req, 'Opening handshake has timed out');\n    });\n  }\n\n  req.on('error', (err) => {\n    if (req === null || req[kAborted]) return;\n\n    req = websocket._req = null;\n    emitErrorAndClose(websocket, err);\n  });\n\n  req.on('response', (res) => {\n    const location = res.headers.location;\n    const statusCode = res.statusCode;\n\n    if (\n      location &&\n      opts.followRedirects &&\n      statusCode >= 300 &&\n      statusCode < 400\n    ) {\n      if (++websocket._redirects > opts.maxRedirects) {\n        abortHandshake(websocket, req, 'Maximum redirects exceeded');\n        return;\n      }\n\n      req.abort();\n\n      let addr;\n\n      try {\n        addr = new URL(location, address);\n      } catch (e) {\n        const err = new SyntaxError(`Invalid URL: ${location}`);\n        emitErrorAndClose(websocket, err);\n        return;\n      }\n\n      initAsClient(websocket, addr, protocols, options);\n    } else if (!websocket.emit('unexpected-response', req, res)) {\n      abortHandshake(\n        websocket,\n        req,\n        `Unexpected server response: ${res.statusCode}`\n      );\n    }\n  });\n\n  req.on('upgrade', (res, socket, head) => {\n    websocket.emit('upgrade', res);\n\n    //\n    // The user may have closed the connection from a listener of the\n    // `'upgrade'` event.\n    //\n    if (websocket.readyState !== WebSocket.CONNECTING) return;\n\n    req = websocket._req = null;\n\n    const upgrade = res.headers.upgrade;\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      abortHandshake(websocket, socket, 'Invalid Upgrade header');\n      return;\n    }\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    if (res.headers['sec-websocket-accept'] !== digest) {\n      abortHandshake(websocket, socket, 'Invalid Sec-WebSocket-Accept header');\n      return;\n    }\n\n    const serverProt = res.headers['sec-websocket-protocol'];\n    let protError;\n\n    if (serverProt !== undefined) {\n      if (!protocolSet.size) {\n        protError = 'Server sent a subprotocol but none was requested';\n      } else if (!protocolSet.has(serverProt)) {\n        protError = 'Server sent an invalid subprotocol';\n      }\n    } else if (protocolSet.size) {\n      protError = 'Server sent no subprotocol';\n    }\n\n    if (protError) {\n      abortHandshake(websocket, socket, protError);\n      return;\n    }\n\n    if (serverProt) websocket._protocol = serverProt;\n\n    const secWebSocketExtensions = res.headers['sec-websocket-extensions'];\n\n    if (secWebSocketExtensions !== undefined) {\n      if (!perMessageDeflate) {\n        const message =\n          'Server sent a Sec-WebSocket-Extensions header but no extension ' +\n          'was requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      let extensions;\n\n      try {\n        extensions = parse(secWebSocketExtensions);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      const extensionNames = Object.keys(extensions);\n\n      if (\n        extensionNames.length !== 1 ||\n        extensionNames[0] !== PerMessageDeflate.extensionName\n      ) {\n        const message = 'Server indicated an extension that was not requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      try {\n        perMessageDeflate.accept(extensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      websocket._extensions[PerMessageDeflate.extensionName] =\n        perMessageDeflate;\n    }\n\n    websocket.setSocket(socket, head, {\n      allowSynchronousEvents: opts.allowSynchronousEvents,\n      generateMask: opts.generateMask,\n      maxPayload: opts.maxPayload,\n      skipUTF8Validation: opts.skipUTF8Validation\n    });\n  });\n\n  if (opts.finishRequest) {\n    opts.finishRequest(req, websocket);\n  } else {\n    req.end();\n  }\n}\n\n/**\n * Emit the `'error'` and `'close'` events.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {Error} The error to emit\n * @private\n */\nfunction emitErrorAndClose(websocket, err) {\n  websocket._readyState = WebSocket.CLOSING;\n  //\n  // The following assignment is practically useless and is done only for\n  // consistency.\n  //\n  websocket._errorEmitted = true;\n  websocket.emit('error', err);\n  websocket.emitClose();\n}\n\n/**\n * Create a `net.Socket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {net.Socket} The newly created socket used to start the connection\n * @private\n */\nfunction netConnect(options) {\n  options.path = options.socketPath;\n  return net.connect(options);\n}\n\n/**\n * Create a `tls.TLSSocket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {tls.TLSSocket} The newly created socket used to start the connection\n * @private\n */\nfunction tlsConnect(options) {\n  options.path = undefined;\n\n  if (!options.servername && options.servername !== '') {\n    options.servername = net.isIP(options.host) ? '' : options.host;\n  }\n\n  return tls.connect(options);\n}\n\n/**\n * Abort the handshake and emit an error.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {(http.ClientRequest|net.Socket|tls.Socket)} stream The request to\n *     abort or the socket to destroy\n * @param {String} message The error message\n * @private\n */\nfunction abortHandshake(websocket, stream, message) {\n  websocket._readyState = WebSocket.CLOSING;\n\n  const err = new Error(message);\n  Error.captureStackTrace(err, abortHandshake);\n\n  if (stream.setHeader) {\n    stream[kAborted] = true;\n    stream.abort();\n\n    if (stream.socket && !stream.socket.destroyed) {\n      //\n      // On Node.js >= 14.3.0 `request.abort()` does not destroy the socket if\n      // called after the request completed. See\n      // https://github.com/websockets/ws/issues/1869.\n      //\n      stream.socket.destroy();\n    }\n\n    process.nextTick(emitErrorAndClose, websocket, err);\n  } else {\n    stream.destroy(err);\n    stream.once('error', websocket.emit.bind(websocket, 'error'));\n    stream.once('close', websocket.emitClose.bind(websocket));\n  }\n}\n\n/**\n * Handle cases where the `ping()`, `pong()`, or `send()` methods are called\n * when the `readyState` attribute is `CLOSING` or `CLOSED`.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {*} [data] The data to send\n * @param {Function} [cb] Callback\n * @private\n */\nfunction sendAfterClose(websocket, data, cb) {\n  if (data) {\n    const length = isBlob(data) ? data.size : toBuffer(data).length;\n\n    //\n    // The `_bufferedAmount` property is used only when the peer is a client and\n    // the opening handshake fails. Under these circumstances, in fact, the\n    // `setSocket()` method is not called, so the `_socket` and `_sender`\n    // properties are set to `null`.\n    //\n    if (websocket._socket) websocket._sender._bufferedBytes += length;\n    else websocket._bufferedAmount += length;\n  }\n\n  if (cb) {\n    const err = new Error(\n      `WebSocket is not open: readyState ${websocket.readyState} ` +\n        `(${readyStates[websocket.readyState]})`\n    );\n    process.nextTick(cb, err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'conclude'` event.\n *\n * @param {Number} code The status code\n * @param {Buffer} reason The reason for closing\n * @private\n */\nfunction receiverOnConclude(code, reason) {\n  const websocket = this[kWebSocket];\n\n  websocket._closeFrameReceived = true;\n  websocket._closeMessage = reason;\n  websocket._closeCode = code;\n\n  if (websocket._socket[kWebSocket] === undefined) return;\n\n  websocket._socket.removeListener('data', socketOnData);\n  process.nextTick(resume, websocket._socket);\n\n  if (code === 1005) websocket.close();\n  else websocket.close(code, reason);\n}\n\n/**\n * The listener of the `Receiver` `'drain'` event.\n *\n * @private\n */\nfunction receiverOnDrain() {\n  const websocket = this[kWebSocket];\n\n  if (!websocket.isPaused) websocket._socket.resume();\n}\n\n/**\n * The listener of the `Receiver` `'error'` event.\n *\n * @param {(RangeError|Error)} err The emitted error\n * @private\n */\nfunction receiverOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._socket[kWebSocket] !== undefined) {\n    websocket._socket.removeListener('data', socketOnData);\n\n    //\n    // On Node.js < 14.0.0 the `'error'` event is emitted synchronously. See\n    // https://github.com/websockets/ws/issues/1940.\n    //\n    process.nextTick(resume, websocket._socket);\n\n    websocket.close(err[kStatusCode]);\n  }\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'finish'` event.\n *\n * @private\n */\nfunction receiverOnFinish() {\n  this[kWebSocket].emitClose();\n}\n\n/**\n * The listener of the `Receiver` `'message'` event.\n *\n * @param {Buffer|ArrayBuffer|Buffer[])} data The message\n * @param {Boolean} isBinary Specifies whether the message is binary or not\n * @private\n */\nfunction receiverOnMessage(data, isBinary) {\n  this[kWebSocket].emit('message', data, isBinary);\n}\n\n/**\n * The listener of the `Receiver` `'ping'` event.\n *\n * @param {Buffer} data The data included in the ping frame\n * @private\n */\nfunction receiverOnPing(data) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._autoPong) websocket.pong(data, !this._isServer, NOOP);\n  websocket.emit('ping', data);\n}\n\n/**\n * The listener of the `Receiver` `'pong'` event.\n *\n * @param {Buffer} data The data included in the pong frame\n * @private\n */\nfunction receiverOnPong(data) {\n  this[kWebSocket].emit('pong', data);\n}\n\n/**\n * Resume a readable stream\n *\n * @param {Readable} stream The readable stream\n * @private\n */\nfunction resume(stream) {\n  stream.resume();\n}\n\n/**\n * The `Sender` error event handler.\n *\n * @param {Error} The error\n * @private\n */\nfunction senderOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket.readyState === WebSocket.CLOSED) return;\n  if (websocket.readyState === WebSocket.OPEN) {\n    websocket._readyState = WebSocket.CLOSING;\n    setCloseTimer(websocket);\n  }\n\n  //\n  // `socket.end()` is used instead of `socket.destroy()` to allow the other\n  // peer to finish sending queued data. There is no need to set a timer here\n  // because `CLOSING` means that it is already set or not needed.\n  //\n  this._socket.end();\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * Set a timer to destroy the underlying raw socket of a WebSocket.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @private\n */\nfunction setCloseTimer(websocket) {\n  websocket._closeTimer = setTimeout(\n    websocket._socket.destroy.bind(websocket._socket),\n    closeTimeout\n  );\n}\n\n/**\n * The listener of the socket `'close'` event.\n *\n * @private\n */\nfunction socketOnClose() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('close', socketOnClose);\n  this.removeListener('data', socketOnData);\n  this.removeListener('end', socketOnEnd);\n\n  websocket._readyState = WebSocket.CLOSING;\n\n  let chunk;\n\n  //\n  // The close frame might not have been received or the `'end'` event emitted,\n  // for example, if the socket was destroyed due to an error. Ensure that the\n  // `receiver` stream is closed after writing any remaining buffered data to\n  // it. If the readable side of the socket is in flowing mode then there is no\n  // buffered data as everything has been already written and `readable.read()`\n  // will return `null`. If instead, the socket is paused, any possible buffered\n  // data will be read as a single chunk.\n  //\n  if (\n    !this._readableState.endEmitted &&\n    !websocket._closeFrameReceived &&\n    !websocket._receiver._writableState.errorEmitted &&\n    (chunk = websocket._socket.read()) !== null\n  ) {\n    websocket._receiver.write(chunk);\n  }\n\n  websocket._receiver.end();\n\n  this[kWebSocket] = undefined;\n\n  clearTimeout(websocket._closeTimer);\n\n  if (\n    websocket._receiver._writableState.finished ||\n    websocket._receiver._writableState.errorEmitted\n  ) {\n    websocket.emitClose();\n  } else {\n    websocket._receiver.on('error', receiverOnFinish);\n    websocket._receiver.on('finish', receiverOnFinish);\n  }\n}\n\n/**\n * The listener of the socket `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction socketOnData(chunk) {\n  if (!this[kWebSocket]._receiver.write(chunk)) {\n    this.pause();\n  }\n}\n\n/**\n * The listener of the socket `'end'` event.\n *\n * @private\n */\nfunction socketOnEnd() {\n  const websocket = this[kWebSocket];\n\n  websocket._readyState = WebSocket.CLOSING;\n  websocket._receiver.end();\n  this.end();\n}\n\n/**\n * The listener of the socket `'error'` event.\n *\n * @private\n */\nfunction socketOnError() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('error', socketOnError);\n  this.on('error', NOOP);\n\n  if (websocket) {\n    websocket._readyState = WebSocket.CLOSING;\n    this.destroy();\n  }\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^WebSocket$\" }] */\n'use strict';\n\nconst WebSocket = require('./websocket');\nconst { Duplex } = require('stream');\n\n/**\n * Emits the `'close'` event on a stream.\n *\n * @param {Duplex} stream The stream.\n * @private\n */\nfunction emitClose(stream) {\n  stream.emit('close');\n}\n\n/**\n * The listener of the `'end'` event.\n *\n * @private\n */\nfunction duplexOnEnd() {\n  if (!this.destroyed && this._writableState.finished) {\n    this.destroy();\n  }\n}\n\n/**\n * The listener of the `'error'` event.\n *\n * @param {Error} err The error\n * @private\n */\nfunction duplexOnError(err) {\n  this.removeListener('error', duplexOnError);\n  this.destroy();\n  if (this.listenerCount('error') === 0) {\n    // Do not suppress the throwing behavior.\n    this.emit('error', err);\n  }\n}\n\n/**\n * Wraps a `WebSocket` in a duplex stream.\n *\n * @param {WebSocket} ws The `WebSocket` to wrap\n * @param {Object} [options] The options for the `Duplex` constructor\n * @return {Duplex} The duplex stream\n * @public\n */\nfunction createWebSocketStream(ws, options) {\n  let terminateOnDestroy = true;\n\n  const duplex = new Duplex({\n    ...options,\n    autoDestroy: false,\n    emitClose: false,\n    objectMode: false,\n    writableObjectMode: false\n  });\n\n  ws.on('message', function message(msg, isBinary) {\n    const data =\n      !isBinary && duplex._readableState.objectMode ? msg.toString() : msg;\n\n    if (!duplex.push(data)) ws.pause();\n  });\n\n  ws.once('error', function error(err) {\n    if (duplex.destroyed) return;\n\n    // Prevent `ws.terminate()` from being called by `duplex._destroy()`.\n    //\n    // - If the `'error'` event is emitted before the `'open'` event, then\n    //   `ws.terminate()` is a noop as no socket is assigned.\n    // - Otherwise, the error is re-emitted by the listener of the `'error'`\n    //   event of the `Receiver` object. The listener already closes the\n    //   connection by calling `ws.close()`. This allows a close frame to be\n    //   sent to the other peer. If `ws.terminate()` is called right after this,\n    //   then the close frame might not be sent.\n    terminateOnDestroy = false;\n    duplex.destroy(err);\n  });\n\n  ws.once('close', function close() {\n    if (duplex.destroyed) return;\n\n    duplex.push(null);\n  });\n\n  duplex._destroy = function (err, callback) {\n    if (ws.readyState === ws.CLOSED) {\n      callback(err);\n      process.nextTick(emitClose, duplex);\n      return;\n    }\n\n    let called = false;\n\n    ws.once('error', function error(err) {\n      called = true;\n      callback(err);\n    });\n\n    ws.once('close', function close() {\n      if (!called) callback(err);\n      process.nextTick(emitClose, duplex);\n    });\n\n    if (terminateOnDestroy) ws.terminate();\n  };\n\n  duplex._final = function (callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._final(callback);\n      });\n      return;\n    }\n\n    // If the value of the `_socket` property is `null` it means that `ws` is a\n    // client websocket and the handshake failed. In fact, when this happens, a\n    // socket is never assigned to the websocket. Wait for the `'error'` event\n    // that will be emitted by the websocket.\n    if (ws._socket === null) return;\n\n    if (ws._socket._writableState.finished) {\n      callback();\n      if (duplex._readableState.endEmitted) duplex.destroy();\n    } else {\n      ws._socket.once('finish', function finish() {\n        // `duplex` is not destroyed here because the `'end'` event will be\n        // emitted on `duplex` after this `'finish'` event. The EOF signaling\n        // `null` chunk is, in fact, pushed when the websocket emits `'close'`.\n        callback();\n      });\n      ws.close();\n    }\n  };\n\n  duplex._read = function () {\n    if (ws.isPaused) ws.resume();\n  };\n\n  duplex._write = function (chunk, encoding, callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._write(chunk, encoding, callback);\n      });\n      return;\n    }\n\n    ws.send(chunk, callback);\n  };\n\n  duplex.on('end', duplexOnEnd);\n  duplex.on('error', duplexOnError);\n  return duplex;\n}\n\nmodule.exports = createWebSocketStream;\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n *\n * @param {String} header The field value of the header\n * @return {Set} The subprotocol names\n * @public\n */\nfunction parse(header) {\n  const protocols = new Set();\n  let start = -1;\n  let end = -1;\n  let i = 0;\n\n  for (i; i < header.length; i++) {\n    const code = header.charCodeAt(i);\n\n    if (end === -1 && tokenChars[code] === 1) {\n      if (start === -1) start = i;\n    } else if (\n      i !== 0 &&\n      (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n    ) {\n      if (end === -1 && start !== -1) end = i;\n    } else if (code === 0x2c /* ',' */) {\n      if (start === -1) {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n\n      if (end === -1) end = i;\n\n      const protocol = header.slice(start, end);\n\n      if (protocols.has(protocol)) {\n        throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n      }\n\n      protocols.add(protocol);\n      start = end = -1;\n    } else {\n      throw new SyntaxError(`Unexpected character at index ${i}`);\n    }\n  }\n\n  if (start === -1 || end !== -1) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  const protocol = header.slice(start, i);\n\n  if (protocols.has(protocol)) {\n    throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n  }\n\n  protocols.add(protocol);\n  return protocols;\n}\n\nmodule.exports = { parse };\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst http = require('http');\nconst { Duplex } = require('stream');\nconst { createHash } = require('crypto');\n\nconst extension = require('./extension');\nconst PerMessageDeflate = require('./permessage-deflate');\nconst subprotocol = require('./subprotocol');\nconst WebSocket = require('./websocket');\nconst { GUID, kWebSocket } = require('./constants');\n\nconst keyRegex = /^[+/0-9A-Za-z]{22}==$/;\n\nconst RUNNING = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\n/**\n * Class representing a WebSocket server.\n *\n * @extends EventEmitter\n */\nclass WebSocketServer extends EventEmitter {\n  /**\n   * Create a `WebSocketServer` instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n   *     automatically send a pong in response to a ping\n   * @param {Number} [options.backlog=511] The maximum length of the queue of\n   *     pending connections\n   * @param {Boolean} [options.clientTracking=true] Specifies whether or not to\n   *     track clients\n   * @param {Function} [options.handleProtocols] A hook to handle protocols\n   * @param {String} [options.host] The hostname where to bind the server\n   * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n   *     size\n   * @param {Boolean} [options.noServer=false] Enable no server mode\n   * @param {String} [options.path] Accept only connections matching this path\n   * @param {(Boolean|Object)} [options.perMessageDeflate=false] Enable/disable\n   *     permessage-deflate\n   * @param {Number} [options.port] The port where to bind the server\n   * @param {(http.Server|https.Server)} [options.server] A pre-created HTTP/S\n   *     server to use\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @param {Function} [options.verifyClient] A hook to reject connections\n   * @param {Function} [options.WebSocket=WebSocket] Specifies the `WebSocket`\n   *     class to use. It must be the `WebSocket` class or class that extends it\n   * @param {Function} [callback] A listener for the `listening` event\n   */\n  constructor(options, callback) {\n    super();\n\n    options = {\n      allowSynchronousEvents: true,\n      autoPong: true,\n      maxPayload: 100 * 1024 * 1024,\n      skipUTF8Validation: false,\n      perMessageDeflate: false,\n      handleProtocols: null,\n      clientTracking: true,\n      verifyClient: null,\n      noServer: false,\n      backlog: null, // use default (511 as implemented in net.js)\n      server: null,\n      host: null,\n      path: null,\n      port: null,\n      WebSocket,\n      ...options\n    };\n\n    if (\n      (options.port == null && !options.server && !options.noServer) ||\n      (options.port != null && (options.server || options.noServer)) ||\n      (options.server && options.noServer)\n    ) {\n      throw new TypeError(\n        'One and only one of the \"port\", \"server\", or \"noServer\" options ' +\n          'must be specified'\n      );\n    }\n\n    if (options.port != null) {\n      this._server = http.createServer((req, res) => {\n        const body = http.STATUS_CODES[426];\n\n        res.writeHead(426, {\n          'Content-Length': body.length,\n          'Content-Type': 'text/plain'\n        });\n        res.end(body);\n      });\n      this._server.listen(\n        options.port,\n        options.host,\n        options.backlog,\n        callback\n      );\n    } else if (options.server) {\n      this._server = options.server;\n    }\n\n    if (this._server) {\n      const emitConnection = this.emit.bind(this, 'connection');\n\n      this._removeListeners = addListeners(this._server, {\n        listening: this.emit.bind(this, 'listening'),\n        error: this.emit.bind(this, 'error'),\n        upgrade: (req, socket, head) => {\n          this.handleUpgrade(req, socket, head, emitConnection);\n        }\n      });\n    }\n\n    if (options.perMessageDeflate === true) options.perMessageDeflate = {};\n    if (options.clientTracking) {\n      this.clients = new Set();\n      this._shouldEmitClose = false;\n    }\n\n    this.options = options;\n    this._state = RUNNING;\n  }\n\n  /**\n   * Returns the bound address, the address family name, and port of the server\n   * as reported by the operating system if listening on an IP socket.\n   * If the server is listening on a pipe or UNIX domain socket, the name is\n   * returned as a string.\n   *\n   * @return {(Object|String|null)} The address of the server\n   * @public\n   */\n  address() {\n    if (this.options.noServer) {\n      throw new Error('The server is operating in \"noServer\" mode');\n    }\n\n    if (!this._server) return null;\n    return this._server.address();\n  }\n\n  /**\n   * Stop the server from accepting new connections and emit the `'close'` event\n   * when all existing connections are closed.\n   *\n   * @param {Function} [cb] A one-time listener for the `'close'` event\n   * @public\n   */\n  close(cb) {\n    if (this._state === CLOSED) {\n      if (cb) {\n        this.once('close', () => {\n          cb(new Error('The server is not running'));\n        });\n      }\n\n      process.nextTick(emitClose, this);\n      return;\n    }\n\n    if (cb) this.once('close', cb);\n\n    if (this._state === CLOSING) return;\n    this._state = CLOSING;\n\n    if (this.options.noServer || this.options.server) {\n      if (this._server) {\n        this._removeListeners();\n        this._removeListeners = this._server = null;\n      }\n\n      if (this.clients) {\n        if (!this.clients.size) {\n          process.nextTick(emitClose, this);\n        } else {\n          this._shouldEmitClose = true;\n        }\n      } else {\n        process.nextTick(emitClose, this);\n      }\n    } else {\n      const server = this._server;\n\n      this._removeListeners();\n      this._removeListeners = this._server = null;\n\n      //\n      // The HTTP/S server was created internally. Close it, and rely on its\n      // `'close'` event.\n      //\n      server.close(() => {\n        emitClose(this);\n      });\n    }\n  }\n\n  /**\n   * See if a given request should be handled by this server instance.\n   *\n   * @param {http.IncomingMessage} req Request object to inspect\n   * @return {Boolean} `true` if the request is valid, else `false`\n   * @public\n   */\n  shouldHandle(req) {\n    if (this.options.path) {\n      const index = req.url.indexOf('?');\n      const pathname = index !== -1 ? req.url.slice(0, index) : req.url;\n\n      if (pathname !== this.options.path) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Handle a HTTP Upgrade request.\n   *\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @public\n   */\n  handleUpgrade(req, socket, head, cb) {\n    socket.on('error', socketOnError);\n\n    const key = req.headers['sec-websocket-key'];\n    const upgrade = req.headers.upgrade;\n    const version = +req.headers['sec-websocket-version'];\n\n    if (req.method !== 'GET') {\n      const message = 'Invalid HTTP method';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 405, message);\n      return;\n    }\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      const message = 'Invalid Upgrade header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (key === undefined || !keyRegex.test(key)) {\n      const message = 'Missing or invalid Sec-WebSocket-Key header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (version !== 13 && version !== 8) {\n      const message = 'Missing or invalid Sec-WebSocket-Version header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message, {\n        'Sec-WebSocket-Version': '13, 8'\n      });\n      return;\n    }\n\n    if (!this.shouldHandle(req)) {\n      abortHandshake(socket, 400);\n      return;\n    }\n\n    const secWebSocketProtocol = req.headers['sec-websocket-protocol'];\n    let protocols = new Set();\n\n    if (secWebSocketProtocol !== undefined) {\n      try {\n        protocols = subprotocol.parse(secWebSocketProtocol);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Protocol header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    const secWebSocketExtensions = req.headers['sec-websocket-extensions'];\n    const extensions = {};\n\n    if (\n      this.options.perMessageDeflate &&\n      secWebSocketExtensions !== undefined\n    ) {\n      const perMessageDeflate = new PerMessageDeflate(\n        this.options.perMessageDeflate,\n        true,\n        this.options.maxPayload\n      );\n\n      try {\n        const offers = extension.parse(secWebSocketExtensions);\n\n        if (offers[PerMessageDeflate.extensionName]) {\n          perMessageDeflate.accept(offers[PerMessageDeflate.extensionName]);\n          extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n        }\n      } catch (err) {\n        const message =\n          'Invalid or unacceptable Sec-WebSocket-Extensions header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    //\n    // Optionally call external client verification handler.\n    //\n    if (this.options.verifyClient) {\n      const info = {\n        origin:\n          req.headers[`${version === 8 ? 'sec-websocket-origin' : 'origin'}`],\n        secure: !!(req.socket.authorized || req.socket.encrypted),\n        req\n      };\n\n      if (this.options.verifyClient.length === 2) {\n        this.options.verifyClient(info, (verified, code, message, headers) => {\n          if (!verified) {\n            return abortHandshake(socket, code || 401, message, headers);\n          }\n\n          this.completeUpgrade(\n            extensions,\n            key,\n            protocols,\n            req,\n            socket,\n            head,\n            cb\n          );\n        });\n        return;\n      }\n\n      if (!this.options.verifyClient(info)) return abortHandshake(socket, 401);\n    }\n\n    this.completeUpgrade(extensions, key, protocols, req, socket, head, cb);\n  }\n\n  /**\n   * Upgrade the connection to WebSocket.\n   *\n   * @param {Object} extensions The accepted extensions\n   * @param {String} key The value of the `Sec-WebSocket-Key` header\n   * @param {Set} protocols The subprotocols\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @throws {Error} If called more than once with the same socket\n   * @private\n   */\n  completeUpgrade(extensions, key, protocols, req, socket, head, cb) {\n    //\n    // Destroy the socket if the client has already sent a FIN packet.\n    //\n    if (!socket.readable || !socket.writable) return socket.destroy();\n\n    if (socket[kWebSocket]) {\n      throw new Error(\n        'server.handleUpgrade() was called more than once with the same ' +\n          'socket, possibly due to a misconfiguration'\n      );\n    }\n\n    if (this._state > RUNNING) return abortHandshake(socket, 503);\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    const headers = [\n      'HTTP/1.1 101 Switching Protocols',\n      'Upgrade: websocket',\n      'Connection: Upgrade',\n      `Sec-WebSocket-Accept: ${digest}`\n    ];\n\n    const ws = new this.options.WebSocket(null, undefined, this.options);\n\n    if (protocols.size) {\n      //\n      // Optionally call external protocol selection handler.\n      //\n      const protocol = this.options.handleProtocols\n        ? this.options.handleProtocols(protocols, req)\n        : protocols.values().next().value;\n\n      if (protocol) {\n        headers.push(`Sec-WebSocket-Protocol: ${protocol}`);\n        ws._protocol = protocol;\n      }\n    }\n\n    if (extensions[PerMessageDeflate.extensionName]) {\n      const params = extensions[PerMessageDeflate.extensionName].params;\n      const value = extension.format({\n        [PerMessageDeflate.extensionName]: [params]\n      });\n      headers.push(`Sec-WebSocket-Extensions: ${value}`);\n      ws._extensions = extensions;\n    }\n\n    //\n    // Allow external modification/inspection of handshake headers.\n    //\n    this.emit('headers', headers, req);\n\n    socket.write(headers.concat('\\r\\n').join('\\r\\n'));\n    socket.removeListener('error', socketOnError);\n\n    ws.setSocket(socket, head, {\n      allowSynchronousEvents: this.options.allowSynchronousEvents,\n      maxPayload: this.options.maxPayload,\n      skipUTF8Validation: this.options.skipUTF8Validation\n    });\n\n    if (this.clients) {\n      this.clients.add(ws);\n      ws.on('close', () => {\n        this.clients.delete(ws);\n\n        if (this._shouldEmitClose && !this.clients.size) {\n          process.nextTick(emitClose, this);\n        }\n      });\n    }\n\n    cb(ws, req);\n  }\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Add event listeners on an `EventEmitter` using a map of <event, listener>\n * pairs.\n *\n * @param {EventEmitter} server The event emitter\n * @param {Object.<String, Function>} map The listeners to add\n * @return {Function} A function that will remove the added listeners when\n *     called\n * @private\n */\nfunction addListeners(server, map) {\n  for (const event of Object.keys(map)) server.on(event, map[event]);\n\n  return function removeListeners() {\n    for (const event of Object.keys(map)) {\n      server.removeListener(event, map[event]);\n    }\n  };\n}\n\n/**\n * Emit a `'close'` event on an `EventEmitter`.\n *\n * @param {EventEmitter} server The event emitter\n * @private\n */\nfunction emitClose(server) {\n  server._state = CLOSED;\n  server.emit('close');\n}\n\n/**\n * Handle socket errors.\n *\n * @private\n */\nfunction socketOnError() {\n  this.destroy();\n}\n\n/**\n * Close the connection when preconditions are not fulfilled.\n *\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} [message] The HTTP response body\n * @param {Object} [headers] Additional HTTP response headers\n * @private\n */\nfunction abortHandshake(socket, code, message, headers) {\n  //\n  // The socket is writable unless the user destroyed or ended it before calling\n  // `server.handleUpgrade()` or in the `verifyClient` function, which is a user\n  // error. Handling this does not make much sense as the worst that can happen\n  // is that some of the data written by the user might be discarded due to the\n  // call to `socket.end()` below, which triggers an `'error'` event that in\n  // turn causes the socket to be destroyed.\n  //\n  message = message || http.STATUS_CODES[code];\n  headers = {\n    Connection: 'close',\n    'Content-Type': 'text/html',\n    'Content-Length': Buffer.byteLength(message),\n    ...headers\n  };\n\n  socket.once('finish', socket.destroy);\n\n  socket.end(\n    `HTTP/1.1 ${code} ${http.STATUS_CODES[code]}\\r\\n` +\n      Object.keys(headers)\n        .map((h) => `${h}: ${headers[h]}`)\n        .join('\\r\\n') +\n      '\\r\\n\\r\\n' +\n      message\n  );\n}\n\n/**\n * Emit a `'wsClientError'` event on a `WebSocketServer` if there is at least\n * one listener for it, otherwise call `abortHandshake()`.\n *\n * @param {WebSocketServer} server The WebSocket server\n * @param {http.IncomingMessage} req The request object\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} message The HTTP response body\n * @param {Object} [headers] The HTTP response headers\n * @private\n */\nfunction abortHandshakeOrEmitwsClientError(\n  server,\n  req,\n  socket,\n  code,\n  message,\n  headers\n) {\n  if (server.listenerCount('wsClientError')) {\n    const err = new Error(message);\n    Error.captureStackTrace(err, abortHandshakeOrEmitwsClientError);\n\n    server.emit('wsClientError', err, socket, req);\n  } else {\n    abortHandshake(socket, code, message, headers);\n  }\n}\n","import packageJson from \"../../package.json\"\r\nimport { ApiResponse, OAPModelDescriptionParam, MCPServerSearchParam, OAPUsage, OAPUser, OAPModelDescription, OAPLimiterCheck, OAPLimiterCheckParam } from \"../../types/oap\"\r\nimport { OAPMCPServer } from \"../../types/oap\"\r\nimport { serviceStatus } from \"./service\"\r\nimport { oapStore as store } from \"./store\"\r\nimport EventEmitter from \"node:events\"\r\nimport { OAP_ROOT_URL } from \"../../shared/oap\"\r\nimport WebSocket from \"ws\"\r\nimport { readFileSync, writeFileSync } from \"node:fs\"\r\nimport { existsSync } from \"node:fs\"\r\nimport { randomUUID } from \"node:crypto\"\r\nimport { appDir } from \"./constant\"\r\nimport path from \"node:path\"\r\nimport fse from \"fs-extra\"\r\n\r\nexport type WebsocketMessageType =\r\n  \"user.account.subscription.update\" |\r\n  \"user.account.coupon.update\" |\r\n  \"user.settings.mcps.updated\"\r\n\r\nexport type WebsocketMessage = {\r\n  type: WebsocketMessageType\r\n  data: any\r\n}\r\n\r\nexport const getToken = () => store.get(\"token\") as string | undefined\r\nexport const setToken = (token: string) => store.set(\"token\", token)\r\n\r\nexport const CLIENT_ID = (() => {\r\n  fse.ensureDirSync(appDir)\r\n  const clientIdPath = path.join(appDir, \".client\")\r\n  if (existsSync(clientIdPath)) {\r\n    return readFileSync(clientIdPath, \"utf-8\")\r\n  } else {\r\n    const id = randomUUID().slice(0, 16)\r\n    writeFileSync(clientIdPath, id)\r\n    return id\r\n  }\r\n})()\r\n\r\nclass OAPClient {\r\n  public loggedIn: boolean\r\n  private eventEmitter = new EventEmitter()\r\n  socket: WebSocket | null = null\r\n  onReceiveWebSocketMessageCB: (message: WebsocketMessage) => void = () => {}\r\n\r\n  constructor() {\r\n    const token = getToken()\r\n    this.loggedIn = !!token\r\n    if (token) {\r\n      this.openWebSocket(token)\r\n    }\r\n  }\r\n\r\n  onReceiveWebSocketMessage(cb: (message: any) => void) {\r\n    this.onReceiveWebSocketMessageCB = cb\r\n  }\r\n\r\n  registEvent(event: \"login\" | \"logout\", callback: () => void) {\r\n    this.eventEmitter.on(event, callback)\r\n  }\r\n\r\n  openWebSocket(token: string) {\r\n    try {\r\n      if (this.socket) {\r\n        this.closeWebSocket()\r\n      }\r\n\r\n      console.log(`wss://${OAP_ROOT_URL.split(\"://\")[1]}/api/v1/socket`)\r\n      this.socket = new WebSocket(`wss://${OAP_ROOT_URL.split(\"://\")[1]}/api/v1/socket`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      })\r\n\r\n      this.socket.on(\"message\", (message) => {\r\n        this.onReceiveWebSocketMessageCB(JSON.parse(message.toString()) as WebsocketMessage)\r\n      })\r\n\r\n      this.socket.on(\"open\", () => {\r\n        console.log(\"oap socket connected\")\r\n      })\r\n\r\n      this.socket.on(\"close\", () => {\r\n        console.log(\"oap socket closed\")\r\n      })\r\n\r\n      this.socket.on(\"error\", (error) => {\r\n        console.error(\"oap socket error\", error)\r\n      })\r\n    } catch (error) {\r\n      console.error(\"openWebSocket\", error)\r\n    }\r\n  }\r\n\r\n  closeWebSocket() {\r\n    try {\r\n      if (this.socket) {\r\n        this.socket.close()\r\n        this.socket = null\r\n      }\r\n    } catch (error) {\r\n      console.error(\"closeWebSocket\", error)\r\n    }\r\n  }\r\n\r\n  login(token: string) {\r\n    setToken(token)\r\n    this.loggedIn = true\r\n    this.eventEmitter.emit(\"login\")\r\n    this.openWebSocket(token)\r\n  }\r\n\r\n  async logout() {\r\n    const token = getToken()\r\n    if (token) {\r\n      await this.fetch(\"/api/v1/user/logout\").catch(console.error)\r\n    }\r\n\r\n    setToken(\"\")\r\n    this.loggedIn = false\r\n    this.eventEmitter.emit(\"logout\")\r\n\r\n    const url = `http://${serviceStatus.ip}:${serviceStatus.port}`\r\n    fetch(`${url}/api/plugins/oap-platform/auth`, { method: \"DELETE\" })\r\n      .then((res) => console.log(\"oap logout\", res.status))\r\n\r\n    this.closeWebSocket()\r\n  }\r\n\r\n  fetch<T>(url: string, options: RequestInit = {}) {\r\n    const token = getToken()\r\n    if (!token) {\r\n      this.logout()\r\n      throw new Error(\"not logged in\")\r\n    }\r\n\r\n    return fetch(`${OAP_ROOT_URL}${url}`, {\r\n      ...options,\r\n      headers: {\r\n        ...options.headers,\r\n        Authorization: `Bearer ${token}`,\r\n        \"User-Agent\": `Dive Desktop(${CLIENT_ID})-${packageJson.version}`,\r\n      },\r\n    }).then((res) => res.text() as Promise<T>)\r\n    .then(text => {\r\n      try {\r\n        return JSON.parse(text as string) as T\r\n      } catch (_error) {\r\n        return text as T\r\n      }\r\n    })\r\n  }\r\n\r\n  getMCPTags() {\r\n    return this.fetch<{ body: { tag: string, count: number }[], error: null, status_code: number, status_message: string }>(\"/api/v1/mcp/tags\")\r\n  }\r\n\r\n  getMCPServers() {\r\n    return this.fetch<ApiResponse<OAPMCPServer[]>>(\"/api/v1/user/mcp/configs\")\r\n  }\r\n\r\n  searchMCPServer(params: MCPServerSearchParam) {\r\n    return this.fetch<ApiResponse<OAPMCPServer[]>>(\"/api/v1/user/mcp/search2\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(params),\r\n    })\r\n  }\r\n\r\n  modelDescription(params?: OAPModelDescriptionParam) {\r\n    if (params && params?.models.length > 0) {\r\n      return this.fetch<ApiResponse<OAPModelDescription[]>>(\"/api/v1/llms/query\", {\r\n        method: \"POST\",\r\n        body: JSON.stringify(params),\r\n      })\r\n    } else {\r\n      return this.fetch<ApiResponse<OAPModelDescription[]>>(\"/api/v1/llms\")\r\n    }\r\n  }\r\n\r\n  applyMCPServer(ids: string[]) {\r\n    return this.fetch<ApiResponse<OAPMCPServer>>(\"/api/v1/user/mcp/apply\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(ids),\r\n    })\r\n  }\r\n\r\n  getMe() {\r\n    return this.fetch<ApiResponse<OAPUser>>(\"/api/v1/user/me\")\r\n  }\r\n\r\n  getUsage() {\r\n    return this.fetch<ApiResponse<OAPUsage>>(\"/api/v1/user/usage\")\r\n  }\r\n\r\n  limiterCheck(params: OAPLimiterCheckParam) {\r\n    return this.fetch<ApiResponse<OAPLimiterCheck>>(\"/api/v1/user/limiter/check\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(params),\r\n    })\r\n  }\r\n}\r\n\r\nexport const oapClient = new OAPClient()\r\n","import { app, ipcMain } from \"electron\"\r\nimport { createRequire } from \"node:module\"\r\nimport type {\r\n  ProgressInfo,\r\n  UpdateDownloadedEvent,\r\n  UpdateInfo,\r\n} from \"electron-updater\"\r\nimport path from \"node:path\"\r\nimport { cwd } from \"./constant\"\r\nimport { CLIENT_ID } from \"./oap\"\r\nimport { OAP_ROOT_URL } from \"../../shared/oap\"\r\n\r\nconst { autoUpdater } = createRequire(import.meta.url)(\"electron-updater\")\r\n\r\n// Update server configuration\r\nconst PRIMARY_UPDATE_SERVER = `${OAP_ROOT_URL}/api/v1/version`\r\nconst FALLBACK_CONFIG = {\r\n  provider: \"github\",\r\n  owner: \"OpenAgentPlatform\",\r\n  repo: \"Dive\"\r\n}\r\n\r\n// Auto update check configuration\r\nconst CHECK_INTERVAL = 60 * 60 * 1000 // 1 hour in milliseconds\r\nconst INITIAL_DELAY = 3 * 1000 // 3 seconds delay for first check\r\n\r\nlet useFallback = false\r\n\r\nexport function update(win: Electron.BrowserWindow) {\r\n\r\n  // When set to false, the update download will be triggered through the API\r\n  autoUpdater.autoDownload = false\r\n  autoUpdater.disableWebInstaller = false\r\n  autoUpdater.allowDowngrade = false\r\n\r\n  if (process.env.DEBUG) {\r\n    autoUpdater.updateConfigPath = path.join(cwd, \"dev-app-update.yml\")\r\n  }\r\n\r\n  // Setup automatic update checking\r\n  if (app.isPackaged) {\r\n    // First check after initial delay\r\n    setTimeout(() => {\r\n      performAutoUpdateCheck()\r\n    }, INITIAL_DELAY)\r\n\r\n    // Periodic checks every hour\r\n    setInterval(() => {\r\n      performAutoUpdateCheck()\r\n    }, CHECK_INTERVAL)\r\n  }\r\n\r\n  async function performAutoUpdateCheck() {\r\n    try {\r\n      console.log(\"Performing automatic update check...\")\r\n      if (!useFallback) {\r\n        await configurePrimaryServer()\r\n      }\r\n      await autoUpdater.checkForUpdatesAndNotify()\r\n    } catch (error) {\r\n      console.error(\"Auto update check failed:\", error)\r\n      // Silent failure for automatic checks\r\n    }\r\n  }\r\n\r\n  // start check\r\n  autoUpdater.on(\"checking-for-update\", function () { })\r\n  // update available\r\n  autoUpdater.on(\"update-available\", (arg: UpdateInfo) => {\r\n    win.webContents.send(\"update-can-available\", { update: true, version: app.getVersion(), newVersion: arg?.version })\r\n  })\r\n  // update not available\r\n  autoUpdater.on(\"update-not-available\", (arg: UpdateInfo) => {\r\n    win.webContents.send(\"update-can-available\", { update: false, version: app.getVersion(), newVersion: arg?.version })\r\n  })\r\n\r\n  // Checking for updates with fallback mechanism\r\n  ipcMain.handle(\"check-update\", async () => {\r\n    if (!app.isPackaged) {\r\n      const error = new Error(\"The update feature is only available after the package.\")\r\n      return { message: error.message, error }\r\n    }\r\n\r\n    try {\r\n      // Try primary server first\r\n      if (!useFallback) {\r\n        await configurePrimaryServer()\r\n      }\r\n\r\n      return await autoUpdater.checkForUpdatesAndNotify()\r\n    } catch (error) {\r\n      console.error(\"Primary update server failed:\", error)\r\n\r\n      // If primary server fails and we haven't tried fallback yet\r\n      if (!useFallback) {\r\n        console.log(\"Switching to fallback update server (GitHub)\")\r\n        useFallback = true\r\n        configureFallbackServer()\r\n\r\n        try {\r\n          // Try fallback server (GitHub)\r\n          return await autoUpdater.checkForUpdatesAndNotify()\r\n        } catch (fallbackError) {\r\n          console.error(\"Fallback update server also failed:\", fallbackError)\r\n          return { message: \"All update servers failed\", error: fallbackError }\r\n        }\r\n      }\r\n\r\n      return { message: \"Network error\", error }\r\n    }\r\n  })\r\n\r\n  // Start downloading and feedback on progress\r\n  ipcMain.handle(\"start-download\", (event: Electron.IpcMainInvokeEvent) => {\r\n    startDownload(\r\n      (error, progressInfo) => {\r\n        if (error) {\r\n          // feedback download error message\r\n          event.sender.send(\"update-error\", { message: error.message, error })\r\n        } else {\r\n          // feedback update progress message\r\n          event.sender.send(\"download-progress\", progressInfo)\r\n        }\r\n      },\r\n      () => {\r\n        // feedback update downloaded message\r\n        event.sender.send(\"update-downloaded\")\r\n      }\r\n    )\r\n  })\r\n\r\n  // Install now\r\n  ipcMain.handle(\"quit-and-install\", () => {\r\n    autoUpdater.quitAndInstall(false, true)\r\n  })\r\n}\r\n\r\nfunction startDownload(\r\n  callback: (error: Error | null, info: ProgressInfo | null) => void,\r\n  complete: (event: UpdateDownloadedEvent) => void,\r\n) {\r\n  autoUpdater.on(\"download-progress\", (info: ProgressInfo) => callback(null, info))\r\n  autoUpdater.on(\"error\", (error: Error) => callback(error, null))\r\n  autoUpdater.on(\"update-downloaded\", complete)\r\n  autoUpdater.downloadUpdate()\r\n}\r\n\r\n// Configure primary update server (custom server)\r\nasync function configurePrimaryServer() {\r\n  console.log(\"Configuring primary update server:\", PRIMARY_UPDATE_SERVER)\r\n\r\n  // Set custom request headers\r\n  autoUpdater.requestHeaders = {\r\n    \"User-Agent\": `DiveDesktop/${app.getVersion()}`,\r\n    \"X-Dive-Id\": CLIENT_ID,\r\n  }\r\n\r\n  autoUpdater.setFeedURL({\r\n    provider: \"generic\",\r\n    url: PRIMARY_UPDATE_SERVER,\r\n  })\r\n}\r\n\r\n// Configure fallback update server (GitHub releases)\r\nfunction configureFallbackServer() {\r\n  console.log(\"Configuring fallback update server: GitHub\")\r\n  autoUpdater.requestHeaders = {}\r\n  autoUpdater.setFeedURL(FALLBACK_CONFIG)\r\n}\r\n","import { app, ipcMain, BrowserWindow } from \"electron\"\r\nimport { serviceStatus } from \"../service\"\r\nimport path from \"node:path\"\r\nimport { VITE_DEV_SERVER_URL } from \"../constant\"\r\n\r\nexport function ipcEnvHandler(_win: BrowserWindow) {\r\n  ipcMain.handle(\"env:getPlatform\", async () => {\r\n    return process.platform\r\n  })\r\n\r\n  ipcMain.handle(\"env:port\", async () => {\r\n    return serviceStatus.port\r\n  })\r\n\r\n  ipcMain.handle(\"env:getResourcesPath\", async (_, p: string) => {\r\n    return app.isPackaged ? path.join(process.resourcesPath, p) : p\r\n  })\r\n\r\n  ipcMain.handle(\"env:isDev\", async () => {\r\n    return !!VITE_DEV_SERVER_URL\r\n  })\r\n}\r\n\r\n","import fse from \"fs-extra\"\r\nimport path from \"path\"\r\nimport { execSync } from \"child_process\"\r\n\r\nexport function setAppImageAutoLaunch(enable: boolean) {\r\n  if (!process.env.APPIMAGE) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    const appImagePath = process.env.APPIMAGE\r\n\r\n    try {\r\n      execSync(`chmod +x \"${appImagePath}\"`)\r\n    } catch (error) {\r\n      console.error(\"Failed to set executable permission for AppImage\", error)\r\n    }\r\n\r\n    const autostartDir = path.join(\r\n      process.env.HOME || \"~\",\r\n      \".config/autostart\"\r\n    )\r\n\r\n    if (!fse.existsSync(autostartDir)) {\r\n      fse.mkdirSync(autostartDir, { recursive: true })\r\n    }\r\n\r\n    const desktopFile = path.join(autostartDir, \"dive-ai.desktop\")\r\n\r\n    if (enable) {\r\n      const desktopContent = getAppImageDesktopFile()\r\n      fse.writeFileSync(desktopFile, desktopContent)\r\n    } else {\r\n      if (fse.existsSync(desktopFile)) {\r\n        fse.unlinkSync(desktopFile)\r\n      }\r\n    }\r\n    return true\r\n  } catch (error) {\r\n    return false\r\n  }\r\n}\r\n\r\nexport function checkAppImageAutoLaunchStatus() {\r\n  if (!process.env.APPIMAGE) {\r\n    return false\r\n  }\r\n\r\n  const desktopFile = path.join(\r\n    process.env.HOME || \"~\",\r\n    \".config/autostart/dive-ai.desktop\"\r\n  )\r\n  return fse.existsSync(desktopFile)\r\n}\r\n\r\nexport function getAppImageDesktopFile() {\r\n  const desktopFile = path.join(process.env.VITE_PUBLIC, \"linux\", \"dive-ai.desktop\")\r\n  const content = fse.existsSync(desktopFile) ? fse.readFileSync(desktopFile, \"utf-8\") : `[Desktop Entry]\r\nType=Application\r\nName=Dive AI\r\nExec=%EXEC%\r\nIcon=%ICON%\r\nStartupNotify=false\r\nTerminal=false\r\nCategories=Utility;\r\n%APPEND%`\r\n\r\n  return content\r\n    .replace(\"%EXEC%\", process.env.APPIMAGE!)\r\n    .replace(\"%ICON%\", path.join(process.env.VITE_PUBLIC, \"icon.ico\"))\r\n    .replace(\"%APPEND%\", \"X-GNOME-Autostart-enabled=true\")\r\n}","import { app, BrowserWindow, Menu, MenuItemConstructorOptions, Tray } from \"electron\"\r\nimport path from \"node:path\"\r\nimport AppState from \"./state\"\r\n\r\nlet tray: Tray | null = null\r\n\r\nexport function initTray(win: BrowserWindow) {\r\n  if (process.platform === \"darwin\") {\r\n    return\r\n  }\r\n\r\n  const iconPath = process.platform === \"win32\"\r\n    ? path.join(process.env.VITE_PUBLIC, \"icon.ico\")\r\n    : path.join(process.env.VITE_PUBLIC, \"icon.png\")\r\n\r\n  tray = new Tray(iconPath)\r\n  tray.setToolTip(app.getName())\r\n\r\n  updateTrayMenu(win)\r\n\r\n  tray.on(\"click\", () => {\r\n    win.show()\r\n  })\r\n}\r\n\r\nfunction updateTrayMenu(win: BrowserWindow) {\r\n  const menuTemplate: MenuItemConstructorOptions[] = [\r\n    {\r\n      label: \"Open\",\r\n      click: () => {\r\n        win.show()\r\n      },\r\n    },\r\n    { type: \"separator\" },\r\n    {\r\n      label: \"Quit\",\r\n      click: () => {\r\n        AppState.setIsQuitting(true)\r\n        app.quit()\r\n      },\r\n    },\r\n  ]\r\n\r\n  const contextMenu = Menu.buildFromTemplate(menuTemplate)\r\n  tray?.setContextMenu(contextMenu)\r\n}\r\n\r\nexport function destroyTray() {\r\n  tray?.destroy()\r\n  tray = null\r\n}\r\n","import { app, ipcMain, shell, BrowserWindow } from \"electron\"\r\nimport AppState from \"../state\"\r\nimport { scriptsDir } from \"../constant\"\r\nimport { preferencesStore } from \"../store\"\r\n\r\nimport {\r\n  checkAppImageAutoLaunchStatus,\r\n  setAppImageAutoLaunch,\r\n} from \"../platform/appimage\"\r\nimport { destroyTray, initTray } from \"../tray\"\r\n\r\nexport function ipcSystemHandler(win: BrowserWindow) {\r\n  ipcMain.handle(\"system:openScriptsDir\", async () => {\r\n    shell.openPath(scriptsDir)\r\n  })\r\n\r\n  ipcMain.handle(\"system:getAutoLaunch\", () => {\r\n    if (process.env.APPIMAGE) {\r\n      return checkAppImageAutoLaunchStatus()\r\n    }\r\n\r\n    return app.getLoginItemSettings().openAtLogin\r\n  })\r\n\r\n  ipcMain.handle(\"system:setAutoLaunch\", (event, enable) => {\r\n    preferencesStore.set(\"autoLaunch\", enable)\r\n\r\n    if (process.env.APPIMAGE) {\r\n      setAppImageAutoLaunch(enable)\r\n    } else {\r\n      app.setLoginItemSettings({\r\n        openAtLogin: enable,\r\n        openAsHidden: false,\r\n      })\r\n    }\r\n\r\n    return enable\r\n  })\r\n\r\n  ipcMain.handle(\"system:getMinimalToTray\", () => {\r\n    return preferencesStore.get(\"minimalToTray\")\r\n  })\r\n\r\n  ipcMain.handle(\"system:setMinimalToTray\", (event, enable) => {\r\n    preferencesStore.set(\"minimalToTray\", enable)\r\n    AppState.setIsQuitting(!enable)\r\n\r\n    if (enable) {\r\n      initTray(win)\r\n    } else {\r\n      destroyTray()\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"system:closeWindow\", () => {\r\n    win.close()\r\n  })\r\n\r\n  ipcMain.handle(\"system:hideWindow\", () => {\r\n    win.hide()\r\n  })\r\n}\r\n","import { app, BrowserWindow } from \"electron\"\r\nimport { exec } from \"node:child_process\"\r\nimport path from \"node:path\"\r\nimport fs from \"fs-extra\"\r\nimport { oapClient } from \"./oap\"\r\nimport { serviceStatus, setServiceUpCallback } from \"./service\"\r\nimport { createWindow } from \".\"\r\n\r\nconst DESKTOP_FILE_NAME = \"oaphub-dive.desktop\"\r\ntype DeepLinkType = \"login\" | \"refresh\" | \"mcp.install\" | \"mcp.oauth.redirect\" | \"open\" | \"unknown\"\r\n\r\nfunction getDeepLinkTypeFromUrl(url: string): DeepLinkType {\r\n  if (url.startsWith(\"dive://signin/\")) {\r\n    return \"login\"\r\n  }\r\n\r\n  if (url.includes(\"refresh\")) {\r\n    return \"refresh\"\r\n  }\r\n\r\n  if (url.includes(\"mcp.install\")) {\r\n    return \"mcp.install\"\r\n  }\r\n\r\n  if (url.includes(\"mcp.oauth.redirect\")) {\r\n    return \"mcp.oauth.redirect\"\r\n  }\r\n\r\n  return \"unknown\"\r\n}\r\n\r\nexport async function refreshConfig() {\r\n  const url = `http://${serviceStatus.ip}:${serviceStatus.port}`\r\n  await fetch(`${url}/api/plugins/oap-platform/config/refresh`, { method: \"POST\" })\r\n    .then((res) => res.json())\r\n    .then((res) => console.log(\"refresh config\", res))\r\n}\r\n\r\nexport function setOAPTokenToHost(token: string) {\r\n  const setHostToken = async (ip: string, port: number) => {\r\n    const url = `http://${ip}:${port}`\r\n    await fetch(`${url}/api/plugins/oap-platform/auth`, {\r\n      method: \"POST\",\r\n      body: JSON.stringify({ token }),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\"\r\n      }\r\n    })\r\n      .then((res) => res.json())\r\n      .then((res) => console.log(\"set token to host\", res))\r\n      .then(refreshConfig)\r\n      .catch(console.error)\r\n\r\n    oapClient.login(token)\r\n  }\r\n\r\n  if (serviceStatus.port) {\r\n    setHostToken(serviceStatus.ip, serviceStatus.port)\r\n  } else {\r\n    setServiceUpCallback(setHostToken)\r\n  }\r\n\r\n  oapClient.login(token)\r\n}\r\n\r\nfunction handleLoginFromDeepLink(url: string) {\r\n  const token = url.split(\"/\").pop()\r\n  if (!token) {\r\n    console.error(\"No token found in deep link\")\r\n    return\r\n  }\r\n\r\n  console.info(\"login from deep link\")\r\n  setOAPTokenToHost(token)\r\n}\r\n\r\nexport async function deeplinkHandler(win: BrowserWindow|null, url: string) {\r\n  const allWindows = BrowserWindow.getAllWindows()\r\n  if (!win && allWindows.length) {\r\n    win = allWindows[0]\r\n  }\r\n\r\n  if (win) {\r\n    win.show()\r\n    win.focus()\r\n  } else {\r\n    await createWindow().catch(console.error)\r\n  }\r\n\r\n  switch (getDeepLinkTypeFromUrl(url)) {\r\n    case \"login\":\r\n      handleLoginFromDeepLink(url)\r\n      break\r\n    case \"refresh\":\r\n      win?.webContents.send(\"refresh\")\r\n      refreshConfig().catch(console.error)\r\n      break\r\n    case \"mcp.install\":\r\n      const deeplink = new URL(url)\r\n      win?.webContents.send(\"mcp.install\", {\r\n        name: deeplink.searchParams.get(\"name\") || \"\",\r\n        config: deeplink.searchParams.get(\"config\") || \"\",\r\n      })\r\n      break\r\n    case \"mcp.oauth.redirect\":\r\n      const callbackUrl = `http://${serviceStatus.ip}:${serviceStatus.port}`\r\n      fetch(`${callbackUrl}/api/tools/login/oauth/callback?${url.split(\"?\")[1]}`)\r\n      break\r\n    case \"open\":\r\n      win?.show()\r\n      win?.focus()\r\n      break\r\n    default:\r\n      break\r\n  }\r\n}\r\n\r\nexport async function setupAppImageDeepLink(): Promise<void> {\r\n  // Only run on Linux and when packaged as an AppImage\r\n  if (process.platform !== \"linux\" || !process.env.APPIMAGE) {\r\n    return\r\n  }\r\n\r\n  try {\r\n    const appPath = app.getPath(\"exe\")\r\n    if (!appPath) {\r\n      console.error(\"Could not determine App path.\")\r\n      return\r\n    }\r\n\r\n    const homeDir = app.getPath(\"home\")\r\n    const applicationsDir = path.join(homeDir, \".local\", \"share\", \"applications\")\r\n    const desktopFilePath = path.join(applicationsDir, DESKTOP_FILE_NAME)\r\n\r\n    // Ensure the applications directory exists\r\n    await fs.mkdir(applicationsDir, { recursive: true })\r\n\r\n    // Content of the .desktop file\r\n    // %U allows passing the URL to the application\r\n    // NoDisplay=true hides it from the regular application menu\r\n    const desktopFileContent = `[Desktop Entry]\r\nName=Dive\r\nExec=${escapePathForExec(appPath)} %U\r\nTerminal=false\r\nType=Application\r\nMimeType=x-scheme-handler/dive;\r\nNoDisplay=true\r\n`\r\n\r\n    // Write the .desktop file (overwrite if exists)\r\n    await fs.writeFile(desktopFilePath, desktopFileContent, \"utf-8\")\r\n    console.info(`Created/Updated desktop file: ${desktopFilePath}`)\r\n\r\n    // Update the desktop database\r\n    // It\"s important to update the database for the changes to take effect\r\n    try {\r\n      const { stdout, stderr } = exec(`update-desktop-database ${escapePathForExec(applicationsDir)}`)\r\n      if (stderr) {\r\n        console.warn(`update-desktop-database stderr: ${stderr}`)\r\n      }\r\n      console.info(`update-desktop-database stdout: ${stdout}`)\r\n      console.info(\"Desktop database updated successfully.\")\r\n    } catch (updateError) {\r\n      console.error(\"Failed to update desktop database:\", updateError)\r\n      // Continue even if update fails, as the file is still created.\r\n    }\r\n  } catch (error) {\r\n    // Log the error but don\"t prevent the app from starting\r\n    console.error(\"Failed to setup AppImage deep link:\", error)\r\n  }\r\n}\r\n\r\n/**\r\n * Escapes a path for safe use within the Exec field of a .desktop file\r\n * and for shell commands. Handles spaces and potentially other special characters\r\n * by quoting.\r\n */\r\nfunction escapePathForExec(filePath: string): string {\r\n  // Simple quoting for paths with spaces.\r\n  return `'${filePath.replace(/'/g, \"'\\\\''\")}'`\r\n}\r\n","\"use strict\";\n/**\n * This is the Posix implementation of isexe, which uses the file\n * mode and uid/gid values.\n *\n * @module\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sync = exports.isexe = void 0;\nconst fs_1 = require(\"fs\");\nconst promises_1 = require(\"fs/promises\");\n/**\n * Determine whether a path is executable according to the mode and\n * current (or specified) user and group IDs.\n */\nconst isexe = async (path, options = {}) => {\n    const { ignoreErrors = false } = options;\n    try {\n        return checkStat(await (0, promises_1.stat)(path), options);\n    }\n    catch (e) {\n        const er = e;\n        if (ignoreErrors || er.code === 'EACCES')\n            return false;\n        throw er;\n    }\n};\nexports.isexe = isexe;\n/**\n * Synchronously determine whether a path is executable according to\n * the mode and current (or specified) user and group IDs.\n */\nconst sync = (path, options = {}) => {\n    const { ignoreErrors = false } = options;\n    try {\n        return checkStat((0, fs_1.statSync)(path), options);\n    }\n    catch (e) {\n        const er = e;\n        if (ignoreErrors || er.code === 'EACCES')\n            return false;\n        throw er;\n    }\n};\nexports.sync = sync;\nconst checkStat = (stat, options) => stat.isFile() && checkMode(stat, options);\nconst checkMode = (stat, options) => {\n    const myUid = options.uid ?? process.getuid?.();\n    const myGroups = options.groups ?? process.getgroups?.() ?? [];\n    const myGid = options.gid ?? process.getgid?.() ?? myGroups[0];\n    if (myUid === undefined || myGid === undefined) {\n        throw new Error('cannot get uid or gid');\n    }\n    const groups = new Set([myGid, ...myGroups]);\n    const mod = stat.mode;\n    const uid = stat.uid;\n    const gid = stat.gid;\n    const u = parseInt('100', 8);\n    const g = parseInt('010', 8);\n    const o = parseInt('001', 8);\n    const ug = u | g;\n    return !!(mod & o ||\n        (mod & g && groups.has(gid)) ||\n        (mod & u && uid === myUid) ||\n        (mod & ug && myUid === 0));\n};\n//# sourceMappingURL=posix.js.map","\"use strict\";\n/**\n * This is the Windows implementation of isexe, which uses the file\n * extension and PATHEXT setting.\n *\n * @module\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sync = exports.isexe = void 0;\nconst fs_1 = require(\"fs\");\nconst promises_1 = require(\"fs/promises\");\n/**\n * Determine whether a path is executable based on the file extension\n * and PATHEXT environment variable (or specified pathExt option)\n */\nconst isexe = async (path, options = {}) => {\n    const { ignoreErrors = false } = options;\n    try {\n        return checkStat(await (0, promises_1.stat)(path), path, options);\n    }\n    catch (e) {\n        const er = e;\n        if (ignoreErrors || er.code === 'EACCES')\n            return false;\n        throw er;\n    }\n};\nexports.isexe = isexe;\n/**\n * Synchronously determine whether a path is executable based on the file\n * extension and PATHEXT environment variable (or specified pathExt option)\n */\nconst sync = (path, options = {}) => {\n    const { ignoreErrors = false } = options;\n    try {\n        return checkStat((0, fs_1.statSync)(path), path, options);\n    }\n    catch (e) {\n        const er = e;\n        if (ignoreErrors || er.code === 'EACCES')\n            return false;\n        throw er;\n    }\n};\nexports.sync = sync;\nconst checkPathExt = (path, options) => {\n    const { pathExt = process.env.PATHEXT || '' } = options;\n    const peSplit = pathExt.split(';');\n    if (peSplit.indexOf('') !== -1) {\n        return true;\n    }\n    for (let i = 0; i < peSplit.length; i++) {\n        const p = peSplit[i].toLowerCase();\n        const ext = path.substring(path.length - p.length).toLowerCase();\n        if (p && ext === p) {\n            return true;\n        }\n    }\n    return false;\n};\nconst checkStat = (stat, path, options) => stat.isFile() && checkPathExt(path, options);\n//# sourceMappingURL=win32.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=options.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sync = exports.isexe = exports.posix = exports.win32 = void 0;\nconst posix = __importStar(require(\"./posix.js\"));\nexports.posix = posix;\nconst win32 = __importStar(require(\"./win32.js\"));\nexports.win32 = win32;\n__exportStar(require(\"./options.js\"), exports);\nconst platform = process.env._ISEXE_TEST_PLATFORM_ || process.platform;\nconst impl = platform === 'win32' ? win32 : posix;\n/**\n * Determine whether a path is executable on the current platform.\n */\nexports.isexe = impl.isexe;\n/**\n * Synchronously determine whether a path is executable on the\n * current platform.\n */\nexports.sync = impl.sync;\n//# sourceMappingURL=index.js.map","const { isexe, sync: isexeSync } = require('isexe')\nconst { join, delimiter, sep, posix } = require('path')\n\nconst isWindows = process.platform === 'win32'\n\n// used to check for slashed in commands passed in. always checks for the posix\n// seperator on all platforms, and checks for the current separator when not on\n// a posix platform. don't use the isWindows check for this since that is mocked\n// in tests but we still need the code to actually work when called. that is also\n// why it is ignored from coverage.\n/* istanbul ignore next */\nconst rSlash = new RegExp(`[${posix.sep}${sep === posix.sep ? '' : sep}]`.replace(/(\\\\)/g, '\\\\$1'))\nconst rRel = new RegExp(`^\\\\.${rSlash.source}`)\n\nconst getNotFoundError = (cmd) =>\n  Object.assign(new Error(`not found: ${cmd}`), { code: 'ENOENT' })\n\nconst getPathInfo = (cmd, {\n  path: optPath = process.env.PATH,\n  pathExt: optPathExt = process.env.PATHEXT,\n  delimiter: optDelimiter = delimiter,\n}) => {\n  // If it has a slash, then we don't bother searching the pathenv.\n  // just check the file itself, and that's it.\n  const pathEnv = cmd.match(rSlash) ? [''] : [\n    // windows always checks the cwd first\n    ...(isWindows ? [process.cwd()] : []),\n    ...(optPath || /* istanbul ignore next: very unusual */ '').split(optDelimiter),\n  ]\n\n  if (isWindows) {\n    const pathExtExe = optPathExt ||\n      ['.EXE', '.CMD', '.BAT', '.COM'].join(optDelimiter)\n    const pathExt = pathExtExe.split(optDelimiter).flatMap((item) => [item, item.toLowerCase()])\n    if (cmd.includes('.') && pathExt[0] !== '') {\n      pathExt.unshift('')\n    }\n    return { pathEnv, pathExt, pathExtExe }\n  }\n\n  return { pathEnv, pathExt: [''] }\n}\n\nconst getPathPart = (raw, cmd) => {\n  const pathPart = /^\".*\"$/.test(raw) ? raw.slice(1, -1) : raw\n  const prefix = !pathPart && rRel.test(cmd) ? cmd.slice(0, 2) : ''\n  return prefix + join(pathPart, cmd)\n}\n\nconst which = async (cmd, opt = {}) => {\n  const { pathEnv, pathExt, pathExtExe } = getPathInfo(cmd, opt)\n  const found = []\n\n  for (const envPart of pathEnv) {\n    const p = getPathPart(envPart, cmd)\n\n    for (const ext of pathExt) {\n      const withExt = p + ext\n      const is = await isexe(withExt, { pathExt: pathExtExe, ignoreErrors: true })\n      if (is) {\n        if (!opt.all) {\n          return withExt\n        }\n        found.push(withExt)\n      }\n    }\n  }\n\n  if (opt.all && found.length) {\n    return found\n  }\n\n  if (opt.nothrow) {\n    return null\n  }\n\n  throw getNotFoundError(cmd)\n}\n\nconst whichSync = (cmd, opt = {}) => {\n  const { pathEnv, pathExt, pathExtExe } = getPathInfo(cmd, opt)\n  const found = []\n\n  for (const pathEnvPart of pathEnv) {\n    const p = getPathPart(pathEnvPart, cmd)\n\n    for (const ext of pathExt) {\n      const withExt = p + ext\n      const is = isexeSync(withExt, { pathExt: pathExtExe, ignoreErrors: true })\n      if (is) {\n        if (!opt.all) {\n          return withExt\n        }\n        found.push(withExt)\n      }\n    }\n  }\n\n  if (opt.all && found.length) {\n    return found\n  }\n\n  if (opt.nothrow) {\n    return null\n  }\n\n  throw getNotFoundError(cmd)\n}\n\nmodule.exports = which\nwhich.sync = whichSync\n","/*!\n * mime-db\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015-2022 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n/**\n * Module exports.\n */\n\nmodule.exports = require('./db.json')\n","/*!\n * mime-types\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar db = require('mime-db')\nvar extname = require('path').extname\n\n/**\n * Module variables.\n * @private\n */\n\nvar EXTRACT_TYPE_REGEXP = /^\\s*([^;\\s]*)(?:;|\\s|$)/\nvar TEXT_TYPE_REGEXP = /^text\\//i\n\n/**\n * Module exports.\n * @public\n */\n\nexports.charset = charset\nexports.charsets = { lookup: charset }\nexports.contentType = contentType\nexports.extension = extension\nexports.extensions = Object.create(null)\nexports.lookup = lookup\nexports.types = Object.create(null)\n\n// Populate the extensions/types maps\npopulateMaps(exports.extensions, exports.types)\n\n/**\n * Get the default charset for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction charset (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n  var mime = match && db[match[1].toLowerCase()]\n\n  if (mime && mime.charset) {\n    return mime.charset\n  }\n\n  // default text/* to utf-8\n  if (match && TEXT_TYPE_REGEXP.test(match[1])) {\n    return 'UTF-8'\n  }\n\n  return false\n}\n\n/**\n * Create a full Content-Type header given a MIME type or extension.\n *\n * @param {string} str\n * @return {boolean|string}\n */\n\nfunction contentType (str) {\n  // TODO: should this even be in this module?\n  if (!str || typeof str !== 'string') {\n    return false\n  }\n\n  var mime = str.indexOf('/') === -1\n    ? exports.lookup(str)\n    : str\n\n  if (!mime) {\n    return false\n  }\n\n  // TODO: use content-type or other module\n  if (mime.indexOf('charset') === -1) {\n    var charset = exports.charset(mime)\n    if (charset) mime += '; charset=' + charset.toLowerCase()\n  }\n\n  return mime\n}\n\n/**\n * Get the default extension for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction extension (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n\n  // get extensions\n  var exts = match && exports.extensions[match[1].toLowerCase()]\n\n  if (!exts || !exts.length) {\n    return false\n  }\n\n  return exts[0]\n}\n\n/**\n * Lookup the MIME type for a file path/extension.\n *\n * @param {string} path\n * @return {boolean|string}\n */\n\nfunction lookup (path) {\n  if (!path || typeof path !== 'string') {\n    return false\n  }\n\n  // get the extension (\"ext\" or \".ext\" or full path)\n  var extension = extname('x.' + path)\n    .toLowerCase()\n    .substr(1)\n\n  if (!extension) {\n    return false\n  }\n\n  return exports.types[extension] || false\n}\n\n/**\n * Populate the extensions and types maps.\n * @private\n */\n\nfunction populateMaps (extensions, types) {\n  // source preference (least -> most)\n  var preference = ['nginx', 'apache', undefined, 'iana']\n\n  Object.keys(db).forEach(function forEachMimeType (type) {\n    var mime = db[type]\n    var exts = mime.extensions\n\n    if (!exts || !exts.length) {\n      return\n    }\n\n    // mime -> extensions\n    extensions[type] = exts\n\n    // extension -> mime\n    for (var i = 0; i < exts.length; i++) {\n      var extension = exts[i]\n\n      if (types[extension]) {\n        var from = preference.indexOf(db[types[extension]].source)\n        var to = preference.indexOf(mime.source)\n\n        if (types[extension] !== 'application/octet-stream' &&\n          (from > to || (from === to && types[extension].substr(0, 12) === 'application/'))) {\n          // skip the remapping\n          continue\n        }\n      }\n\n      // set the extension -> mime\n      types[extension] = type\n    }\n  })\n}\n","import { ipcMain, BrowserWindow, dialog, nativeImage, clipboard, app } from \"electron\"\r\nimport fse from \"fs-extra\"\r\nimport path from \"node:path\"\r\nimport { configDir, scriptsDir } from \"../constant\"\r\nimport { CancelError, download } from \"electron-dl\"\r\nimport { ModelGroupSetting } from \"../../../types/model\"\r\nimport { refreshConfig } from \"../deeplink\"\r\nimport { getInstallHostDependenciesLog } from \"../service\"\r\nimport { CLIENT_ID } from \"../oap\"\r\nimport which from \"which\"\r\nimport mimeTypes from \"mime-types\"\r\n\r\nexport function ipcUtilHandler(win: BrowserWindow) {\r\n  ipcMain.handle(\"util:fillPathToConfig\", async (_, _config: string) => {\r\n    try {\r\n      const { mcpServers: servers } = JSON.parse(_config) as {mcpServers: Record<string, {enabled: boolean, command?: string, args?: string[]}>}\r\n      const mcpServers = Object.keys(servers).reduce((acc, server) => {\r\n        const { args } = servers[server]\r\n\r\n        if (!args)\r\n          return acc\r\n\r\n        const pathToScript = args.find((arg) => arg.endsWith(\"js\") || arg.endsWith(\"ts\"))\r\n        if (!pathToScript)\r\n          return acc\r\n\r\n        const isScriptsExist = fse.existsSync(pathToScript)\r\n        if (isScriptsExist)\r\n          return acc\r\n\r\n        const argsIndex = args.reduce((acc, arg, index) => pathToScript === arg ? index : acc, -1)\r\n        if (fse.existsSync(path.join(scriptsDir, pathToScript))) {\r\n          args[argsIndex] = path.join(scriptsDir, pathToScript)\r\n        }\r\n\r\n        const filename = path.parse(pathToScript).base\r\n        if (fse.existsSync(path.join(scriptsDir, filename))) {\r\n          args[argsIndex] = path.join(scriptsDir, filename)\r\n        }\r\n\r\n        acc[server] = {\r\n          ...servers[server],\r\n          args,\r\n        }\r\n\r\n        return acc\r\n      }, servers)\r\n\r\n      return JSON.stringify({ mcpServers })\r\n    } catch (_error) {\r\n      return _config\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"util:download\", async (event, { url }) => {\r\n    let filename = getFilenameFromUrl(url)\r\n    await fetch(url, { method: \"HEAD\" })\r\n      .then(response => {\r\n        const contentDisposition = response.headers.get(\"content-disposition\")\r\n        if (contentDisposition) {\r\n          const filenameMatch = contentDisposition.match(/filename=\"([^\"]+)\"/)\r\n          if (filenameMatch) {\r\n            filename = filenameMatch[1]\r\n          }\r\n        }\r\n      })\r\n      .catch(() => {\r\n        console.error(\"Failed to get filename from url\")\r\n      })\r\n\r\n    filename = filename || \"file\"\r\n    const result = await dialog.showSaveDialog({\r\n      properties: [\"createDirectory\", \"showOverwriteConfirmation\"],\r\n      defaultPath: filename,\r\n    })\r\n\r\n    if (result.canceled) {\r\n      return\r\n    }\r\n\r\n    try {\r\n      await download(win, url, { directory: path.dirname(result.filePath), filename: path.basename(result.filePath) })\r\n    } catch (error) {\r\n      if (error instanceof CancelError) {\r\n        console.info(\"item.cancel() was called\")\r\n      } else {\r\n        console.error(error)\r\n      }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"util:copyimage\", async (_, src: string|Uint8Array) => {\r\n    const getImageFromRemote = async (url: string) => {\r\n      const response = await fetch(url)\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error: ${response.status}`)\r\n      }\r\n\r\n      const buffer = await response.arrayBuffer()\r\n      const image = nativeImage.createFromBuffer(Buffer.from(buffer))\r\n      if (image.isEmpty()) {\r\n        throw new Error(\"Failed to create image from buffer\")\r\n      }\r\n\r\n      return image\r\n    }\r\n\r\n    const localProtocol = \"local-file:///\"\r\n    let image = null\r\n    if (typeof src === \"string\") {\r\n      image = src.startsWith(localProtocol)\r\n        ? nativeImage.createFromPath(src.substring(localProtocol.length))\r\n        : await getImageFromRemote(src)\r\n    } else {\r\n      image = nativeImage.createFromBuffer(Buffer.from(src))\r\n    }\r\n\r\n    if (image.isEmpty()) {\r\n      throw new Error(\"Failed to create image from buffer\")\r\n    }\r\n\r\n    clipboard.writeImage(image)\r\n  })\r\n\r\n  ipcMain.handle(\"util:getModelSettings\", async (_) => {\r\n    if (!fse.existsSync(path.join(configDir, \"model_settings.json\"))) {\r\n      return null\r\n    }\r\n\r\n    return fse.readJson(path.join(configDir, \"model_settings.json\"))\r\n  })\r\n\r\n  ipcMain.handle(\"util:setModelSettings\", async (_, settings: ModelGroupSetting) => {\r\n    return fse.writeJson(path.join(configDir, \"model_settings.json\"), settings, { spaces: 2 })\r\n  })\r\n\r\n  ipcMain.handle(\"util:refreshConfig\", async () => {\r\n    return refreshConfig()\r\n  })\r\n\r\n  ipcMain.handle(\"util:getInstallHostDependenciesLog\", async () => {\r\n    return getInstallHostDependenciesLog()\r\n  })\r\n\r\n  ipcMain.handle(\"util:getClientInfo\", async () => {\r\n    return {\r\n      version: app.getVersion(),\r\n      client_id: CLIENT_ID,\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"util:checkCommandExist\", async (_, command: string) => {\r\n    return !!which.sync(command, { nothrow: true })\r\n  })\r\n\r\n  ipcMain.handle(\"util:readLocalFile\", async (_, filePath: string) => {\r\n    try {\r\n      const buffer = await fse.readFile(filePath)\r\n      return {\r\n        data: buffer,\r\n        name: path.basename(filePath),\r\n        mimeType: mimeTypes.lookup(filePath) || \"application/octet-stream\",\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to read local file:\", filePath, error)\r\n      throw error\r\n    }\r\n  })\r\n}\r\n\r\nfunction getFilenameFromUrl(url: string) {\r\n  try {\r\n    const _url = new URL(url)\r\n    return _url.pathname.split(\"/\").pop()\r\n  } catch (_error) {\r\n    return null\r\n  }\r\n}\r\n","import { Anthropic } from \"@anthropic-ai/sdk\"\r\nimport { ipcMain, BrowserWindow } from \"electron\"\r\nimport { Ollama } from \"ollama\"\r\nimport OpenAI, { AzureOpenAI } from \"openai\"\r\nimport { Mistral } from \"@mistralai/mistralai\"\r\nimport {\r\n  BedrockClient,\r\n  ListFoundationModelsCommand,\r\n} from \"@aws-sdk/client-bedrock\"\r\n\r\nexport function ipcLlmHandler(_win: BrowserWindow) {\r\n  ipcMain.handle(\"llm:openaiModelList\", async (_, apiKey: string) => {\r\n    try {\r\n      const client = new OpenAI({ apiKey })\r\n      const models = await client.models.list()\r\n      return {\r\n        results: models.data\r\n          .sort((a, b) => b.created - a.created)\r\n          .map((model) => model.id),\r\n        error: null,\r\n      }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"llm:azureOpenaiModelList\", async (_, apiKey: string, azureEndpoint: string, azureDeployment: string, apiVersion: string) => {\r\n    try {\r\n      const client = new AzureOpenAI({ apiKey, endpoint: azureEndpoint, deployment: azureDeployment, apiVersion })\r\n      const models = await client.models.list()\r\n      return {\r\n        results: models.data\r\n          .sort((a, b) => b.created - a.created)\r\n          .map((model) => model.id),\r\n        error: null,\r\n      }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"llm:anthropicModelList\", async (_, apiKey: string, baseURL: string) => {\r\n    try {\r\n      const client = new Anthropic({ apiKey, baseURL })\r\n      const models = await client.models.list()\r\n      return {\r\n        results: models.data\r\n          .sort((a, b) => {\r\n            const aDate = new Date(a.created_at)\r\n            const bDate = new Date(b.created_at)\r\n            return bDate.getTime() - aDate.getTime()\r\n          })\r\n          .map((model: any) => model.id),\r\n        error: null\r\n      }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"llm:ollamaModelList\", async (_, baseURL: string) => {\r\n    try {\r\n      const ollama = new Ollama({ host: baseURL })\r\n      const list = await ollama.list()\r\n      return {\r\n        results: list.models\r\n          .sort((a, b) => {\r\n            const aDate = new Date(a.modified_at)\r\n            const bDate = new Date(b.modified_at)\r\n            return bDate.getTime() - aDate.getTime()\r\n          })\r\n          .map((model) => model.name), error: null }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"llm:openaiCompatibleModelList\", async (_, apiKey: string, baseURL: string) => {\r\n    try {\r\n      const client = new OpenAI({ apiKey, baseURL })\r\n      const list = await client.models.list()\r\n      return {\r\n        results: list.data\r\n          .sort((a, b) => b.created - a.created)\r\n          .map((model) => model.id),\r\n        error: null,\r\n      }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"llm:googleGenaiModelList\", async (_, apiKey: string) => {\r\n    try {\r\n      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`\r\n      const response = await fetch(url)\r\n      const data = await response.json() as { models: { name: string }[] }\r\n      return { results: data.models.map((model) => model.name), error: null }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"llm:mistralaiModelList\", async (_, apiKey: string) => {\r\n    try {\r\n      const client = new Mistral({ apiKey })\r\n      const models = await client.models.list()\r\n      return {\r\n        results: models.data\r\n          ?.sort((a, b) => (b.created || 0) - (a.created || 0))\r\n          .map((model) => model.id),\r\n        error: null,\r\n      }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n\r\n  ipcMain.handle(\"llm:bedrockModelList\", async (_, accessKeyId: string, secretAccessKey: string, sessionToken: string, region: string) => {\r\n    try {\r\n      let modelPrefix = \"\"\r\n      if (region.startsWith(\"us-\")) {\r\n        modelPrefix = \"us.\"\r\n      } else if (region.startsWith(\"eu-\")) {\r\n        modelPrefix = \"eu.\"\r\n      } else if (region.startsWith(\"ap-\")) {\r\n        modelPrefix = \"apac.\"\r\n      } else if (region.includes(\"-\")) {\r\n        modelPrefix = region.split(\"-\")[0] + \".\"\r\n      }\r\n\r\n      const client = new BedrockClient({\r\n        region,\r\n        credentials: {\r\n          accessKeyId,\r\n          secretAccessKey,\r\n          sessionToken,\r\n        }\r\n      })\r\n      const command = new ListFoundationModelsCommand({})\r\n      const response = await client.send(command)\r\n      const models = response.modelSummaries\r\n      return { results: models?.map((model: any) => `${modelPrefix}${model.modelId}`) ?? [], error: null }\r\n    } catch (error) {\r\n      return { results: [], error: (error as Error).message }\r\n    }\r\n  })\r\n}\r\n","import { ipcMain, BrowserWindow, Menu } from \"electron\"\r\n\r\nconst selectionMenu = Menu.buildFromTemplate([\r\n  { role: \"copy\" },\r\n  { role: \"selectAll\" }\r\n])\r\n\r\nconst inputMenu = Menu.buildFromTemplate([\r\n  { role: \"copy\" },\r\n  { role: \"paste\" },\r\n  { role: \"cut\" },\r\n  { role: \"selectAll\" }\r\n])\r\n\r\nexport function ipcMenuHandler(_win: BrowserWindow) {\r\n  ipcMain.handle(\"show-selection-context-menu\", () => {\r\n    selectionMenu.popup()\r\n  })\r\n\r\n  ipcMain.handle(\"show-input-context-menu\", () => {\r\n    inputMenu.popup()\r\n  })\r\n}","import { BrowserWindow, ipcMain, shell } from \"electron\"\r\nimport { getToken, oapClient } from \"../oap\"\r\nimport os from \"node:os\"\r\nimport { OAP_ROOT_URL } from \"../../../shared/oap\"\r\n\r\nimport type { OAPModelDescriptionParam, MCPServerSearchParam, OAPLimiterCheckParam } from \"../../../types/oap\"\r\n\r\nconst LOGIN_URL = `${OAP_ROOT_URL}/signin`\r\nconst REGISTER_URL = `${OAP_ROOT_URL}/signup`\r\n\r\nexport function ipcOapHandler(_win: BrowserWindow) {\r\n  ipcMain.handle(\"oap:login\", async (_, regist: boolean) => {\r\n    const url = `${regist ? REGISTER_URL : LOGIN_URL}?client=dive&name=${os.hostname()}&system=${process.platform}`\r\n    shell.openExternal(url)\r\n  })\r\n\r\n  ipcMain.handle(\"oap:logout\", async () => {\r\n    oapClient.logout()\r\n  })\r\n\r\n  ipcMain.handle(\"oap:getToken\", async () => {\r\n    return await getToken()\r\n  })\r\n\r\n  ipcMain.handle(\"oap:searchMCPServer\", async (_, params: MCPServerSearchParam) => {\r\n    return await oapClient.searchMCPServer(params)\r\n  })\r\n\r\n  ipcMain.handle(\"oap:modelDescription\", async (_, params?: OAPModelDescriptionParam) => {\r\n    return await oapClient.modelDescription(params)\r\n  })\r\n\r\n  ipcMain.handle(\"oap:applyMCPServer\", async (_, ids: string[]) => {\r\n    return await oapClient.applyMCPServer(ids)\r\n  })\r\n\r\n  ipcMain.handle(\"oap:getMCPTags\", async () => {\r\n    return await oapClient.getMCPTags()\r\n  })\r\n\r\n  ipcMain.handle(\"oap:getMCPServers\", async () => {\r\n    return await oapClient.getMCPServers()\r\n  })\r\n\r\n  ipcMain.handle(\"oap:getMe\", async () => {\r\n    return await oapClient.getMe()\r\n  })\r\n\r\n  ipcMain.handle(\"oap:getUsage\", async () => {\r\n    return await oapClient.getUsage()\r\n  })\r\n\r\n  ipcMain.handle(\"oap:limiterCheck\", async (_, params: OAPLimiterCheckParam) => {\r\n    return await oapClient.limiterCheck(params)\r\n  })\r\n}\r\n","import { BrowserWindow, ipcMain } from \"electron\"\r\n// import core from \"core-js\"\r\n\r\nexport function ipcLocalIPCHandler(_win: BrowserWindow) {\r\n  ipcMain.handle(\"lipc:elicitation\", async (_, _action: number, _content: any) => {\r\n    // core.responseElicitation(action, content)\r\n  })\r\n}\r\n\r\n","import { BrowserWindow } from \"electron\"\r\nimport { ipcEnvHandler } from \"./env\"\r\nimport { ipcSystemHandler } from \"./system\"\r\nimport { ipcUtilHandler } from \"./util\"\r\nimport { ipcLlmHandler } from \"./llm\"\r\nimport { ipcMenuHandler } from \"./menu\"\r\nimport { ipcOapHandler } from \"./oap\"\r\nimport { ipcLocalIPCHandler } from \"./lipc\"\r\n\r\nexport function ipcHandler(win: BrowserWindow) {\r\n  ipcEnvHandler(win)\r\n  ipcSystemHandler(win)\r\n  ipcUtilHandler(win)\r\n  ipcLlmHandler(win)\r\n  ipcMenuHandler(win)\r\n  ipcOapHandler(win)\r\n  ipcLocalIPCHandler(win)\r\n}\r\n","import { net, protocol } from \"electron\"\r\nimport path from \"node:path\"\r\n\r\nprotocol.registerSchemesAsPrivileged([\r\n  {\r\n    scheme: \"local-file\",\r\n    privileges: {\r\n      secure: true,\r\n      supportFetchAPI: true,\r\n      bypassCSP: true,\r\n      stream: true,\r\n    }\r\n  }\r\n])\r\n\r\nprotocol.registerSchemesAsPrivileged([\r\n  {\r\n    scheme: \"img\",\r\n    privileges: {\r\n      secure: true,\r\n      supportFetchAPI: true,\r\n      bypassCSP: true,\r\n      stream: true,\r\n    }\r\n  }\r\n])\r\n\r\nexport function initProtocol() {\r\n  protocol.handle(\"local-file\", (req) => {\r\n    const url = req.url.replace(\"local-file:///\", process.platform === \"win32\" ? \"file:///\" : \"file://\")\r\n    return net.fetch(url)\r\n  })\r\n\r\n  protocol.handle(\"img\", (req) => {\r\n    // Remove 'img://'\r\n    const url = req.url.substring(6)\r\n    const assetPath = path.join(process.env.VITE_PUBLIC, \"image\", url)\r\n    return net.fetch(`file://${assetPath}`)\r\n  })\r\n}","'use strict';\n\nconst fs = require('fs');\nconst path = require('path');\n\nmodule.exports = {\n  findAndReadPackageJson,\n  tryReadJsonAt,\n};\n\n/**\n * @return {{ name?: string, version?: string}}\n */\nfunction findAndReadPackageJson() {\n  return tryReadJsonAt(getMainModulePath())\n    || tryReadJsonAt(extractPathFromArgs())\n    || tryReadJsonAt(process.resourcesPath, 'app.asar')\n    || tryReadJsonAt(process.resourcesPath, 'app')\n    || tryReadJsonAt(process.cwd())\n    || { name: undefined, version: undefined };\n}\n\n/**\n * @param {...string} searchPaths\n * @return {{ name?: string, version?: string } | undefined}\n */\nfunction tryReadJsonAt(...searchPaths) {\n  if (!searchPaths[0]) {\n    return undefined;\n  }\n\n  try {\n    const searchPath = path.join(...searchPaths);\n    const fileName = findUp('package.json', searchPath);\n    if (!fileName) {\n      return undefined;\n    }\n\n    const json = JSON.parse(fs.readFileSync(fileName, 'utf8'));\n    const name = json?.productName || json?.name;\n    if (!name || name.toLowerCase() === 'electron') {\n      return undefined;\n    }\n\n    if (name) {\n      return { name, version: json?.version };\n    }\n\n    return undefined;\n  } catch (e) {\n    return undefined;\n  }\n}\n\n/**\n * @param {string} fileName\n * @param {string} [cwd]\n * @return {string | null}\n */\nfunction findUp(fileName, cwd) {\n  let currentPath = cwd;\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    const parsedPath = path.parse(currentPath);\n    const root = parsedPath.root;\n    const dir = parsedPath.dir;\n\n    if (fs.existsSync(path.join(currentPath, fileName))) {\n      return path.resolve(path.join(currentPath, fileName));\n    }\n\n    if (currentPath === root) {\n      return null;\n    }\n\n    currentPath = dir;\n  }\n}\n\n/**\n * Get app path from --user-data-dir cmd arg, passed to a renderer process\n * @return {string|null}\n */\nfunction extractPathFromArgs() {\n  const matchedArgs = process.argv.filter((arg) => {\n    return arg.indexOf('--user-data-dir=') === 0;\n  });\n\n  if (matchedArgs.length === 0 || typeof matchedArgs[0] !== 'string') {\n    return null;\n  }\n\n  const userDataDir = matchedArgs[0];\n  return userDataDir.replace('--user-data-dir=', '');\n}\n\nfunction getMainModulePath() {\n  try {\n    // Requires isn't available in ESM\n    return require.main?.filename;\n  } catch {\n    return undefined;\n  }\n}\n","'use strict';\n\n/* eslint-disable no-unused-vars */\n\nconst childProcess = require('child_process');\nconst os = require('os');\nconst path = require('path');\nconst packageJson = require('./packageJson');\n\nclass NodeExternalApi {\n  appName = undefined;\n  appPackageJson = undefined;\n  platform = process.platform;\n\n  getAppLogPath(appName = this.getAppName()) {\n    if (this.platform === 'darwin') {\n      return path.join(this.getSystemPathHome(), 'Library/Logs', appName);\n    }\n\n    return path.join(this.getAppUserDataPath(appName), 'logs');\n  }\n\n  getAppName() {\n    const appName = this.appName || this.getAppPackageJson()?.name;\n    if (!appName) {\n      throw new Error(\n        'electron-log can\\'t determine the app name. It tried these methods:\\n'\n        + '1. Use `electron.app.name`\\n'\n        + '2. Use productName or name from the nearest package.json`\\n'\n        + 'You can also set it through log.transports.file.setAppName()',\n      );\n    }\n\n    return appName;\n  }\n\n  /**\n   * @private\n   * @returns {undefined}\n   */\n  getAppPackageJson() {\n    if (typeof this.appPackageJson !== 'object') {\n      this.appPackageJson = packageJson.findAndReadPackageJson();\n    }\n\n    return this.appPackageJson;\n  }\n\n  getAppUserDataPath(appName = this.getAppName()) {\n    return appName\n      ? path.join(this.getSystemPathAppData(), appName)\n      : undefined;\n  }\n\n  getAppVersion() {\n    return this.getAppPackageJson()?.version;\n  }\n\n  getElectronLogPath() {\n    return this.getAppLogPath();\n  }\n\n  getMacOsVersion() {\n    const release = Number(os.release().split('.')[0]);\n    if (release <= 19) {\n      return `10.${release - 4}`;\n    }\n\n    return release - 9;\n  }\n\n  /**\n   * @protected\n   * @returns {string}\n   */\n  getOsVersion() {\n    let osName = os.type().replace('_', ' ');\n    let osVersion = os.release();\n\n    if (osName === 'Darwin') {\n      osName = 'macOS';\n      osVersion = this.getMacOsVersion();\n    }\n\n    return `${osName} ${osVersion}`;\n  }\n\n  /**\n   * @return {PathVariables}\n   */\n  getPathVariables() {\n    const appName = this.getAppName();\n    const appVersion = this.getAppVersion();\n\n    const self = this;\n\n    return {\n      appData: this.getSystemPathAppData(),\n      appName,\n      appVersion,\n      get electronDefaultDir() {\n        return self.getElectronLogPath();\n      },\n      home: this.getSystemPathHome(),\n      libraryDefaultDir: this.getAppLogPath(appName),\n      libraryTemplate: this.getAppLogPath('{appName}'),\n      temp: this.getSystemPathTemp(),\n      userData: this.getAppUserDataPath(appName),\n    };\n  }\n\n  getSystemPathAppData() {\n    const home = this.getSystemPathHome();\n\n    switch (this.platform) {\n      case 'darwin': {\n        return path.join(home, 'Library/Application Support');\n      }\n\n      case 'win32': {\n        return process.env.APPDATA || path.join(home, 'AppData/Roaming');\n      }\n\n      default: {\n        return process.env.XDG_CONFIG_HOME || path.join(home, '.config');\n      }\n    }\n  }\n\n  getSystemPathHome() {\n    return os.homedir?.() || process.env.HOME;\n  }\n\n  getSystemPathTemp() {\n    return os.tmpdir();\n  }\n\n  getVersions() {\n    return {\n      app: `${this.getAppName()} ${this.getAppVersion()}`,\n      electron: undefined,\n      os: this.getOsVersion(),\n    };\n  }\n\n  isDev() {\n    return process.env.NODE_ENV === 'development'\n      || process.env.ELECTRON_IS_DEV === '1';\n  }\n\n  isElectron() {\n    return Boolean(process.versions.electron);\n  }\n\n  onAppEvent(_eventName, _handler) {\n    // Ignored in node.js\n  }\n\n  onAppReady(handler) {\n    handler();\n  }\n\n  onEveryWebContentsEvent(eventName, handler) {\n    // Ignored in node.js\n  }\n\n  /**\n   * Listen to async messages sent from opposite process\n   * @param {string} channel\n   * @param {function} listener\n   */\n  onIpc(channel, listener) {\n    // Ignored in node.js\n  }\n\n  onIpcInvoke(channel, listener) {\n    // Ignored in node.js\n  }\n\n  /**\n   * @param {string} url\n   * @param {Function} [logFunction]\n   */\n  openUrl(url, logFunction = console.error) { // eslint-disable-line no-console\n    const startMap = { darwin: 'open', win32: 'start', linux: 'xdg-open' };\n    const start = startMap[process.platform] || 'xdg-open';\n    childProcess.exec(`${start} ${url}`, {}, (err) => {\n      if (err) {\n        logFunction(err);\n      }\n    });\n  }\n\n  setAppName(appName) {\n    this.appName = appName;\n  }\n\n  setPlatform(platform) {\n    this.platform = platform;\n  }\n\n  setPreloadFileForSessions({\n    filePath, // eslint-disable-line no-unused-vars\n    includeFutureSession = true, // eslint-disable-line no-unused-vars\n    getSessions = () => [], // eslint-disable-line no-unused-vars\n  }) {\n    // Ignored in node.js\n  }\n\n  /**\n   * Sent a message to opposite process\n   * @param {string} channel\n   * @param {any} message\n   */\n  sendIpc(channel, message) {\n    // Ignored in node.js\n  }\n\n  showErrorBox(title, message) {\n    // Ignored in node.js\n  }\n}\n\nmodule.exports = NodeExternalApi;\n","'use strict';\n\nconst path = require('path');\nconst NodeExternalApi = require('../node/NodeExternalApi');\n\nclass ElectronExternalApi extends NodeExternalApi {\n  /**\n   * @type {typeof Electron}\n   */\n  electron = undefined;\n\n  /**\n   * @param {object} options\n   * @param {typeof Electron} [options.electron]\n   */\n  constructor({ electron } = {}) {\n    super();\n    this.electron = electron;\n  }\n\n  getAppName() {\n    let appName;\n    try {\n      appName = this.appName\n        || this.electron.app?.name\n        || this.electron.app?.getName();\n    } catch {\n      // fallback to default value below\n    }\n    return appName || super.getAppName();\n  }\n\n  getAppUserDataPath(appName) {\n    return this.getPath('userData') || super.getAppUserDataPath(appName);\n  }\n\n  getAppVersion() {\n    let appVersion;\n    try {\n      appVersion = this.electron.app?.getVersion();\n    } catch {\n      // fallback to default value below\n    }\n    return appVersion || super.getAppVersion();\n  }\n\n  getElectronLogPath() {\n    return this.getPath('logs') || super.getElectronLogPath();\n  }\n\n  /**\n   * @private\n   * @param {any} name\n   * @returns {string|undefined}\n   */\n  getPath(name) {\n    try {\n      return this.electron.app?.getPath(name);\n    } catch {\n      return undefined;\n    }\n  }\n\n  getVersions() {\n    return {\n      app: `${this.getAppName()} ${this.getAppVersion()}`,\n      electron: `Electron ${process.versions.electron}`,\n      os: this.getOsVersion(),\n    };\n  }\n\n  getSystemPathAppData() {\n    return this.getPath('appData') || super.getSystemPathAppData();\n  }\n\n  isDev() {\n    if (this.electron.app?.isPackaged !== undefined) {\n      return !this.electron.app.isPackaged;\n    }\n\n    if (typeof process.execPath === 'string') {\n      const execFileName = path.basename(process.execPath).toLowerCase();\n      return execFileName.startsWith('electron');\n    }\n\n    return super.isDev();\n  }\n\n  onAppEvent(eventName, handler) {\n    this.electron.app?.on(eventName, handler);\n\n    return () => {\n      this.electron.app?.off(eventName, handler);\n    };\n  }\n\n  onAppReady(handler) {\n    if (this.electron.app?.isReady()) {\n      handler();\n    } else if (this.electron.app?.once) {\n      this.electron.app?.once('ready', handler);\n    } else {\n      handler();\n    }\n  }\n\n  onEveryWebContentsEvent(eventName, handler) {\n    this.electron.webContents?.getAllWebContents()?.forEach((webContents) => {\n      webContents.on(eventName, handler);\n    });\n\n    this.electron.app?.on('web-contents-created', onWebContentsCreated);\n\n    return () => {\n      this.electron.webContents?.getAllWebContents().forEach((webContents) => {\n        webContents.off(eventName, handler);\n      });\n\n      this.electron.app?.off('web-contents-created', onWebContentsCreated);\n    };\n\n    function onWebContentsCreated(_, webContents) {\n      webContents.on(eventName, handler);\n    }\n  }\n\n  /**\n   * Listen to async messages sent from opposite process\n   * @param {string} channel\n   * @param {function} listener\n   */\n  onIpc(channel, listener) {\n    this.electron.ipcMain?.on(channel, listener);\n  }\n\n  onIpcInvoke(channel, listener) {\n    this.electron.ipcMain?.handle?.(channel, listener);\n  }\n\n  /**\n   * @param {string} url\n   * @param {Function} [logFunction]\n   */\n  openUrl(url, logFunction = console.error) { // eslint-disable-line no-console\n    this.electron.shell?.openExternal(url).catch(logFunction);\n  }\n\n  setPreloadFileForSessions({\n    filePath,\n    includeFutureSession = true,\n    getSessions = () => [this.electron.session?.defaultSession],\n  }) {\n    for (const session of getSessions().filter(Boolean)) {\n      setPreload(session);\n    }\n\n    if (includeFutureSession) {\n      this.onAppEvent('session-created', (session) => {\n        setPreload(session);\n      });\n    }\n\n    /**\n     * @param {Session} session\n     */\n    function setPreload(session) {\n      if (typeof session.registerPreloadScript === 'function') {\n        session.registerPreloadScript({\n          filePath,\n          id: 'electron-log-preload',\n          type: 'frame',\n        });\n      } else {\n        session.setPreloads([...session.getPreloads(), filePath]);\n      }\n    }\n  }\n\n  /**\n   * Sent a message to opposite process\n   * @param {string} channel\n   * @param {any} message\n   */\n  sendIpc(channel, message) {\n    this.electron.BrowserWindow?.getAllWindows()?.forEach((wnd) => {\n      if (\n        wnd.webContents?.isDestroyed() === false\n        && wnd.webContents?.isCrashed() === false\n      ) {\n        wnd.webContents.send(channel, message);\n      }\n    });\n  }\n\n  showErrorBox(title, message) {\n    this.electron.dialog?.showErrorBox(title, message);\n  }\n}\n\nmodule.exports = ElectronExternalApi;\n","'use strict';\n\nlet electron = {};\n\ntry {\n  // eslint-disable-next-line global-require,import/no-extraneous-dependencies\n  electron = require('electron');\n} catch (e) {\n  // require isn't available, not from a preload script\n}\n\nif (electron.ipcRenderer) {\n  initialize(electron);\n}\n\nif (typeof module === 'object') {\n  module.exports = initialize;\n}\n\n/**\n * @param {Electron.ContextBridge} contextBridge\n * @param {Electron.IpcRenderer} ipcRenderer\n */\nfunction initialize({ contextBridge, ipcRenderer }) {\n  if (!ipcRenderer) {\n    return;\n  }\n\n  ipcRenderer.on('__ELECTRON_LOG_IPC__', (_, message) => {\n    window.postMessage({ cmd: 'message', ...message });\n  });\n\n  ipcRenderer\n    .invoke('__ELECTRON_LOG__', { cmd: 'getOptions' })\n    // eslint-disable-next-line no-console\n    .catch((e) => console.error(new Error(\n      'electron-log isn\\'t initialized in the main process. '\n      + `Please call log.initialize() before. ${e.message}`,\n    )));\n\n  const electronLog = {\n    sendToMain(message) {\n      try {\n        ipcRenderer.send('__ELECTRON_LOG__', message);\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.error('electronLog.sendToMain ', e, 'data:', message);\n\n        ipcRenderer.send('__ELECTRON_LOG__', {\n          cmd: 'errorHandler',\n          error: { message: e?.message, stack: e?.stack },\n          errorName: 'sendToMain',\n        });\n      }\n    },\n\n    log(...data) {\n      electronLog.sendToMain({ data, level: 'info' });\n    },\n  };\n\n  for (const level of ['error', 'warn', 'info', 'verbose', 'debug', 'silly']) {\n    electronLog[level] = (...data) => electronLog.sendToMain({\n      data,\n      level,\n    });\n  }\n\n  if (contextBridge && process.contextIsolated) {\n    try {\n      contextBridge.exposeInMainWorld('__electronLog', electronLog);\n    } catch {\n      // Sometimes this files can be included twice\n    }\n  }\n\n  if (typeof window === 'object') {\n    window.__electronLog = electronLog;\n  } else {\n    // noinspection JSConstantReassignment\n    __electronLog = electronLog;\n  }\n}\n","'use strict';\n\nconst fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst preloadInitializeFn = require('../renderer/electron-log-preload');\n\nlet preloadInitialized = false;\nlet spyConsoleInitialized = false;\n\nmodule.exports = {\n  initialize({\n    externalApi,\n    getSessions,\n    includeFutureSession,\n    logger,\n    preload = true,\n    spyRendererConsole = false,\n  }) {\n    externalApi.onAppReady(() => {\n      try {\n        if (preload) {\n          initializePreload({\n            externalApi,\n            getSessions,\n            includeFutureSession,\n            logger,\n            preloadOption: preload,\n          });\n        }\n\n        if (spyRendererConsole) {\n          initializeSpyRendererConsole({ externalApi, logger });\n        }\n      } catch (err) {\n        logger.warn(err);\n      }\n    });\n  },\n};\n\nfunction initializePreload({\n  externalApi,\n  getSessions,\n  includeFutureSession,\n  logger,\n  preloadOption,\n}) {\n  let preloadPath = typeof preloadOption === 'string'\n    ? preloadOption\n    : undefined;\n\n  if (preloadInitialized) {\n    logger.warn(new Error('log.initialize({ preload }) already called').stack);\n    return;\n  }\n\n  preloadInitialized = true;\n\n  try {\n    preloadPath = path.resolve(\n      __dirname,\n      '../renderer/electron-log-preload.js',\n    );\n  } catch {\n    // Ignore, the file is bundled to ESM\n  }\n\n  if (!preloadPath || !fs.existsSync(preloadPath)) {\n    preloadPath = path.join(\n      externalApi.getAppUserDataPath() || os.tmpdir(),\n      'electron-log-preload.js',\n    );\n    const preloadCode = `\n      try {\n        (${preloadInitializeFn.toString()})(require('electron'));\n      } catch(e) {\n        console.error(e);\n      }\n    `;\n    fs.writeFileSync(preloadPath, preloadCode, 'utf8');\n  }\n\n  externalApi.setPreloadFileForSessions({\n    filePath: preloadPath,\n    includeFutureSession,\n    getSessions,\n  });\n}\n\nfunction initializeSpyRendererConsole({ externalApi, logger }) {\n  if (spyConsoleInitialized) {\n    logger.warn(\n      new Error('log.initialize({ spyRendererConsole }) already called').stack,\n    );\n    return;\n  }\n\n  spyConsoleInitialized = true;\n\n  const levels = ['debug', 'info', 'warn', 'error'];\n  externalApi.onEveryWebContentsEvent(\n    'console-message',\n    (event, level, message) => {\n      logger.processMessage({\n        data: [message],\n        level: levels[level],\n        variables: { processType: 'renderer' },\n      });\n    },\n  );\n}\n","'use strict';\n\nmodule.exports = scopeFactory;\n\nfunction scopeFactory(logger) {\n  return Object.defineProperties(scope, {\n    defaultLabel: { value: '', writable: true },\n    labelPadding: { value: true, writable: true },\n    maxLabelLength: { value: 0, writable: true },\n    labelLength: {\n      get() {\n        switch (typeof scope.labelPadding) {\n          case 'boolean': return scope.labelPadding ? scope.maxLabelLength : 0;\n          case 'number': return scope.labelPadding;\n          default: return 0;\n        }\n      },\n    },\n  });\n\n  function scope(label) {\n    scope.maxLabelLength = Math.max(scope.maxLabelLength, label.length);\n\n    const newScope = {};\n    for (const level of logger.levels) {\n      newScope[level] = (...d) => logger.logData(d, { level, scope: label });\n    }\n    newScope.log = newScope.info;\n    return newScope;\n  }\n}\n","'use strict';\n\nclass Buffering {\n  constructor({ processMessage }) {\n    this.processMessage = processMessage;\n    this.buffer = [];\n    this.enabled = false;\n\n    this.begin = this.begin.bind(this);\n    this.commit = this.commit.bind(this);\n    this.reject = this.reject.bind(this);\n  }\n\n  addMessage(message) {\n    this.buffer.push(message);\n  }\n\n  begin() {\n    this.enabled = [];\n  }\n\n  commit() {\n    this.enabled = false;\n    this.buffer.forEach((item) => this.processMessage(item));\n    this.buffer = [];\n  }\n\n  reject() {\n    this.enabled = false;\n    this.buffer = [];\n  }\n}\n\nmodule.exports = Buffering;\n","'use strict';\n\nconst scopeFactory = require('./scope');\nconst Buffering = require('./Buffering');\n\n/**\n * @property {Function} error\n * @property {Function} warn\n * @property {Function} info\n * @property {Function} verbose\n * @property {Function} debug\n * @property {Function} silly\n */\nclass Logger {\n  static instances = {};\n\n  dependencies = {};\n  errorHandler = null;\n  eventLogger = null;\n  functions = {};\n  hooks = [];\n  isDev = false;\n  levels = null;\n  logId = null;\n  scope = null;\n  transports = {};\n  variables = {};\n\n  constructor({\n    allowUnknownLevel = false,\n    dependencies = {},\n    errorHandler,\n    eventLogger,\n    initializeFn,\n    isDev = false,\n    levels = ['error', 'warn', 'info', 'verbose', 'debug', 'silly'],\n    logId,\n    transportFactories = {},\n    variables,\n  } = {}) {\n    this.addLevel = this.addLevel.bind(this);\n    this.create = this.create.bind(this);\n    this.initialize = this.initialize.bind(this);\n    this.logData = this.logData.bind(this);\n    this.processMessage = this.processMessage.bind(this);\n\n    this.allowUnknownLevel = allowUnknownLevel;\n    this.buffering = new Buffering(this);\n    this.dependencies = dependencies;\n    this.initializeFn = initializeFn;\n    this.isDev = isDev;\n    this.levels = levels;\n    this.logId = logId;\n    this.scope = scopeFactory(this);\n    this.transportFactories = transportFactories;\n    this.variables = variables || {};\n\n    for (const name of this.levels) {\n      this.addLevel(name, false);\n    }\n    this.log = this.info;\n    this.functions.log = this.log;\n\n    this.errorHandler = errorHandler;\n    errorHandler?.setOptions({ ...dependencies, logFn: this.error });\n\n    this.eventLogger = eventLogger;\n    eventLogger?.setOptions({ ...dependencies, logger: this });\n\n    for (const [name, factory] of Object.entries(transportFactories)) {\n      this.transports[name] = factory(this, dependencies);\n    }\n\n    Logger.instances[logId] = this;\n  }\n\n  static getInstance({ logId }) {\n    return this.instances[logId] || this.instances.default;\n  }\n\n  addLevel(level, index = this.levels.length) {\n    if (index !== false) {\n      this.levels.splice(index, 0, level);\n    }\n\n    this[level] = (...args) => this.logData(args, { level });\n    this.functions[level] = this[level];\n  }\n\n  catchErrors(options) {\n    this.processMessage(\n      {\n        data: ['log.catchErrors is deprecated. Use log.errorHandler instead'],\n        level: 'warn',\n      },\n      { transports: ['console'] },\n    );\n    return this.errorHandler.startCatching(options);\n  }\n\n  create(options) {\n    if (typeof options === 'string') {\n      options = { logId: options };\n    }\n\n    return new Logger({\n      dependencies: this.dependencies,\n      errorHandler: this.errorHandler,\n      initializeFn: this.initializeFn,\n      isDev: this.isDev,\n      transportFactories: this.transportFactories,\n      variables: { ...this.variables },\n      ...options,\n    });\n  }\n\n  compareLevels(passLevel, checkLevel, levels = this.levels) {\n    const pass = levels.indexOf(passLevel);\n    const check = levels.indexOf(checkLevel);\n\n    if (check === -1 || pass === -1) {\n      return true;\n    }\n\n    return check <= pass;\n  }\n\n  initialize(options = {}) {\n    this.initializeFn({ logger: this, ...this.dependencies, ...options });\n  }\n\n  logData(data, options = {}) {\n    if (this.buffering.enabled) {\n      this.buffering.addMessage({ data, date: new Date(), ...options });\n    } else {\n      this.processMessage({ data, ...options });\n    }\n  }\n\n  processMessage(message, { transports = this.transports } = {}) {\n    if (message.cmd === 'errorHandler') {\n      this.errorHandler.handle(message.error, {\n        errorName: message.errorName,\n        processType: 'renderer',\n        showDialog: Boolean(message.showDialog),\n      });\n      return;\n    }\n\n    let level = message.level;\n    if (!this.allowUnknownLevel) {\n      level = this.levels.includes(message.level) ? message.level : 'info';\n    }\n\n    const normalizedMessage = {\n      date: new Date(),\n      logId: this.logId,\n      ...message,\n      level,\n      variables: {\n        ...this.variables,\n        ...message.variables,\n      },\n    };\n\n    for (const [transName, transFn] of this.transportEntries(transports)) {\n      if (typeof transFn !== 'function' || transFn.level === false) {\n        continue;\n      }\n\n      if (!this.compareLevels(transFn.level, message.level)) {\n        continue;\n      }\n\n      try {\n        // eslint-disable-next-line arrow-body-style\n        const transformedMsg = this.hooks.reduce((msg, hook) => {\n          return msg ? hook(msg, transFn, transName) : msg;\n        }, normalizedMessage);\n\n        if (transformedMsg) {\n          transFn({ ...transformedMsg, data: [...transformedMsg.data] });\n        }\n      } catch (e) {\n        this.processInternalErrorFn(e);\n      }\n    }\n  }\n\n  processInternalErrorFn(_e) {\n    // Do nothing by default\n  }\n\n  transportEntries(transports = this.transports) {\n    const transportArray = Array.isArray(transports)\n      ? transports\n      : Object.entries(transports);\n\n    return transportArray\n      .map((item) => {\n        switch (typeof item) {\n          case 'string':\n            return this.transports[item] ? [item, this.transports[item]] : null;\n          case 'function':\n            return [item.name, item];\n          default:\n            return Array.isArray(item) ? item : null;\n        }\n      })\n      .filter(Boolean);\n  }\n}\n\nmodule.exports = Logger;\n","'use strict';\n\nclass ErrorHandler {\n  externalApi = undefined;\n  isActive = false;\n  logFn = undefined;\n  onError = undefined;\n  showDialog = true;\n\n  constructor({\n    externalApi,\n    logFn = undefined,\n    onError = undefined,\n    showDialog = undefined,\n  } = {}) {\n    this.createIssue = this.createIssue.bind(this);\n    this.handleError = this.handleError.bind(this);\n    this.handleRejection = this.handleRejection.bind(this);\n    this.setOptions({ externalApi, logFn, onError, showDialog });\n    this.startCatching = this.startCatching.bind(this);\n    this.stopCatching = this.stopCatching.bind(this);\n  }\n\n  handle(error, {\n    logFn = this.logFn,\n    onError = this.onError,\n    processType = 'browser',\n    showDialog = this.showDialog,\n    errorName = '',\n  } = {}) {\n    error = normalizeError(error);\n\n    try {\n      if (typeof onError === 'function') {\n        const versions = this.externalApi?.getVersions() || {};\n        const createIssue = this.createIssue;\n        const result = onError({\n          createIssue,\n          error,\n          errorName,\n          processType,\n          versions,\n        });\n        if (result === false) {\n          return;\n        }\n      }\n\n      errorName ? logFn(errorName, error) : logFn(error);\n\n      if (showDialog && !errorName.includes('rejection') && this.externalApi) {\n        this.externalApi.showErrorBox(\n          `A JavaScript error occurred in the ${processType} process`,\n          error.stack,\n        );\n      }\n    } catch {\n      console.error(error); // eslint-disable-line no-console\n    }\n  }\n\n  setOptions({ externalApi, logFn, onError, showDialog }) {\n    if (typeof externalApi === 'object') {\n      this.externalApi = externalApi;\n    }\n\n    if (typeof logFn === 'function') {\n      this.logFn = logFn;\n    }\n\n    if (typeof onError === 'function') {\n      this.onError = onError;\n    }\n\n    if (typeof showDialog === 'boolean') {\n      this.showDialog = showDialog;\n    }\n  }\n\n  startCatching({ onError, showDialog } = {}) {\n    if (this.isActive) {\n      return;\n    }\n\n    this.isActive = true;\n    this.setOptions({ onError, showDialog });\n    process.on('uncaughtException', this.handleError);\n    process.on('unhandledRejection', this.handleRejection);\n  }\n\n  stopCatching() {\n    this.isActive = false;\n    process.removeListener('uncaughtException', this.handleError);\n    process.removeListener('unhandledRejection', this.handleRejection);\n  }\n\n  createIssue(pageUrl, queryParams) {\n    this.externalApi?.openUrl(\n      `${pageUrl}?${new URLSearchParams(queryParams).toString()}`,\n    );\n  }\n\n  handleError(error) {\n    this.handle(error, { errorName: 'Unhandled' });\n  }\n\n  handleRejection(reason) {\n    const error = reason instanceof Error\n      ? reason\n      : new Error(JSON.stringify(reason));\n    this.handle(error, { errorName: 'Unhandled rejection' });\n  }\n}\n\nfunction normalizeError(e) {\n  if (e instanceof Error) {\n    return e;\n  }\n\n  if (e && typeof e === 'object') {\n    if (e.message) {\n      return Object.assign(new Error(e.message), e);\n    }\n    try {\n      return new Error(JSON.stringify(e));\n    } catch (serErr) {\n      return new Error(`Couldn't normalize error ${String(e)}: ${serErr}`);\n    }\n  }\n\n  return new Error(`Can't normalize error ${String(e)}`);\n}\n\nmodule.exports = ErrorHandler;\n","'use strict';\n\nclass EventLogger {\n  disposers = [];\n  format = '{eventSource}#{eventName}:';\n  formatters = {\n    app: {\n      'certificate-error': ({ args }) => {\n        return this.arrayToObject(args.slice(1, 4), [\n          'url',\n          'error',\n          'certificate',\n        ]);\n      },\n      'child-process-gone': ({ args }) => {\n        return args.length === 1 ? args[0] : args;\n      },\n      'render-process-gone': ({ args: [webContents, details] }) => {\n        return details && typeof details === 'object'\n          ? { ...details, ...this.getWebContentsDetails(webContents) }\n          : [];\n      },\n    },\n\n    webContents: {\n      'console-message': ({ args: [level, message, line, sourceId] }) => {\n        // 0: debug, 1: info, 2: warning, 3: error\n        if (level < 3) {\n          return undefined;\n        }\n\n        return { message, source: `${sourceId}:${line}` };\n      },\n      'did-fail-load': ({ args }) => {\n        return this.arrayToObject(args, [\n          'errorCode',\n          'errorDescription',\n          'validatedURL',\n          'isMainFrame',\n          'frameProcessId',\n          'frameRoutingId',\n        ]);\n      },\n      'did-fail-provisional-load': ({ args }) => {\n        return this.arrayToObject(args, [\n          'errorCode',\n          'errorDescription',\n          'validatedURL',\n          'isMainFrame',\n          'frameProcessId',\n          'frameRoutingId',\n        ]);\n      },\n      'plugin-crashed': ({ args }) => {\n        return this.arrayToObject(args, ['name', 'version']);\n      },\n      'preload-error': ({ args }) => {\n        return this.arrayToObject(args, ['preloadPath', 'error']);\n      },\n    },\n  };\n\n  events = {\n    app: {\n      'certificate-error': true,\n      'child-process-gone': true,\n      'render-process-gone': true,\n    },\n\n    webContents: {\n      // 'console-message': true,\n      'did-fail-load': true,\n      'did-fail-provisional-load': true,\n      'plugin-crashed': true,\n      'preload-error': true,\n      'unresponsive': true,\n    },\n  };\n\n  externalApi = undefined;\n  level = 'error';\n  scope = '';\n\n  constructor(options = {}) {\n    this.setOptions(options);\n  }\n\n  setOptions({\n    events,\n    externalApi,\n    level,\n    logger,\n    format,\n    formatters,\n    scope,\n  }) {\n    if (typeof events === 'object') {\n      this.events = events;\n    }\n\n    if (typeof externalApi === 'object') {\n      this.externalApi = externalApi;\n    }\n\n    if (typeof level === 'string') {\n      this.level = level;\n    }\n\n    if (typeof logger === 'object') {\n      this.logger = logger;\n    }\n\n    if (typeof format === 'string' || typeof format === 'function') {\n      this.format = format;\n    }\n\n    if (typeof formatters === 'object') {\n      this.formatters = formatters;\n    }\n\n    if (typeof scope === 'string') {\n      this.scope = scope;\n    }\n  }\n\n  startLogging(options = {}) {\n    this.setOptions(options);\n\n    this.disposeListeners();\n\n    for (const eventName of this.getEventNames(this.events.app)) {\n      this.disposers.push(\n        this.externalApi.onAppEvent(eventName, (...handlerArgs) => {\n          this.handleEvent({ eventSource: 'app', eventName, handlerArgs });\n        }),\n      );\n    }\n\n    for (const eventName of this.getEventNames(this.events.webContents)) {\n      this.disposers.push(\n        this.externalApi.onEveryWebContentsEvent(\n          eventName,\n          (...handlerArgs) => {\n            this.handleEvent(\n              { eventSource: 'webContents', eventName, handlerArgs },\n            );\n          },\n        ),\n      );\n    }\n  }\n\n  stopLogging() {\n    this.disposeListeners();\n  }\n\n  arrayToObject(array, fieldNames) {\n    const obj = {};\n\n    fieldNames.forEach((fieldName, index) => {\n      obj[fieldName] = array[index];\n    });\n\n    if (array.length > fieldNames.length) {\n      obj.unknownArgs = array.slice(fieldNames.length);\n    }\n\n    return obj;\n  }\n\n  disposeListeners() {\n    this.disposers.forEach((disposer) => disposer());\n    this.disposers = [];\n  }\n\n  formatEventLog({ eventName, eventSource, handlerArgs }) {\n    const [event, ...args] = handlerArgs;\n    if (typeof this.format === 'function') {\n      return this.format({ args, event, eventName, eventSource });\n    }\n\n    const formatter = this.formatters[eventSource]?.[eventName];\n    let formattedArgs = args;\n    if (typeof formatter === 'function') {\n      formattedArgs = formatter({ args, event, eventName, eventSource });\n    }\n\n    if (!formattedArgs) {\n      return undefined;\n    }\n\n    const eventData = {};\n\n    if (Array.isArray(formattedArgs)) {\n      eventData.args = formattedArgs;\n    } else if (typeof formattedArgs === 'object') {\n      Object.assign(eventData, formattedArgs);\n    }\n\n    if (eventSource === 'webContents') {\n      Object.assign(eventData, this.getWebContentsDetails(event?.sender));\n    }\n\n    const title = this.format\n      .replace('{eventSource}', eventSource === 'app' ? 'App' : 'WebContents')\n      .replace('{eventName}', eventName);\n\n    return [title, eventData];\n  }\n\n  getEventNames(eventMap) {\n    if (!eventMap || typeof eventMap !== 'object') {\n      return [];\n    }\n\n    return Object.entries(eventMap)\n      .filter(([_, listen]) => listen)\n      .map(([eventName]) => eventName);\n  }\n\n  getWebContentsDetails(webContents) {\n    if (!webContents?.loadURL) {\n      return {};\n    }\n\n    try {\n      return {\n        webContents: {\n          id: webContents.id,\n          url: webContents.getURL(),\n        },\n      };\n    } catch {\n      return {};\n    }\n  }\n\n  handleEvent({ eventName, eventSource, handlerArgs }) {\n    const log = this.formatEventLog({ eventName, eventSource, handlerArgs });\n    if (log) {\n      const logFns = this.scope ? this.logger.scope(this.scope) : this.logger;\n      logFns?.[this.level]?.(...log);\n    }\n  }\n}\n\nmodule.exports = EventLogger;\n","'use strict';\n\nmodule.exports = { transform };\n\nfunction transform({\n  logger,\n  message,\n  transport,\n\n  initialData = message?.data || [],\n  transforms = transport?.transforms,\n}) {\n  return transforms.reduce((data, trans) => {\n    if (typeof trans === 'function') {\n      return trans({ data, logger, message, transport });\n    }\n\n    return data;\n  }, initialData);\n}\n","'use strict';\n\nconst { transform } = require('./transform');\n\nmodule.exports = {\n  concatFirstStringElements,\n  formatScope,\n  formatText,\n  formatVariables,\n  timeZoneFromOffset,\n\n  format({ message, logger, transport, data = message?.data }) {\n    switch (typeof transport.format) {\n      case 'string': {\n        return transform({\n          message,\n          logger,\n          transforms: [formatVariables, formatScope, formatText],\n          transport,\n          initialData: [transport.format, ...data],\n        });\n      }\n\n      case 'function': {\n        return transport.format({\n          data,\n          level: message?.level || 'info',\n          logger,\n          message,\n          transport,\n        });\n      }\n\n      default: {\n        return data;\n      }\n    }\n  },\n};\n\n/**\n * The first argument of console.log may contain a template. In the library\n * the first element is a string related to transports.console.format. So\n * this function concatenates first two elements to make templates like %d\n * work\n * @param {*[]} data\n * @return {*[]}\n */\nfunction concatFirstStringElements({ data }) {\n  if (typeof data[0] !== 'string' || typeof data[1] !== 'string') {\n    return data;\n  }\n\n  if (data[0].match(/%[1cdfiOos]/)) {\n    return data;\n  }\n\n  return [`${data[0]} ${data[1]}`, ...data.slice(2)];\n}\n\nfunction timeZoneFromOffset(minutesOffset) {\n  const minutesPositive = Math.abs(minutesOffset);\n  const sign = minutesOffset > 0 ? '-' : '+';\n  const hours = Math.floor(minutesPositive / 60).toString().padStart(2, '0');\n  const minutes = (minutesPositive % 60).toString().padStart(2, '0');\n  return `${sign}${hours}:${minutes}`;\n}\n\nfunction formatScope({ data, logger, message }) {\n  const { defaultLabel, labelLength } = logger?.scope || {};\n  const template = data[0];\n  let label = message.scope;\n\n  if (!label) {\n    label = defaultLabel;\n  }\n\n  let scopeText;\n  if (label === '') {\n    scopeText = labelLength > 0 ? ''.padEnd(labelLength + 3) : '';\n  } else if (typeof label === 'string') {\n    scopeText = ` (${label})`.padEnd(labelLength + 3);\n  } else {\n    scopeText = '';\n  }\n\n  data[0] = template.replace('{scope}', scopeText);\n  return data;\n}\n\nfunction formatVariables({ data, message }) {\n  let template = data[0];\n  if (typeof template !== 'string') {\n    return data;\n  }\n\n  // Add additional space to the end of {level}] template to align messages\n  template = template.replace('{level}]', `${message.level}]`.padEnd(6, ' '));\n\n  const date = message.date || new Date();\n  data[0] = template\n    .replace(/\\{(\\w+)}/g, (substring, name) => {\n      switch (name) {\n        case 'level': return message.level || 'info';\n        case 'logId': return message.logId;\n\n        case 'y': return date.getFullYear().toString(10);\n        case 'm': return (date.getMonth() + 1).toString(10).padStart(2, '0');\n        case 'd': return date.getDate().toString(10).padStart(2, '0');\n        case 'h': return date.getHours().toString(10).padStart(2, '0');\n        case 'i': return date.getMinutes().toString(10).padStart(2, '0');\n        case 's': return date.getSeconds().toString(10).padStart(2, '0');\n        case 'ms': return date.getMilliseconds().toString(10).padStart(3, '0');\n        case 'z': return timeZoneFromOffset(date.getTimezoneOffset());\n        case 'iso': return date.toISOString();\n\n        default: {\n          return message.variables?.[name] || substring;\n        }\n      }\n    })\n    .trim();\n\n  return data;\n}\n\nfunction formatText({ data }) {\n  const template = data[0];\n  if (typeof template !== 'string') {\n    return data;\n  }\n\n  const textTplPosition = template.lastIndexOf('{text}');\n  if (textTplPosition === template.length - 6) {\n    data[0] = template.replace(/\\s?{text}/, '');\n    if (data[0] === '') {\n      data.shift();\n    }\n\n    return data;\n  }\n\n  const templatePieces = template.split('{text}');\n  let result = [];\n\n  if (templatePieces[0] !== '') {\n    result.push(templatePieces[0]);\n  }\n\n  result = result.concat(data.slice(1));\n\n  if (templatePieces[1] !== '') {\n    result.push(templatePieces[1]);\n  }\n\n  return result;\n}\n","'use strict';\n\nconst util = require('util');\n\nmodule.exports = {\n  serialize,\n\n  maxDepth({ data, transport, depth = transport?.depth ?? 6 }) {\n    if (!data) {\n      return data;\n    }\n\n    if (depth < 1) {\n      if (Array.isArray(data)) return '[array]';\n      if (typeof data === 'object' && data) return '[object]';\n\n      return data;\n    }\n\n    if (Array.isArray(data)) {\n      return data.map((child) => module.exports.maxDepth({\n        data: child,\n        depth: depth - 1,\n      }));\n    }\n\n    if (typeof data !== 'object') {\n      return data;\n    }\n\n    if (data && typeof data.toISOString === 'function') {\n      return data;\n    }\n\n    // noinspection PointlessBooleanExpressionJS\n    if (data === null) {\n      return null;\n    }\n\n    if (data instanceof Error) {\n      return data;\n    }\n\n    const newJson = {};\n    for (const i in data) {\n      if (!Object.prototype.hasOwnProperty.call(data, i)) continue;\n      newJson[i] = module.exports.maxDepth({\n        data: data[i],\n        depth: depth - 1,\n      });\n    }\n\n    return newJson;\n  },\n\n  toJSON({ data }) {\n    return JSON.parse(JSON.stringify(data, createSerializer()));\n  },\n\n  toString({ data, transport }) {\n    const inspectOptions = transport?.inspectOptions || {};\n\n    const simplifiedData = data.map((item) => {\n      if (item === undefined) {\n        return undefined;\n      }\n\n      try {\n        const str = JSON.stringify(item, createSerializer(), '  ');\n        return str === undefined ? undefined : JSON.parse(str);\n      } catch (e) {\n        // There are some rare cases when an item can't be simplified.\n        // In that case, it's fine to pass it to util.format directly.\n        return item;\n      }\n    });\n\n    return util.formatWithOptions(inspectOptions, ...simplifiedData);\n  },\n};\n\n/**\n * @param {object} options?\n * @param {boolean} options.serializeMapAndSet?\n * @return {function}\n */\nfunction createSerializer(options = {}) {\n  const seen = new WeakSet();\n\n  return function (key, value) {\n    if (typeof value === 'object' && value !== null) {\n      if (seen.has(value)) {\n        return undefined;\n      }\n\n      seen.add(value);\n    }\n\n    return serialize(key, value, options);\n  };\n}\n\n/**\n * @param {string} key\n * @param {any} value\n * @param {object} options?\n * @return {any}\n */\nfunction serialize(key, value, options = {}) {\n  const serializeMapAndSet = options?.serializeMapAndSet !== false;\n\n  if (value instanceof Error) {\n    return value.stack;\n  }\n\n  if (!value) {\n    return value;\n  }\n\n  if (typeof value === 'function') {\n    return `[function] ${value.toString()}`;\n  }\n\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n\n  if (serializeMapAndSet && value instanceof Map && Object.fromEntries) {\n    return Object.fromEntries(value);\n  }\n\n  if (serializeMapAndSet && value instanceof Set && Array.from) {\n    return Array.from(value);\n  }\n\n  return value;\n}\n","'use strict';\n\nmodule.exports = {\n  transformStyles,\n\n  applyAnsiStyles({ data }) {\n    return transformStyles(data, styleToAnsi, resetAnsiStyle);\n  },\n\n  removeStyles({ data }) {\n    return transformStyles(data, () => '');\n  },\n};\n\nconst ANSI_COLORS = {\n  unset: '\\x1b[0m',\n  black: '\\x1b[30m',\n  red: '\\x1b[31m',\n  green: '\\x1b[32m',\n  yellow: '\\x1b[33m',\n  blue: '\\x1b[34m',\n  magenta: '\\x1b[35m',\n  cyan: '\\x1b[36m',\n  white: '\\x1b[37m',\n  gray: '\\x1b[90m',\n};\n\nfunction styleToAnsi(style) {\n  const color = style.replace(/color:\\s*(\\w+).*/, '$1').toLowerCase();\n  return ANSI_COLORS[color] || '';\n}\n\nfunction resetAnsiStyle(string) {\n  return string + ANSI_COLORS.unset;\n}\n\nfunction transformStyles(data, onStyleFound, onStyleApplied) {\n  const foundStyles = {};\n\n  return data.reduce((result, item, index, array) => {\n    if (foundStyles[index]) {\n      return result;\n    }\n\n    if (typeof item === 'string') {\n      let valueIndex = index;\n      let styleApplied = false;\n\n      item = item.replace(/%[1cdfiOos]/g, (match) => {\n        valueIndex += 1;\n\n        if (match !== '%c') {\n          return match;\n        }\n\n        const style = array[valueIndex];\n        if (typeof style === 'string') {\n          foundStyles[valueIndex] = true;\n          styleApplied = true;\n          return onStyleFound(style, item);\n        }\n\n        return match;\n      });\n\n      if (styleApplied && onStyleApplied) {\n        item = onStyleApplied(item);\n      }\n    }\n\n    result.push(item);\n    return result;\n  }, []);\n}\n","'use strict';\n\n/* eslint-disable no-console */\n\nconst {\n  concatFirstStringElements,\n  format,\n} = require('../../core/transforms/format');\nconst { maxDepth, toJSON } = require('../transforms/object');\nconst {\n  applyAnsiStyles,\n  removeStyles,\n} = require('../../core/transforms/style');\nconst { transform } = require('../../core/transforms/transform');\n\nconst consoleMethods = {\n  error: console.error,\n  warn: console.warn,\n  info: console.info,\n  verbose: console.info,\n  debug: console.debug,\n  silly: console.debug,\n  log: console.log,\n};\n\nmodule.exports = consoleTransportFactory;\n\nconst separator = process.platform === 'win32' ? '>' : '›';\nconst DEFAULT_FORMAT = `%c{h}:{i}:{s}.{ms}{scope}%c ${separator} {text}`;\n\nObject.assign(consoleTransportFactory, {\n  DEFAULT_FORMAT,\n});\n\nfunction consoleTransportFactory(logger) {\n  return Object.assign(transport, {\n    colorMap: {\n      error: 'red',\n      warn: 'yellow',\n      info: 'cyan',\n      verbose: 'unset',\n      debug: 'gray',\n      silly: 'gray',\n      default: 'unset',\n    },\n    format: DEFAULT_FORMAT,\n    level: 'silly',\n    transforms: [\n      addTemplateColors,\n      format,\n      formatStyles,\n      concatFirstStringElements,\n      maxDepth,\n      toJSON,\n    ],\n    useStyles: process.env.FORCE_STYLES,\n\n    writeFn({ message }) {\n      const consoleLogFn = consoleMethods[message.level] || consoleMethods.info;\n      consoleLogFn(...message.data);\n    },\n  });\n\n  function transport(message) {\n    const data = transform({ logger, message, transport });\n    transport.writeFn({\n      message: { ...message, data },\n    });\n  }\n}\n\nfunction addTemplateColors({ data, message, transport }) {\n  if (\n    typeof transport.format !== 'string'\n    || !transport.format.includes('%c')\n  ) {\n    return data;\n  }\n\n  return [\n    `color:${levelToStyle(message.level, transport)}`,\n    'color:unset',\n    ...data,\n  ];\n}\n\nfunction canUseStyles(useStyleValue, level) {\n  if (typeof useStyleValue === 'boolean') {\n    return useStyleValue;\n  }\n\n  const useStderr = level === 'error' || level === 'warn';\n  const stream = useStderr ? process.stderr : process.stdout;\n  return stream && stream.isTTY;\n}\n\nfunction formatStyles(args) {\n  const { message, transport } = args;\n  const useStyles = canUseStyles(transport.useStyles, message.level);\n  const nextTransform = useStyles ? applyAnsiStyles : removeStyles;\n  return nextTransform(args);\n}\n\nfunction levelToStyle(level, transport) {\n  return transport.colorMap[level] || transport.colorMap.default;\n}\n","'use strict';\n\nconst EventEmitter = require('events');\nconst fs = require('fs');\nconst os = require('os');\n\nclass File extends EventEmitter {\n  asyncWriteQueue = [];\n  bytesWritten = 0;\n  hasActiveAsyncWriting = false;\n  path = null;\n  initialSize = undefined;\n  writeOptions = null;\n  writeAsync = false;\n\n  constructor({\n    path,\n    writeOptions = { encoding: 'utf8', flag: 'a', mode: 0o666 },\n    writeAsync = false,\n  }) {\n    super();\n\n    this.path = path;\n    this.writeOptions = writeOptions;\n    this.writeAsync = writeAsync;\n  }\n\n  get size() {\n    return this.getSize();\n  }\n\n  clear() {\n    try {\n      fs.writeFileSync(this.path, '', {\n        mode: this.writeOptions.mode,\n        flag: 'w',\n      });\n      this.reset();\n      return true;\n    } catch (e) {\n      if (e.code === 'ENOENT') {\n        return true;\n      }\n\n      this.emit('error', e, this);\n      return false;\n    }\n  }\n\n  crop(bytesAfter) {\n    try {\n      const content = readFileSyncFromEnd(this.path, bytesAfter || 4096);\n      this.clear();\n      this.writeLine(`[log cropped]${os.EOL}${content}`);\n    } catch (e) {\n      this.emit(\n        'error',\n        new Error(`Couldn't crop file ${this.path}. ${e.message}`),\n        this,\n      );\n    }\n  }\n\n  getSize() {\n    if (this.initialSize === undefined) {\n      try {\n        const stats = fs.statSync(this.path);\n        this.initialSize = stats.size;\n      } catch (e) {\n        this.initialSize = 0;\n      }\n    }\n\n    return this.initialSize + this.bytesWritten;\n  }\n\n  increaseBytesWrittenCounter(text) {\n    this.bytesWritten += Buffer.byteLength(text, this.writeOptions.encoding);\n  }\n\n  isNull() {\n    return false;\n  }\n\n  nextAsyncWrite() {\n    const file = this;\n\n    if (this.hasActiveAsyncWriting || this.asyncWriteQueue.length === 0) {\n      return;\n    }\n\n    const text = this.asyncWriteQueue.join('');\n    this.asyncWriteQueue = [];\n    this.hasActiveAsyncWriting = true;\n\n    fs.writeFile(this.path, text, this.writeOptions, (e) => {\n      file.hasActiveAsyncWriting = false;\n\n      if (e) {\n        file.emit(\n          'error',\n          new Error(`Couldn't write to ${file.path}. ${e.message}`),\n          this,\n        );\n      } else {\n        file.increaseBytesWrittenCounter(text);\n      }\n\n      file.nextAsyncWrite();\n    });\n  }\n\n  reset() {\n    this.initialSize = undefined;\n    this.bytesWritten = 0;\n  }\n\n  toString() {\n    return this.path;\n  }\n\n  writeLine(text) {\n    text += os.EOL;\n\n    if (this.writeAsync) {\n      this.asyncWriteQueue.push(text);\n      this.nextAsyncWrite();\n      return;\n    }\n\n    try {\n      fs.writeFileSync(this.path, text, this.writeOptions);\n      this.increaseBytesWrittenCounter(text);\n    } catch (e) {\n      this.emit(\n        'error',\n        new Error(`Couldn't write to ${this.path}. ${e.message}`),\n        this,\n      );\n    }\n  }\n}\n\nmodule.exports = File;\n\nfunction readFileSyncFromEnd(filePath, bytesCount) {\n  const buffer = Buffer.alloc(bytesCount);\n  const stats = fs.statSync(filePath);\n\n  const readLength = Math.min(stats.size, bytesCount);\n  const offset = Math.max(0, stats.size - bytesCount);\n\n  const fd = fs.openSync(filePath, 'r');\n  const totalBytes = fs.readSync(fd, buffer, 0, readLength, offset);\n  fs.closeSync(fd);\n\n  return buffer.toString('utf8', 0, totalBytes);\n}\n","'use strict';\n\nconst File = require('./File');\n\nclass NullFile extends File {\n  clear() {\n\n  }\n\n  crop() {\n\n  }\n\n  getSize() {\n    return 0;\n  }\n\n  isNull() {\n    return true;\n  }\n\n  writeLine() {\n\n  }\n}\n\nmodule.exports = NullFile;\n","'use strict';\n\nconst EventEmitter = require('events');\nconst fs = require('fs');\nconst path = require('path');\nconst File = require('./File');\nconst NullFile = require('./NullFile');\n\nclass FileRegistry extends EventEmitter {\n  store = {};\n\n  constructor() {\n    super();\n    this.emitError = this.emitError.bind(this);\n  }\n\n  /**\n   * Provide a File object corresponding to the filePath\n   * @param {string} filePath\n   * @param {WriteOptions} [writeOptions]\n   * @param {boolean} [writeAsync]\n   * @return {File}\n   */\n  provide({ filePath, writeOptions = {}, writeAsync = false }) {\n    let file;\n    try {\n      filePath = path.resolve(filePath);\n\n      if (this.store[filePath]) {\n        return this.store[filePath];\n      }\n\n      file = this.createFile({ filePath, writeOptions, writeAsync });\n    } catch (e) {\n      file = new NullFile({ path: filePath });\n      this.emitError(e, file);\n    }\n\n    file.on('error', this.emitError);\n    this.store[filePath] = file;\n    return file;\n  }\n\n  /**\n   * @param {string} filePath\n   * @param {WriteOptions} writeOptions\n   * @param {boolean} async\n   * @return {File}\n   * @private\n   */\n  createFile({ filePath, writeOptions, writeAsync }) {\n    this.testFileWriting({ filePath, writeOptions });\n    return new File({ path: filePath, writeOptions, writeAsync });\n  }\n\n  /**\n   * @param {Error} error\n   * @param {File} file\n   * @private\n   */\n  emitError(error, file) {\n    this.emit('error', error, file);\n  }\n\n  /**\n   * @param {string} filePath\n   * @param {WriteOptions} writeOptions\n   * @private\n   */\n  testFileWriting({ filePath, writeOptions }) {\n    fs.mkdirSync(path.dirname(filePath), { recursive: true });\n    fs.writeFileSync(filePath, '', { flag: 'a', mode: writeOptions.mode });\n  }\n}\n\nmodule.exports = FileRegistry;\n","'use strict';\n\nconst fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst FileRegistry = require('./FileRegistry');\nconst { transform } = require('../../../core/transforms/transform');\nconst { removeStyles } = require('../../../core/transforms/style');\nconst {\n  format,\n  concatFirstStringElements,\n} = require('../../../core/transforms/format');\nconst { toString } = require('../../transforms/object');\n\nmodule.exports = fileTransportFactory;\n\n// Shared between multiple file transport instances\nconst globalRegistry = new FileRegistry();\n\nfunction fileTransportFactory(\n  logger,\n  { registry = globalRegistry, externalApi } = {},\n) {\n  /** @type {PathVariables} */\n  let pathVariables;\n\n  if (registry.listenerCount('error') < 1) {\n    registry.on('error', (e, file) => {\n      logConsole(`Can't write to ${file}`, e);\n    });\n  }\n\n  return Object.assign(transport, {\n    fileName: getDefaultFileName(logger.variables.processType),\n    format: '[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}]{scope} {text}',\n    getFile,\n    inspectOptions: { depth: 5 },\n    level: 'silly',\n    maxSize: 1024 ** 2,\n    readAllLogs,\n    sync: true,\n    transforms: [removeStyles, format, concatFirstStringElements, toString],\n    writeOptions: { flag: 'a', mode: 0o666, encoding: 'utf8' },\n\n    archiveLogFn(file) {\n      const oldPath = file.toString();\n      const inf = path.parse(oldPath);\n      try {\n        fs.renameSync(oldPath, path.join(inf.dir, `${inf.name}.old${inf.ext}`));\n      } catch (e) {\n        logConsole('Could not rotate log', e);\n        const quarterOfMaxSize = Math.round(transport.maxSize / 4);\n        file.crop(Math.min(quarterOfMaxSize, 256 * 1024));\n      }\n    },\n\n    resolvePathFn(vars) {\n      return path.join(vars.libraryDefaultDir, vars.fileName);\n    },\n\n    setAppName(name) {\n      logger.dependencies.externalApi.setAppName(name);\n    },\n  });\n\n  function transport(message) {\n    const file = getFile(message);\n\n    const needLogRotation = transport.maxSize > 0\n      && file.size > transport.maxSize;\n\n    if (needLogRotation) {\n      transport.archiveLogFn(file);\n      file.reset();\n    }\n\n    const content = transform({ logger, message, transport });\n    file.writeLine(content);\n  }\n\n  function initializeOnFirstAccess() {\n    if (pathVariables) {\n      return;\n    }\n\n    // Make a shallow copy of pathVariables to keep getters intact\n    pathVariables = Object.create(\n      Object.prototype,\n      {\n        ...Object.getOwnPropertyDescriptors(\n          externalApi.getPathVariables(),\n        ),\n        fileName: {\n          get() {\n            return transport.fileName;\n          },\n          enumerable: true,\n        },\n      },\n    );\n\n    if (typeof transport.archiveLog === 'function') {\n      transport.archiveLogFn = transport.archiveLog;\n      logConsole('archiveLog is deprecated. Use archiveLogFn instead');\n    }\n\n    if (typeof transport.resolvePath === 'function') {\n      transport.resolvePathFn = transport.resolvePath;\n      logConsole('resolvePath is deprecated. Use resolvePathFn instead');\n    }\n  }\n\n  function logConsole(message, error = null, level = 'error') {\n    const data = [`electron-log.transports.file: ${message}`];\n\n    if (error) {\n      data.push(error);\n    }\n\n    logger.transports.console({ data, date: new Date(), level });\n  }\n\n  function getFile(msg) {\n    initializeOnFirstAccess();\n\n    const filePath = transport.resolvePathFn(pathVariables, msg);\n    return registry.provide({\n      filePath,\n      writeAsync: !transport.sync,\n      writeOptions: transport.writeOptions,\n    });\n  }\n\n  function readAllLogs({ fileFilter = (f) => f.endsWith('.log') } = {}) {\n    initializeOnFirstAccess();\n    const logsPath = path.dirname(transport.resolvePathFn(pathVariables));\n\n    if (!fs.existsSync(logsPath)) {\n      return [];\n    }\n\n    return fs.readdirSync(logsPath)\n      .map((fileName) => path.join(logsPath, fileName))\n      .filter(fileFilter)\n      .map((logPath) => {\n        try {\n          return {\n            path: logPath,\n            lines: fs.readFileSync(logPath, 'utf8').split(os.EOL),\n          };\n        } catch {\n          return null;\n        }\n      })\n      .filter(Boolean);\n  }\n}\n\nfunction getDefaultFileName(processType = process.type) {\n  switch (processType) {\n    case 'renderer': return 'renderer.log';\n    case 'worker': return 'worker.log';\n    default: return 'main.log';\n  }\n}\n","'use strict';\n\nconst { maxDepth, toJSON } = require('../transforms/object');\nconst { transform } = require('../../core/transforms/transform');\n\nmodule.exports = ipcTransportFactory;\n\n/**\n * @param logger\n * @param {ElectronExternalApi} externalApi\n * @returns {transport|null}\n */\nfunction ipcTransportFactory(logger, { externalApi }) {\n  Object.assign(transport, {\n    depth: 3,\n    eventId: '__ELECTRON_LOG_IPC__',\n    level: logger.isDev ? 'silly' : false,\n    transforms: [toJSON, maxDepth],\n  });\n\n  return externalApi?.isElectron() ? transport : undefined;\n\n  function transport(message) {\n    if (message?.variables?.processType === 'renderer') {\n      return;\n    }\n\n    externalApi?.sendIpc(transport.eventId, {\n      ...message,\n      data: transform({ logger, message, transport }),\n    });\n  }\n}\n","'use strict';\n\nconst http = require('http');\nconst https = require('https');\nconst { transform } = require('../../core/transforms/transform');\nconst { removeStyles } = require('../../core/transforms/style');\nconst { toJSON, maxDepth } = require('../transforms/object');\n\nmodule.exports = remoteTransportFactory;\n\nfunction remoteTransportFactory(logger) {\n  return Object.assign(transport, {\n    client: { name: 'electron-application' },\n    depth: 6,\n    level: false,\n    requestOptions: {},\n    transforms: [removeStyles, toJSON, maxDepth],\n\n    makeBodyFn({ message }) {\n      return JSON.stringify({\n        client: transport.client,\n        data: message.data,\n        date: message.date.getTime(),\n        level: message.level,\n        scope: message.scope,\n        variables: message.variables,\n      });\n    },\n\n    processErrorFn({ error }) {\n      logger.processMessage(\n        {\n          data: [`electron-log: can't POST ${transport.url}`, error],\n          level: 'warn',\n        },\n        { transports: ['console', 'file'] },\n      );\n    },\n\n    sendRequestFn({ serverUrl, requestOptions, body }) {\n      const httpTransport = serverUrl.startsWith('https:') ? https : http;\n\n      const request = httpTransport.request(serverUrl, {\n        method: 'POST',\n        ...requestOptions,\n        headers: {\n          'Content-Type': 'application/json',\n          'Content-Length': body.length,\n          ...requestOptions.headers,\n        },\n      });\n\n      request.write(body);\n      request.end();\n\n      return request;\n    },\n  });\n\n  function transport(message) {\n    if (!transport.url) {\n      return;\n    }\n\n    const body = transport.makeBodyFn({\n      logger,\n      message: { ...message, data: transform({ logger, message, transport }) },\n      transport,\n    });\n\n    const request = transport.sendRequestFn({\n      serverUrl: transport.url,\n      requestOptions: transport.requestOptions,\n      body: Buffer.from(body, 'utf8'),\n    });\n\n    request.on('error', (error) => transport.processErrorFn({\n      error,\n      logger,\n      message,\n      request,\n      transport,\n    }));\n  }\n}\n","'use strict';\n\nconst Logger = require('../core/Logger');\nconst ErrorHandler = require('./ErrorHandler');\nconst EventLogger = require('./EventLogger');\nconst transportConsole = require('./transports/console');\nconst transportFile = require('./transports/file');\nconst transportIpc = require('./transports/ipc');\nconst transportRemote = require('./transports/remote');\n\nmodule.exports = createDefaultLogger;\n\nfunction createDefaultLogger({ dependencies, initializeFn }) {\n  const defaultLogger = new Logger({\n    dependencies,\n    errorHandler: new ErrorHandler(),\n    eventLogger: new EventLogger(),\n    initializeFn,\n    isDev: dependencies.externalApi?.isDev(),\n    logId: 'default',\n    transportFactories: {\n      console: transportConsole,\n      file: transportFile,\n      ipc: transportIpc,\n      remote: transportRemote,\n    },\n    variables: {\n      processType: 'main',\n    },\n  });\n\n  defaultLogger.default = defaultLogger;\n  defaultLogger.Logger = Logger;\n\n  defaultLogger.processInternalErrorFn = (e) => {\n    defaultLogger.transports.console.writeFn({\n      message: {\n        data: ['Unhandled electron-log error', e],\n        level: 'error',\n      },\n    });\n  };\n\n  return defaultLogger;\n}\n","'use strict';\n\nconst electron = require('electron');\nconst ElectronExternalApi = require('./ElectronExternalApi');\nconst { initialize } = require('./initialize');\nconst createDefaultLogger = require('../node/createDefaultLogger');\n\nconst externalApi = new ElectronExternalApi({ electron });\nconst defaultLogger = createDefaultLogger({\n  dependencies: { externalApi },\n  initializeFn: initialize,\n});\n\nmodule.exports = defaultLogger;\n\nexternalApi.onIpc('__ELECTRON_LOG__', (_, message) => {\n  if (message.scope) {\n    defaultLogger.Logger.getInstance(message).scope(message.scope);\n  }\n\n  const date = new Date(message.date);\n  processMessage({\n    ...message,\n    date: date.getTime() ? date : new Date(),\n  });\n});\n\nexternalApi.onIpcInvoke('__ELECTRON_LOG__', (_, { cmd = '', logId }) => {\n  switch (cmd) {\n    case 'getOptions': {\n      const logger = defaultLogger.Logger.getInstance({ logId });\n      return {\n        levels: logger.levels,\n        logId,\n      };\n    }\n\n    default: {\n      processMessage({ data: [`Unknown cmd '${cmd}'`], level: 'error' });\n      return {};\n    }\n  }\n});\n\nfunction processMessage(message) {\n  defaultLogger.Logger.getInstance(message)?.processMessage(message);\n}\n","'use strict';\n\nconst main = require('./src/main');\n\nmodule.exports = main;\n","// electron/main/server.ts\r\nimport { createServer, IncomingMessage, ServerResponse } from 'node:http';\r\nimport { BrowserWindow, ipcMain } from 'electron';\r\n\r\nconst PORT = 19999;\r\n\r\nexport function startLocalServer(win: BrowserWindow) {\r\n  const server = createServer(async (req: IncomingMessage, res: ServerResponse) => {\r\n    // CORS 설정 (크롬 콘솔 등 외부 접근 허용)\r\n    res.setHeader('Access-Control-Allow-Origin', '*');\r\n    res.setHeader('Access-Control-Allow-Methods', 'POST, OPTIONS');\r\n    res.setHeader('Access-Control-Allow-Headers', 'Content-Type');\r\n\r\n    if (req.method === 'OPTIONS') {\r\n      res.writeHead(200);\r\n      res.end();\r\n      return;\r\n    }\r\n\r\n    if (req.url === '/chat' && req.method === 'POST') {\r\n      let body = '';\r\n      req.on('data', chunk => body += chunk.toString());\r\n      req.on('end', async () => {\r\n        try {\r\n          const { message } = JSON.parse(body);\r\n          console.log(`[Server] Received external message: ${message}`);\r\n\r\n          // 렌더러(Chat UI)로 메시지 전달 및 응답 대기\r\n          const reply = await requestToRenderer(win, message);\r\n          console.log\r\n          \r\n\r\n          res.writeHead(200, { 'Content-Type': 'application/json' });\r\n          res.end(JSON.stringify({ reply }));\r\n        } catch (e: any) {\r\n          console.error(e);\r\n          res.writeHead(500);\r\n          res.end(JSON.stringify({ error: e.message || 'Internal Error' }));\r\n        }\r\n      });\r\n    } else {\r\n      res.writeHead(404);\r\n      res.end('Not Found');\r\n    }\r\n  });\r\n\r\n  server.listen(PORT, '127.0.0.1', () => {\r\n    console.log(`Dive Communication Server running on http://127.0.0.1:${PORT}`);\r\n  });\r\n  \r\n  return server;\r\n}\r\n\r\nfunction requestToRenderer(win: BrowserWindow, message: string): Promise<string> {\r\n  return new Promise((resolve) => {\r\n    // 1. 렌더러에게 질문 던지기\r\n    win.webContents.send('external-chat-request', message);\r\n\r\n    // 2. 렌더러가 답변을 다 만들면 보내줄 채널 리스닝 (1회성)\r\n    ipcMain.once('external-chat-response', (_event, reply) => {\r\n      resolve(reply);\r\n    });\r\n\r\n    // 3. 타임아웃 (옵션: 60초)\r\n    setTimeout(() => {\r\n        // 이미 처리되었는지 확인이 어렵다면 ipcMain.removeListener 등을 고려해야 함\r\n        // 여기서는 간단히 구현\r\n    }, 60000);\r\n  });\r\n}","import { app, BrowserWindow, shell, ipcMain } from \"electron\"\r\nimport path from \"node:path\"\r\nimport os from \"node:os\"\r\nimport AppState from \"./state\"\r\nimport { cleanup, initMCPClient } from \"./service\"\r\nimport { getUnixSystemPath, modifyPath } from \"./util\"\r\nimport { binDirList, darwinPathList, __dirname, VITE_DEV_SERVER_URL, RENDERER_DIST, logDir } from \"./constant\"\r\nimport { update } from \"./update\"\r\nimport { ipcHandler } from \"./ipc\"\r\nimport { initTray } from \"./tray\"\r\nimport { preferencesStore } from \"./store\"\r\nimport { initProtocol } from \"./protocol\"\r\nimport log from \"electron-log/main\"\r\nimport { deeplinkHandler, refreshConfig, setOAPTokenToHost, setupAppImageDeepLink } from \"./deeplink\"\r\nimport { oapClient } from \"./oap\"\r\nimport electronDl from \"electron-dl\"\r\n// [추가] 로컬 서버 모듈 임포트\r\nimport { startLocalServer } from \"./server\"\r\n// import core from \"core-js\"\r\n\r\nlog.initialize()\r\nlog.transports.file.resolvePathFn = () => path.join(logDir, \"main-electron.log\")\r\nObject.assign(console, log.functions)\r\n\r\nelectronDl()\r\n\r\n// Disable GPU Acceleration for Windows 7\r\nif (os.release().startsWith(\"6.1\"))\r\n  app.disableHardwareAcceleration()\r\n\r\n// Set application name for Windows 10+ notifications\r\nif (process.platform === \"win32\")\r\n  app.setAppUserModelId(app.getName())\r\n\r\n// Check if the app is already running\r\nif (!app.requestSingleInstanceLock()) {\r\n  app.quit()\r\n  process.exit(0)\r\n} else {\r\n  app.on(\"second-instance\", (event, commandLine) => {\r\n    if (win) {\r\n      if (win.isMinimized()) {\r\n        win.restore()\r\n      }\r\n      win.focus()\r\n    }\r\n\r\n    deeplinkHandler(win, commandLine.pop() ?? \"\")\r\n  })\r\n}\r\n\r\napp.on(\"open-url\", (event, url) => {\r\n  deeplinkHandler(win, url)\r\n})\r\n\r\n// Settings deeplink scheme\r\nif (process.defaultApp) {\r\n  if (process.argv.length >= 2) {\r\n    app.setAsDefaultProtocolClient(\"dive\", process.execPath, [path.resolve(process.argv[1])])\r\n  }\r\n} else {\r\n  app.setAsDefaultProtocolClient(\"dive\")\r\n}\r\n\r\nlet win: BrowserWindow | null = null\r\nconst preload = path.join(__dirname, \"../preload/index.mjs\")\r\nconst indexHtml = path.join(RENDERER_DIST, \"index.html\")\r\n\r\nasync function onReady() {\r\n  if (process.platform === \"win32\") {\r\n    binDirList.forEach(modifyPath)\r\n  } else {\r\n    process.env.PATH = await getUnixSystemPath().catch(() => process.env.PATH)\r\n  }\r\n\r\n  if (process.platform === \"darwin\") {\r\n    darwinPathList.forEach(modifyPath)\r\n  }\r\n\r\n  setupAppImageDeepLink()\r\n  initProtocol()\r\n  createWindow()\r\n  initMCPClient(win!)\r\n\r\n  // core.listenIpcElicitationRequest((e, data) => {\r\n  //   if (e) {\r\n  //     console.error(e)\r\n  //     return\r\n  //   }\r\n\r\n  //   win?.webContents.send(\"mcp.elicitation\", data)\r\n  // })\r\n\r\n  if (import.meta.env.VITE_OAP_TOKEN && !app.isPackaged) {\r\n    console.info(\"set oap token from env\")\r\n    setOAPTokenToHost(import.meta.env.VITE_OAP_TOKEN)\r\n  }\r\n\r\n  oapClient.registEvent(\"login\", () => {\r\n    win!.webContents.send(\"oap:login\")\r\n  })\r\n\r\n  oapClient.registEvent(\"logout\", () => {\r\n    win!.webContents.send(\"oap:logout\")\r\n  })\r\n\r\n  oapClient.onReceiveWebSocketMessage((message) => {\r\n    if (VITE_DEV_SERVER_URL) {\r\n      console.log(\"receive websocket message\", message)\r\n    }\r\n\r\n    switch (message.type) {\r\n      case \"user.settings.mcps.updated\":\r\n      case \"user.account.subscription.update\":\r\n        refreshConfig()\r\n        break\r\n      default:\r\n    }\r\n  })\r\n}\r\n\r\nexport async function createWindow() {\r\n  win = new BrowserWindow({\r\n    title: \"Dive AI\",\r\n    icon: path.join(process.env.VITE_PUBLIC, \"favicon.ico\"),\r\n    width: 1280,\r\n    height: 720,\r\n    minHeight: 320,\r\n    minWidth: 400,\r\n    webPreferences: {\r\n      preload,\r\n      // Warning: Enable nodeIntegration and disable contextIsolation is not secure in production\r\n      // nodeIntegration: true,\r\n\r\n      // Consider using contextBridge.exposeInMainWorld\r\n      // Read more on https://www.electronjs.org/docs/latest/tutorial/context-isolation\r\n      // contextIsolation: false,\r\n    },\r\n  })\r\n\r\n  // win.webContents.openDevTools()\r\n  if (VITE_DEV_SERVER_URL) { // #298\r\n    win.loadURL(VITE_DEV_SERVER_URL)\r\n    // Open devTool if the app is not packaged\r\n    win.webContents.openDevTools()\r\n  } else {\r\n    win.setMenu(null)\r\n    win.loadFile(indexHtml)\r\n  }\r\n\r\n  // [추가] 로컬 서버 실행 (win 객체 전달)\r\n  startLocalServer(win)\r\n\r\n  // Test actively push message to the Electron-Renderer\r\n  win.webContents.on(\"did-finish-load\", () => {\r\n    win?.webContents.send(\"main-process-message\", new Date().toLocaleString())\r\n  })\r\n\r\n  // Make all links open with the browser, not with the application\r\n  win.webContents.setWindowOpenHandler(({ url }) => {\r\n    if (url.startsWith(\"https:\"))\r\n      shell.openExternal(url)\r\n\r\n    return { action: \"deny\" }\r\n  })\r\n\r\n  win.on(\"close\", (event) => {\r\n    if (!AppState.isQuitting) {\r\n      event.preventDefault()\r\n      win?.hide()\r\n      return false\r\n    }\r\n\r\n    return true\r\n  })\r\n\r\n  // Auto update\r\n  update(win)\r\n\r\n  // Tray\r\n  const shouldminimalToTray = preferencesStore.get(\"minimalToTray\")\r\n  if (process.platform !== \"darwin\" && shouldminimalToTray) {\r\n    initTray(win)\r\n    AppState.setIsQuitting(false)\r\n  }\r\n\r\n  // ipc handler\r\n  ipcHandler(win)\r\n\r\n  const shouldAutoLaunch = preferencesStore.get(\"autoLaunch\")\r\n  app.setLoginItemSettings({\r\n    openAtLogin: shouldAutoLaunch,\r\n    openAsHidden: false\r\n  })\r\n}\r\n\r\napp.whenReady().then(onReady)\r\n\r\napp.on(\"quit\", async () => {\r\n  await cleanup()\r\n})\r\n\r\napp.on(\"window-all-closed\", async () => {\r\n  win = null\r\n\r\n  if (process.platform !== \"darwin\" && AppState.isQuitting) {\r\n    app.quit()\r\n  }\r\n})\r\n\r\napp.on(\"second-instance\", () => {\r\n  if (win) {\r\n    // Focus on the main window if the user tried to open another\r\n    if (win.isMinimized())\r\n      win.restore()\r\n\r\n    win.focus()\r\n  }\r\n})\r\n\r\napp.on(\"before-quit\", () => {\r\n  AppState.setIsQuitting(true)\r\n})\r\n\r\napp.on(\"activate\", () => {\r\n  const allWindows = BrowserWindow.getAllWindows()\r\n  if (allWindows.length) {\r\n    allWindows[0].show()\r\n    allWindows[0].focus()\r\n  } else {\r\n    if (win) {\r\n      win.show()\r\n    } else {\r\n      createWindow()\r\n    }\r\n  }\r\n})\r\n\r\n// New window example arg: new windows url\r\nipcMain.handle(\"open-win\", (_, arg) => {\r\n  const childWindow = new BrowserWindow({\r\n    webPreferences: {\r\n      preload,\r\n      nodeIntegration: true,\r\n      contextIsolation: false,\r\n    },\r\n  })\r\n\r\n  if (VITE_DEV_SERVER_URL) {\r\n    childWindow.loadURL(`${VITE_DEV_SERVER_URL}#${arg}`)\r\n  } else {\r\n    childWindow.loadFile(indexHtml, { hash: arg })\r\n  }\r\n})"],"names":["process","__dirname","path","os","win","packageJson","options","cwd","require$$0","bufferUtilModule","bufferUtil","require$$1","require$$2","require$$3","data","validationModule","Writable","require$$4","require$$5","sender","format","extension","EventEmitter","net","require$$6","URL","require$$8","require$$9","require$$10","require$$11","require$$12","require$$13","require$$14","require$$15","WebSocket","receiver","websocket","protocol","key","stream","err","subprotocol","require$$7","version","store","AppState","homeDir","fs","this","exports","posix","win32","which","charset","acc","image","_a","_b","initialize","preload","scope","log","style","file","main"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnGb,WAAiB;;;;;;;;;;;;;;ACGjB,QAAI,KAAK5C,cAAA;AACT,QAAI,UAAUG,OAAgB;AAO9B,QAAI,sBAAsB;AAC1B,QAAI,mBAAmB;AAOvB,YAAA,UAAkB;AAClB,YAAA,WAAmB,EAAE,QAAQ,QAAO;AACpC,YAAA,cAAsB;AACtB,YAAA,YAAoBU;AACpB,YAAA,aAAqB,uBAAO,OAAO,IAAI;AACvC,YAAA,SAAiB;AACjB,YAAA,QAAgB,uBAAO,OAAO,IAAI;AAGlC,iBAAa,QAAQ,YAAY,QAAQ,KAAK;AAS9C,aAAS,QAAS,MAAM;AACtB,UAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;AACrC,eAAO;AAAA,MACX;AAGE,UAAI,QAAQ,oBAAoB,KAAK,IAAI;AACzC,UAAI,OAAO,SAAS,GAAG,MAAM,CAAC,EAAE,YAAW,CAAE;AAE7C,UAAI,QAAQ,KAAK,SAAS;AACxB,eAAO,KAAK;AAAA,MAChB;AAGE,UAAI,SAAS,iBAAiB,KAAK,MAAM,CAAC,CAAC,GAAG;AAC5C,eAAO;AAAA,MACX;AAEE,aAAO;AAAA,IACT;AASA,aAAS,YAAa,KAAK;AAEzB,UAAI,CAAC,OAAO,OAAO,QAAQ,UAAU;AACnC,eAAO;AAAA,MACX;AAEE,UAAI,OAAO,IAAI,QAAQ,GAAG,MAAM,KAC5B,QAAQ,OAAO,GAAG,IAClB;AAEJ,UAAI,CAAC,MAAM;AACT,eAAO;AAAA,MACX;AAGE,UAAI,KAAK,QAAQ,SAAS,MAAM,IAAI;AAClC,YAAIgC,WAAU,QAAQ,QAAQ,IAAI;AAClC,YAAIA,SAAS,SAAQ,eAAeA,SAAQ,YAAW;AAAA,MAC3D;AAEE,aAAO;AAAA,IACT;AASA,aAAShC,WAAW,MAAM;AACxB,UAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;AACrC,eAAO;AAAA,MACX;AAGE,UAAI,QAAQ,oBAAoB,KAAK,IAAI;AAGzC,UAAI,OAAO,SAAS,QAAQ,WAAW,MAAM,CAAC,EAAE,YAAW,CAAE;AAE7D,UAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ;AACzB,eAAO;AAAA,MACX;AAEE,aAAO,KAAK,CAAC;AAAA,IACf;AASA,aAAS,OAAQnB,OAAM;AACrB,UAAI,CAACA,SAAQ,OAAOA,UAAS,UAAU;AACrC,eAAO;AAAA,MACX;AAGE,UAAImB,aAAY,QAAQ,OAAOnB,KAAI,EAChC,YAAW,EACX,OAAO,CAAC;AAEX,UAAI,CAACmB,YAAW;AACd,eAAO;AAAA,MACX;AAEE,aAAO,QAAQ,MAAMA,UAAS,KAAK;AAAA,IACrC;AAOA,aAAS,aAAc,YAAY,OAAO;AAExC,UAAI,aAAa,CAAC,SAAS,UAAU,QAAW,MAAM;AAEtD,aAAO,KAAK,EAAE,EAAE,QAAQ,SAAS,gBAAiB,MAAM;AACtD,YAAI,OAAO,GAAG,IAAI;AAClB,YAAI,OAAO,KAAK;AAEhB,YAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ;AACzB;AAAA,QACN;AAGI,mBAAW,IAAI,IAAI;AAGnB,iBAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACpC,cAAIA,aAAY,KAAK,CAAC;AAEtB,cAAI,MAAMA,UAAS,GAAG;AACpB,gBAAI,OAAO,WAAW,QAAQ,GAAG,MAAMA,UAAS,CAAC,EAAE,MAAM;AACzD,gBAAI,KAAK,WAAW,QAAQ,KAAK,MAAM;AAEvC,gBAAI,MAAMA,UAAS,MAAM,+BACtB,OAAO,MAAO,SAAS,MAAM,MAAMA,UAAS,EAAE,OAAO,GAAG,EAAE,MAAM,iBAAkB;AAEnF;AAAA,YACV;AAAA,UACA;AAGM,gBAAMA,UAAS,IAAI;AAAA,QACzB;AAAA,MACA,CAAG;AAAA,IACH;AAAA;;;;;AC/KO,SAAS,eAAejB,MAAoB;AACjD,UAAQ,OAAO,yBAAyB,OAAO,GAAG,YAAoB;AACpE,QAAI;AACF,YAAM,EAAE,YAAY,QAAA,IAAY,KAAK,MAAM,OAAO;AAClD,YAAM,aAAa,OAAO,KAAK,OAAO,EAAE,OAAO,CAAC,KAAK,WAAW;AAC9D,cAAM,EAAE,KAAA,IAAS,QAAQ,MAAM;AAE/B,YAAI,CAAC;AACH,iBAAO;AAET,cAAM,eAAe,KAAK,KAAK,CAAC,QAAQ,IAAI,SAAS,IAAI,KAAK,IAAI,SAAS,IAAI,CAAC;AAChF,YAAI,CAAC;AACH,iBAAO;AAET,cAAM,iBAAiB,IAAI,WAAW,YAAY;AAClD,YAAI;AACF,iBAAO;AAET,cAAM,YAAY,KAAK,OAAO,CAACkD,MAAK,KAAK,UAAU,iBAAiB,MAAM,QAAQA,MAAK,EAAE;AACzF,YAAI,IAAI,WAAW,KAAK,KAAK,YAAY,YAAY,CAAC,GAAG;AACvD,eAAK,SAAS,IAAI,KAAK,KAAK,YAAY,YAAY;AAAA,QACtD;AAEA,cAAM,WAAW,KAAK,MAAM,YAAY,EAAE;AAC1C,YAAI,IAAI,WAAW,KAAK,KAAK,YAAY,QAAQ,CAAC,GAAG;AACnD,eAAK,SAAS,IAAI,KAAK,KAAK,YAAY,QAAQ;AAAA,QAClD;AAEA,YAAI,MAAM,IAAI;AAAA,UACZ,GAAG,QAAQ,MAAM;AAAA,UACjB;AAAA,QAAA;AAGF,eAAO;AAAA,MACT,GAAG,OAAO;AAEV,aAAO,KAAK,UAAU,EAAE,YAAY;AAAA,IACtC,SAAS,QAAQ;AACf,aAAO;AAAA,IACT;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,iBAAiB,OAAO,OAAO,EAAE,UAAU;AACxD,QAAI,WAAW,mBAAmB,GAAG;AACrC,UAAM,MAAM,KAAK,EAAE,QAAQ,QAAQ,EAChC,KAAK,CAAA,aAAY;AAChB,YAAM,qBAAqB,SAAS,QAAQ,IAAI,qBAAqB;AACrE,UAAI,oBAAoB;AACtB,cAAM,gBAAgB,mBAAmB,MAAM,oBAAoB;AACnE,YAAI,eAAe;AACjB,qBAAW,cAAc,CAAC;AAAA,QAC5B;AAAA,MACF;AAAA,IACF,CAAC,EACA,MAAM,MAAM;AACX,cAAQ,MAAM,iCAAiC;AAAA,IACjD,CAAC;AAEH,eAAW,YAAY;AACvB,UAAM,SAAS,MAAM,OAAO,eAAe;AAAA,MACzC,YAAY,CAAC,mBAAmB,2BAA2B;AAAA,MAC3D,aAAa;AAAA,IAAA,CACd;AAED,QAAI,OAAO,UAAU;AACnB;AAAA,IACF;AAEA,QAAI;AACF,YAAM,SAASlD,MAAK,KAAK,EAAE,WAAW,KAAK,QAAQ,OAAO,QAAQ,GAAG,UAAU,KAAK,SAAS,OAAO,QAAQ,GAAG;AAAA,IACjH,SAAS,OAAO;AACd,UAAI,iBAAiB,aAAa;AAChC,gBAAQ,KAAK,0BAA0B;AAAA,MACzC,OAAO;AACL,gBAAQ,MAAM,KAAK;AAAA,MACrB;AAAA,IACF;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,kBAAkB,OAAO,GAAG,QAA2B;AACpE,UAAM,qBAAqB,OAAO,QAAgB;AAChD,YAAM,WAAW,MAAM,MAAM,GAAG;AAChC,UAAI,CAAC,SAAS,IAAI;AAChB,cAAM,IAAI,MAAM,eAAe,SAAS,MAAM,EAAE;AAAA,MAClD;AAEA,YAAM,SAAS,MAAM,SAAS,YAAA;AAC9B,YAAMmD,SAAQ,YAAY,iBAAiB,OAAO,KAAK,MAAM,CAAC;AAC9D,UAAIA,OAAM,WAAW;AACnB,cAAM,IAAI,MAAM,oCAAoC;AAAA,MACtD;AAEA,aAAOA;AAAAA,IACT;AAEA,UAAM,gBAAgB;AACtB,QAAI,QAAQ;AACZ,QAAI,OAAO,QAAQ,UAAU;AAC3B,cAAQ,IAAI,WAAW,aAAa,IAChC,YAAY,eAAe,IAAI,UAAU,cAAc,MAAM,CAAC,IAC9D,MAAM,mBAAmB,GAAG;AAAA,IAClC,OAAO;AACL,cAAQ,YAAY,iBAAiB,OAAO,KAAK,GAAG,CAAC;AAAA,IACvD;AAEA,QAAI,MAAM,WAAW;AACnB,YAAM,IAAI,MAAM,oCAAoC;AAAA,IACtD;AAEA,cAAU,WAAW,KAAK;AAAA,EAC5B,CAAC;AAED,UAAQ,OAAO,yBAAyB,OAAO,MAAM;AACnD,QAAI,CAAC,IAAI,WAAW,KAAK,KAAK,WAAW,qBAAqB,CAAC,GAAG;AAChE,aAAO;AAAA,IACT;AAEA,WAAO,IAAI,SAAS,KAAK,KAAK,WAAW,qBAAqB,CAAC;AAAA,EACjE,CAAC;AAED,UAAQ,OAAO,yBAAyB,OAAO,GAAG,aAAgC;AAChF,WAAO,IAAI,UAAU,KAAK,KAAK,WAAW,qBAAqB,GAAG,UAAU,EAAE,QAAQ,EAAA,CAAG;AAAA,EAC3F,CAAC;AAED,UAAQ,OAAO,sBAAsB,YAAY;AAC/C,WAAO,cAAA;AAAA,EACT,CAAC;AAED,UAAQ,OAAO,sCAAsC,YAAY;AAC/D,WAAO,8BAAA;AAAA,EACT,CAAC;AAED,UAAQ,OAAO,sBAAsB,YAAY;AAC/C,WAAO;AAAA,MACL,SAAS,IAAI,WAAA;AAAA,MACb,WAAW;AAAA,IAAA;AAAA,EAEf,CAAC;AAED,UAAQ,OAAO,0BAA0B,OAAO,GAAG,YAAoB;AACrE,WAAO,CAAC,CAAC,MAAM,KAAK,SAAS,EAAE,SAAS,MAAM;AAAA,EAChD,CAAC;AAED,UAAQ,OAAO,sBAAsB,OAAO,GAAG,aAAqB;AAClE,QAAI;AACF,YAAM,SAAS,MAAM,IAAI,SAAS,QAAQ;AAC1C,aAAO;AAAA,QACL,MAAM;AAAA,QACN,MAAM,KAAK,SAAS,QAAQ;AAAA,QAC5B,UAAU,UAAU,OAAO,QAAQ,KAAK;AAAA,MAAA;AAAA,IAE5C,SAAS,OAAO;AACd,cAAQ,MAAM,8BAA8B,UAAU,KAAK;AAC3D,YAAM;AAAA,IACR;AAAA,EACF,CAAC;AACH;AAEA,SAAS,mBAAmB,KAAa;AACvC,MAAI;AACF,UAAM,OAAO,IAAI,IAAI,GAAG;AACxB,WAAO,KAAK,SAAS,MAAM,GAAG,EAAE,IAAA;AAAA,EAClC,SAAS,QAAQ;AACf,WAAO;AAAA,EACT;AACF;ACvKO,SAAS,cAAc,MAAqB;AACjD,UAAQ,OAAO,uBAAuB,OAAO,GAAG,WAAmB;AACjE,QAAI;AACF,YAAM,SAAS,IAAI,OAAO,EAAE,QAAQ;AACpC,YAAM,SAAS,MAAM,OAAO,OAAO,KAAA;AACnC,aAAO;AAAA,QACL,SAAS,OAAO,KACb,KAAK,CAAC,GAAG,MAAM,EAAE,UAAU,EAAE,OAAO,EACpC,IAAI,CAAC,UAAU,MAAM,EAAE;AAAA,QAC1B,OAAO;AAAA,MAAA;AAAA,IAEX,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,4BAA4B,OAAO,GAAG,QAAgB,eAAuB,iBAAyB,eAAuB;AAC1I,QAAI;AACF,YAAM,SAAS,IAAI,YAAY,EAAE,QAAQ,UAAU,eAAe,YAAY,iBAAiB,YAAY;AAC3G,YAAM,SAAS,MAAM,OAAO,OAAO,KAAA;AACnC,aAAO;AAAA,QACL,SAAS,OAAO,KACb,KAAK,CAAC,GAAG,MAAM,EAAE,UAAU,EAAE,OAAO,EACpC,IAAI,CAAC,UAAU,MAAM,EAAE;AAAA,QAC1B,OAAO;AAAA,MAAA;AAAA,IAEX,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,0BAA0B,OAAO,GAAG,QAAgB,YAAoB;AACrF,QAAI;AACF,YAAM,SAAS,IAAI,UAAU,EAAE,QAAQ,SAAS;AAChD,YAAM,SAAS,MAAM,OAAO,OAAO,KAAA;AACnC,aAAO;AAAA,QACL,SAAS,OAAO,KACb,KAAK,CAAC,GAAG,MAAM;AACd,gBAAM,QAAQ,IAAI,KAAK,EAAE,UAAU;AACnC,gBAAM,QAAQ,IAAI,KAAK,EAAE,UAAU;AACnC,iBAAO,MAAM,YAAY,MAAM,QAAA;AAAA,QACjC,CAAC,EACA,IAAI,CAAC,UAAe,MAAM,EAAE;AAAA,QAC/B,OAAO;AAAA,MAAA;AAAA,IAEX,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,uBAAuB,OAAO,GAAG,YAAoB;AAClE,QAAI;AACF,YAAM,SAAS,IAAI,OAAO,EAAE,MAAM,SAAS;AAC3C,YAAM,OAAO,MAAM,OAAO,KAAA;AAC1B,aAAO;AAAA,QACL,SAAS,KAAK,OACX,KAAK,CAAC,GAAG,MAAM;AACd,gBAAM,QAAQ,IAAI,KAAK,EAAE,WAAW;AACpC,gBAAM,QAAQ,IAAI,KAAK,EAAE,WAAW;AACpC,iBAAO,MAAM,YAAY,MAAM,QAAA;AAAA,QACjC,CAAC,EACA,IAAI,CAAC,UAAU,MAAM,IAAI;AAAA,QAAG,OAAO;AAAA,MAAA;AAAA,IAC1C,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,iCAAiC,OAAO,GAAG,QAAgB,YAAoB;AAC5F,QAAI;AACF,YAAM,SAAS,IAAI,OAAO,EAAE,QAAQ,SAAS;AAC7C,YAAM,OAAO,MAAM,OAAO,OAAO,KAAA;AACjC,aAAO;AAAA,QACL,SAAS,KAAK,KACX,KAAK,CAAC,GAAG,MAAM,EAAE,UAAU,EAAE,OAAO,EACpC,IAAI,CAAC,UAAU,MAAM,EAAE;AAAA,QAC1B,OAAO;AAAA,MAAA;AAAA,IAEX,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,4BAA4B,OAAO,GAAG,WAAmB;AACtE,QAAI;AACF,YAAM,MAAM,+DAA+D,MAAM;AACjF,YAAM,WAAW,MAAM,MAAM,GAAG;AAChC,YAAM,OAAO,MAAM,SAAS,KAAA;AAC5B,aAAO,EAAE,SAAS,KAAK,OAAO,IAAI,CAAC,UAAU,MAAM,IAAI,GAAG,OAAO,KAAA;AAAA,IACnE,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,0BAA0B,OAAO,GAAG,WAAmB;;AACpE,QAAI;AACF,YAAM,SAAS,IAAI,QAAQ,EAAE,QAAQ;AACrC,YAAM,SAAS,MAAM,OAAO,OAAO,KAAA;AACnC,aAAO;AAAA,QACL,UAAS,YAAO,SAAP,mBACL,KAAK,CAAC,GAAG,OAAO,EAAE,WAAW,MAAM,EAAE,WAAW,IACjD,IAAI,CAAC,UAAU,MAAM;AAAA,QACxB,OAAO;AAAA,MAAA;AAAA,IAEX,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AAED,UAAQ,OAAO,wBAAwB,OAAO,GAAG,aAAqB,iBAAyB,cAAsB,WAAmB;AACtI,QAAI;AACF,UAAI,cAAc;AAClB,UAAI,OAAO,WAAW,KAAK,GAAG;AAC5B,sBAAc;AAAA,MAChB,WAAW,OAAO,WAAW,KAAK,GAAG;AACnC,sBAAc;AAAA,MAChB,WAAW,OAAO,WAAW,KAAK,GAAG;AACnC,sBAAc;AAAA,MAChB,WAAW,OAAO,SAAS,GAAG,GAAG;AAC/B,sBAAc,OAAO,MAAM,GAAG,EAAE,CAAC,IAAI;AAAA,MACvC;AAEA,YAAM,SAAS,IAAI,cAAc;AAAA,QAC/B;AAAA,QACA,aAAa;AAAA,UACX;AAAA,UACA;AAAA,UACA;AAAA,QAAA;AAAA,MACF,CACD;AACD,YAAM,UAAU,IAAI,4BAA4B,EAAE;AAClD,YAAM,WAAW,MAAM,OAAO,KAAK,OAAO;AAC1C,YAAM,SAAS,SAAS;AACxB,aAAO,EAAE,UAAS,iCAAQ,IAAI,CAAC,UAAe,GAAG,WAAW,GAAG,MAAM,OAAO,QAAO,CAAA,GAAI,OAAO,KAAA;AAAA,IAChG,SAAS,OAAO;AACd,aAAO,EAAE,SAAS,CAAA,GAAI,OAAQ,MAAgB,QAAA;AAAA,IAChD;AAAA,EACF,CAAC;AACH;ACjJA,MAAM,gBAAgB,KAAK,kBAAkB;AAAA,EAC3C,EAAE,MAAM,OAAA;AAAA,EACR,EAAE,MAAM,YAAA;AACV,CAAC;AAED,MAAM,YAAY,KAAK,kBAAkB;AAAA,EACvC,EAAE,MAAM,OAAA;AAAA,EACR,EAAE,MAAM,QAAA;AAAA,EACR,EAAE,MAAM,MAAA;AAAA,EACR,EAAE,MAAM,YAAA;AACV,CAAC;AAEM,SAAS,eAAe,MAAqB;AAClD,UAAQ,OAAO,+BAA+B,MAAM;AAClD,kBAAc,MAAA;AAAA,EAChB,CAAC;AAED,UAAQ,OAAO,2BAA2B,MAAM;AAC9C,cAAU,MAAA;AAAA,EACZ,CAAC;AACH;ACfA,MAAM,YAAY,GAAG,YAAY;AACjC,MAAM,eAAe,GAAG,YAAY;AAE7B,SAAS,cAAc,MAAqB;AACjD,UAAQ,OAAO,aAAa,OAAO,GAAG,WAAoB;AACxD,UAAM,MAAM,GAAG,SAAS,eAAe,SAAS,qBAAqB,GAAG,SAAA,CAAU,WAAW,QAAQ,QAAQ;AAC7G,UAAM,aAAa,GAAG;AAAA,EACxB,CAAC;AAED,UAAQ,OAAO,cAAc,YAAY;AACvC,cAAU,OAAA;AAAA,EACZ,CAAC;AAED,UAAQ,OAAO,gBAAgB,YAAY;AACzC,WAAO,MAAM,SAAA;AAAA,EACf,CAAC;AAED,UAAQ,OAAO,uBAAuB,OAAO,GAAG,WAAiC;AAC/E,WAAO,MAAM,UAAU,gBAAgB,MAAM;AAAA,EAC/C,CAAC;AAED,UAAQ,OAAO,wBAAwB,OAAO,GAAG,WAAsC;AACrF,WAAO,MAAM,UAAU,iBAAiB,MAAM;AAAA,EAChD,CAAC;AAED,UAAQ,OAAO,sBAAsB,OAAO,GAAG,QAAkB;AAC/D,WAAO,MAAM,UAAU,eAAe,GAAG;AAAA,EAC3C,CAAC;AAED,UAAQ,OAAO,kBAAkB,YAAY;AAC3C,WAAO,MAAM,UAAU,WAAA;AAAA,EACzB,CAAC;AAED,UAAQ,OAAO,qBAAqB,YAAY;AAC9C,WAAO,MAAM,UAAU,cAAA;AAAA,EACzB,CAAC;AAED,UAAQ,OAAO,aAAa,YAAY;AACtC,WAAO,MAAM,UAAU,MAAA;AAAA,EACzB,CAAC;AAED,UAAQ,OAAO,gBAAgB,YAAY;AACzC,WAAO,MAAM,UAAU,SAAA;AAAA,EACzB,CAAC;AAED,UAAQ,OAAO,oBAAoB,OAAO,GAAG,WAAiC;AAC5E,WAAO,MAAM,UAAU,aAAa,MAAM;AAAA,EAC5C,CAAC;AACH;ACpDO,SAAS,mBAAmB,MAAqB;AACtD,UAAQ,OAAO,oBAAoB,OAAO,GAAG,SAAiB,aAAkB;AAAA,EAEhF,CAAC;AACH;ACEO,SAAS,WAAWnD,MAAoB;AAC7C,gBAAiB;AACjB,mBAAiBA,IAAG;AACpB,iBAAeA,IAAG;AAClB,gBAAiB;AACjB,iBAAkB;AAClB,gBAAiB;AACjB,qBAAsB;AACxB;ACdA,SAAS,4BAA4B;AAAA,EACnC;AAAA,IACE,QAAQ;AAAA,IACR,YAAY;AAAA,MACV,QAAQ;AAAA,MACR,iBAAiB;AAAA,MACjB,WAAW;AAAA,MACX,QAAQ;AAAA,IAAA;AAAA,EACV;AAEJ,CAAC;AAED,SAAS,4BAA4B;AAAA,EACnC;AAAA,IACE,QAAQ;AAAA,IACR,YAAY;AAAA,MACV,QAAQ;AAAA,MACR,iBAAiB;AAAA,MACjB,WAAW;AAAA,MACX,QAAQ;AAAA,IAAA;AAAA,EACV;AAEJ,CAAC;AAEM,SAAS,eAAe;AAC7B,WAAS,OAAO,cAAc,CAAC,QAAQ;AACrC,UAAM,MAAM,IAAI,IAAI,QAAQ,kBAAkB,QAAQ,aAAa,UAAU,aAAa,SAAS;AACnG,WAAO,IAAI,MAAM,GAAG;AAAA,EACtB,CAAC;AAED,WAAS,OAAO,OAAO,CAAC,QAAQ;AAE9B,UAAM,MAAM,IAAI,IAAI,UAAU,CAAC;AAC/B,UAAM,YAAY,KAAK,KAAK,QAAA,IAAY,aAAa,SAAS,GAAG;AACjE,WAAO,IAAI,MAAM,UAAU,SAAS,EAAE;AAAA,EACxC,CAAC;AACH;;;;;;ACrCA,QAAM,KAAKI;AACX,QAAMN,QAAOS;AAEb,gBAAiB;AAAA,IACf;AAAA,IACA;AAAA;AAMF,WAAS,yBAAyB;AAChC,WAAO,cAAc,kBAAiB,CAAE,KACnC,cAAc,oBAAmB,CAAE,KACnC,cAAc,QAAQ,eAAe,UAAU,KAC/C,cAAc,QAAQ,eAAe,KAAK,KAC1C,cAAc,QAAQ,IAAG,CAAE,KAC3B,EAAE,MAAM,QAAW,SAAS,OAAS;AAAA,EAC5C;AAMA,WAAS,iBAAiB,aAAa;AACrC,QAAI,CAAC,YAAY,CAAC,GAAG;AACnB,aAAO;AAAA,IACX;AAEE,QAAI;AACF,YAAM,aAAaT,MAAK,KAAK,GAAG,WAAW;AAC3C,YAAM,WAAW,OAAO,gBAAgB,UAAU;AAClD,UAAI,CAAC,UAAU;AACb,eAAO;AAAA,MACb;AAEI,YAAM,OAAO,KAAK,MAAM,GAAG,aAAa,UAAU,MAAM,CAAC;AACzD,YAAM,QAAO,6BAAM,iBAAe,6BAAM;AACxC,UAAI,CAAC,QAAQ,KAAK,YAAW,MAAO,YAAY;AAC9C,eAAO;AAAA,MACb;AAEI,UAAI,MAAM;AACR,eAAO,EAAE,MAAM,SAAS,6BAAM,QAAO;AAAA,MAC3C;AAEI,aAAO;AAAA,IACX,SAAW,GAAG;AACV,aAAO;AAAA,IACX;AAAA,EACA;AAOA,WAAS,OAAO,UAAUK,MAAK;AAC7B,QAAI,cAAcA;AAElB,WAAO,MAAM;AACX,YAAM,aAAaL,MAAK,MAAM,WAAW;AACzC,YAAM,OAAO,WAAW;AACxB,YAAM,MAAM,WAAW;AAEvB,UAAI,GAAG,WAAWA,MAAK,KAAK,aAAa,QAAQ,CAAC,GAAG;AACnD,eAAOA,MAAK,QAAQA,MAAK,KAAK,aAAa,QAAQ,CAAC;AAAA,MAC1D;AAEI,UAAI,gBAAgB,MAAM;AACxB,eAAO;AAAA,MACb;AAEI,oBAAc;AAAA,IAClB;AAAA,EACA;AAMA,WAAS,sBAAsB;AAC7B,UAAM,cAAc,QAAQ,KAAK,OAAO,CAAC,QAAQ;AAC/C,aAAO,IAAI,QAAQ,kBAAkB,MAAM;AAAA,IAC/C,CAAG;AAED,QAAI,YAAY,WAAW,KAAK,OAAO,YAAY,CAAC,MAAM,UAAU;AAClE,aAAO;AAAA,IACX;AAEE,UAAM,cAAc,YAAY,CAAC;AACjC,WAAO,YAAY,QAAQ,oBAAoB,EAAE;AAAA,EACnD;AAEA,WAAS,oBAAoB;;AAC3B,QAAI;AAEF,cAAO,aAAQ,SAAR,mBAAc;AAAA,IACzB,QAAU;AACN,aAAO;AAAA,IACX;AAAA,EACA;;;;;;;;ACnGA,QAAM,eAAeM;AACrB,QAAML,MAAK;AACX,QAAMD,QAAOU;AACb,QAAMP,eAAcQ,mBAAA;AAAA,EAEpB,MAAM,gBAAgB;AAAA,IAAtB;AACE;AACA;AACA,sCAAW,QAAQ;AAAA;AAAA,IAEnB,cAAc,UAAU,KAAK,cAAc;AACzC,UAAI,KAAK,aAAa,UAAU;AAC9B,eAAOX,MAAK,KAAK,KAAK,kBAAA,GAAqB,gBAAgB,OAAO;AAAA,MAAA;AAGpE,aAAOA,MAAK,KAAK,KAAK,mBAAmB,OAAO,GAAG,MAAM;AAAA,IAAA;AAAA,IAG3D,aAAa;;AACX,YAAM,UAAU,KAAK,aAAW,UAAK,wBAAL,mBAA0B;AAC1D,UAAI,CAAC,SAAS;AACZ,cAAM,IAAI;AAAA,UACR;AAAA;MAIF;AAGF,aAAO;AAAA,IAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOT,oBAAoB;AAClB,UAAI,OAAO,KAAK,mBAAmB,UAAU;AAC3C,aAAK,iBAAiBG,aAAY,uBAAA;AAAA,MAAuB;AAG3D,aAAO,KAAK;AAAA,IAAA;AAAA,IAGd,mBAAmB,UAAU,KAAK,cAAc;AAC9C,aAAO,UACHH,MAAK,KAAK,KAAK,qBAAA,GAAwB,OAAO,IAC9C;AAAA,IAAA;AAAA,IAGN,gBAAgB;;AACd,cAAO,UAAK,wBAAL,mBAA0B;AAAA,IAAA;AAAA,IAGnC,qBAAqB;AACnB,aAAO,KAAK,cAAA;AAAA,IAAc;AAAA,IAG5B,kBAAkB;AAChB,YAAM,UAAU,OAAOC,IAAG,QAAA,EAAU,MAAM,GAAG,EAAE,CAAC,CAAC;AACjD,UAAI,WAAW,IAAI;AACjB,eAAO,MAAM,UAAU,CAAC;AAAA,MAAA;AAG1B,aAAO,UAAU;AAAA,IAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOnB,eAAe;AACb,UAAI,SAASA,IAAG,KAAA,EAAO,QAAQ,KAAK,GAAG;AACvC,UAAI,YAAYA,IAAG,QAAA;AAEnB,UAAI,WAAW,UAAU;AACvB,iBAAS;AACT,oBAAY,KAAK,gBAAA;AAAA,MAAgB;AAGnC,aAAO,GAAG,MAAM,IAAI,SAAS;AAAA,IAAA;AAAA;AAAA;AAAA;AAAA,IAM/B,mBAAmB;AACjB,YAAM,UAAU,KAAK,WAAA;AACrB,YAAM,aAAa,KAAK,cAAA;AAExB,YAAM,OAAO;AAEb,aAAO;AAAA,QACL,SAAS,KAAK,qBAAA;AAAA,QACd;AAAA,QACA;AAAA,QACA,IAAI,qBAAqB;AACvB,iBAAO,KAAK,mBAAA;AAAA,QAAmB;AAAA,QAEjC,MAAM,KAAK,kBAAA;AAAA,QACX,mBAAmB,KAAK,cAAc,OAAO;AAAA,QAC7C,iBAAiB,KAAK,cAAc,WAAW;AAAA,QAC/C,MAAM,KAAK,kBAAA;AAAA,QACX,UAAU,KAAK,mBAAmB,OAAO;AAAA;IAC3C;AAAA,IAGF,uBAAuB;AACrB,YAAM,OAAO,KAAK,kBAAA;AAElB,cAAQ,KAAK,UAAA;AAAA,QACX,KAAK,UAAU;AACb,iBAAOD,MAAK,KAAK,MAAM,6BAA6B;AAAA,QAAA;AAAA,QAGtD,KAAK,SAAS;AACZ,iBAAO,QAAA,IAAY,WAAWA,MAAK,KAAK,MAAM,iBAAiB;AAAA,QAAA;AAAA,QAGjE,SAAS;AACP,iBAAO,QAAA,IAAY,mBAAmBA,MAAK,KAAK,MAAM,SAAS;AAAA,QAAA;AAAA,MACjE;AAAA,IACF;AAAA,IAGF,oBAAoB;;AAClB,eAAO,KAAAC,IAAG,YAAH,wBAAAA,SAAkB,QAAA,IAAY;AAAA,IAAA;AAAA,IAGvC,oBAAoB;AAClB,aAAOA,IAAG,OAAA;AAAA,IAAO;AAAA,IAGnB,cAAc;AACZ,aAAO;AAAA,QACL,KAAK,GAAG,KAAK,WAAA,CAAY,IAAI,KAAK,eAAe;AAAA,QACjD,UAAU;AAAA,QACV,IAAI,KAAK,aAAA;AAAA;IACX;AAAA,IAGF,QAAQ;AACN,aAAO,QAAA,IAAY,aAAa,iBAC3B,QAAA,IAAY,oBAAoB;AAAA,IAAA;AAAA,IAGvC,aAAa;AACX,aAAO,QAAQ,QAAQ,SAAS,QAAQ;AAAA,IAAA;AAAA,IAG1C,WAAW,YAAY,UAAU;AAAA,IAAA;AAAA,IAIjC,WAAW,SAAS;AAClB,cAAA;AAAA,IAAQ;AAAA,IAGV,wBAAwB,WAAW,SAAS;AAAA,IAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAS5C,MAAM,SAAS,UAAU;AAAA,IAAA;AAAA,IAIzB,YAAY,SAAS,UAAU;AAAA,IAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAQ/B,QAAQ,KAAK,cAAc,QAAQ,OAAO;AACxC,YAAM,WAAW,EAAE,QAAQ,QAAQ,OAAO,SAAS,OAAO,WAAA;AAC1D,YAAM,QAAQ,SAAS,QAAQ,QAAQ,KAAK;AAC5C,mBAAa,KAAK,GAAG,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,QAAQ;AAChD,YAAI,KAAK;AACP,sBAAY,GAAG;AAAA,QAAA;AAAA,MACjB,CACD;AAAA,IAAA;AAAA,IAGH,WAAW,SAAS;AAClB,WAAK,UAAU;AAAA,IAAA;AAAA,IAGjB,YAAY,UAAU;AACpB,WAAK,WAAW;AAAA,IAAA;AAAA,IAGlB,0BAA0B;AAAA,MACxB;AAAA;AAAA,MACA,uBAAuB;AAAA;AAAA,MACvB,cAAc,MAAM,CAAA;AAAA;AAAA,IAAC,GACpB;AAAA,IAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IASH,QAAQ,SAAS,SAAS;AAAA,IAAA;AAAA,IAI1B,aAAa,OAAO,SAAS;AAAA,IAAA;AAAA,EAG/B;AAEA,sBAAiB;;;;;;;;AC7NjB,QAAMD,QAAOM;AACb,QAAM,kBAAkBG,uBAAA;AAAA,EAExB,MAAM,4BAA4B,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,IAUhD,YAAY,EAAE,SAAQ,IAAK,IAAI;AAC7B,YAAK;AAPP;AAAA;AAAA;AAAA;AAQE,WAAK,WAAW;AAAA,IACpB;AAAA,IAEE,aAAa;;AACX,UAAI;AACJ,UAAI;AACF,kBAAU,KAAK,aACV,UAAK,SAAS,QAAd,mBAAmB,WACnB,UAAK,SAAS,QAAd,mBAAmB;AAAA,MAC9B,QAAY;AAAA,MAEZ;AACI,aAAO,WAAW,MAAM,WAAU;AAAA,IACtC;AAAA,IAEE,mBAAmB,SAAS;AAC1B,aAAO,KAAK,QAAQ,UAAU,KAAK,MAAM,mBAAmB,OAAO;AAAA,IACvE;AAAA,IAEE,gBAAgB;;AACd,UAAI;AACJ,UAAI;AACF,sBAAa,UAAK,SAAS,QAAd,mBAAmB;AAAA,MACtC,QAAY;AAAA,MAEZ;AACI,aAAO,cAAc,MAAM,cAAa;AAAA,IAC5C;AAAA,IAEE,qBAAqB;AACnB,aAAO,KAAK,QAAQ,MAAM,KAAK,MAAM,mBAAkB;AAAA,IAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOE,QAAQ,MAAM;;AACZ,UAAI;AACF,gBAAO,UAAK,SAAS,QAAd,mBAAmB,QAAQ;AAAA,MACxC,QAAY;AACN,eAAO;AAAA,MACb;AAAA,IACA;AAAA,IAEE,cAAc;AACZ,aAAO;AAAA,QACL,KAAK,GAAG,KAAK,WAAU,CAAE,IAAI,KAAK,cAAa,CAAE;AAAA,QACjD,UAAU,YAAY,QAAQ,SAAS,QAAQ;AAAA,QAC/C,IAAI,KAAK,aAAY;AAAA;IAE3B;AAAA,IAEE,uBAAuB;AACrB,aAAO,KAAK,QAAQ,SAAS,KAAK,MAAM,qBAAoB;AAAA,IAChE;AAAA,IAEE,QAAQ;;AACN,YAAI,UAAK,SAAS,QAAd,mBAAmB,gBAAe,QAAW;AAC/C,eAAO,CAAC,KAAK,SAAS,IAAI;AAAA,MAChC;AAEI,UAAI,OAAO,QAAQ,aAAa,UAAU;AACxC,cAAM,eAAeT,MAAK,SAAS,QAAQ,QAAQ,EAAE,YAAW;AAChE,eAAO,aAAa,WAAW,UAAU;AAAA,MAC/C;AAEI,aAAO,MAAM,MAAK;AAAA,IACtB;AAAA,IAEE,WAAW,WAAW,SAAS;;AAC7B,iBAAK,SAAS,QAAd,mBAAmB,GAAG,WAAW;AAEjC,aAAO,MAAM;;AACX,SAAAsD,MAAA,KAAK,SAAS,QAAd,gBAAAA,IAAmB,IAAI,WAAW;AAAA,MACxC;AAAA,IACA;AAAA,IAEE,WAAW,SAAS;;AAClB,WAAI,UAAK,SAAS,QAAd,mBAAmB,WAAW;AAChC,gBAAO;AAAA,MACb,YAAe,UAAK,SAAS,QAAd,mBAAmB,MAAM;AAClC,mBAAK,SAAS,QAAd,mBAAmB,KAAK,SAAS;AAAA,MACvC,OAAW;AACL,gBAAO;AAAA,MACb;AAAA,IACA;AAAA,IAEE,wBAAwB,WAAW,SAAS;;AAC1C,uBAAK,SAAS,gBAAd,mBAA2B,wBAA3B,mBAAgD,QAAQ,CAAC,gBAAgB;AACvE,oBAAY,GAAG,WAAW,OAAO;AAAA,MACvC;AAEI,iBAAK,SAAS,QAAd,mBAAmB,GAAG,wBAAwB;AAE9C,aAAO,MAAM;;AACX,SAAAA,MAAA,KAAK,SAAS,gBAAd,gBAAAA,IAA2B,oBAAoB,QAAQ,CAAC,gBAAgB;AACtE,sBAAY,IAAI,WAAW,OAAO;AAAA,QAC1C;AAEM,SAAAC,MAAA,KAAK,SAAS,QAAd,gBAAAA,IAAmB,IAAI,wBAAwB;AAAA,MACrD;AAEI,eAAS,qBAAqB,GAAG,aAAa;AAC5C,oBAAY,GAAG,WAAW,OAAO;AAAA,MACvC;AAAA,IACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOE,MAAM,SAAS,UAAU;;AACvB,iBAAK,SAAS,YAAd,mBAAuB,GAAG,SAAS;AAAA,IACvC;AAAA,IAEE,YAAY,SAAS,UAAU;;AAC7B,uBAAK,SAAS,YAAd,mBAAuB,WAAvB,4BAAgC,SAAS;AAAA,IAC7C;AAAA;AAAA;AAAA;AAAA;AAAA,IAME,QAAQ,KAAK,cAAc,QAAQ,OAAO;;AACxC,iBAAK,SAAS,UAAd,mBAAqB,aAAa,KAAK,MAAM;AAAA,IACjD;AAAA,IAEE,0BAA0B;AAAA,MACxB;AAAA,MACA,uBAAuB;AAAA,MACvB,cAAc,MAAA;;AAAM,iBAAC,UAAK,SAAS,YAAd,mBAAuB,cAAc;AAAA;AAAA,IAC9D,GAAK;AACD,iBAAW,WAAW,YAAW,EAAG,OAAO,OAAO,GAAG;AACnD,mBAAW,OAAO;AAAA,MACxB;AAEI,UAAI,sBAAsB;AACxB,aAAK,WAAW,mBAAmB,CAAC,YAAY;AAC9C,qBAAW,OAAO;AAAA,QAC1B,CAAO;AAAA,MACP;AAKI,eAAS,WAAW,SAAS;AAC3B,YAAI,OAAO,QAAQ,0BAA0B,YAAY;AACvD,kBAAQ,sBAAsB;AAAA,YAC5B;AAAA,YACA,IAAI;AAAA,YACJ,MAAM;AAAA,UAChB,CAAS;AAAA,QACT,OAAa;AACL,kBAAQ,YAAY,CAAC,GAAG,QAAQ,YAAW,GAAI,QAAQ,CAAC;AAAA,QAChE;AAAA,MACA;AAAA,IACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOE,QAAQ,SAAS,SAAS;;AACxB,uBAAK,SAAS,kBAAd,mBAA6B,oBAA7B,mBAA8C,QAAQ,CAAC,QAAQ;;AAC7D,cACED,MAAA,IAAI,gBAAJ,gBAAAA,IAAiB,mBAAkB,WAChCC,MAAA,IAAI,gBAAJ,gBAAAA,IAAiB,iBAAgB,OACpC;AACA,cAAI,YAAY,KAAK,SAAS,OAAO;AAAA,QAC7C;AAAA,MACA;AAAA,IACA;AAAA,IAEE,aAAa,OAAO,SAAS;;AAC3B,iBAAK,SAAS,WAAd,mBAAsB,aAAa,OAAO;AAAA,IAC9C;AAAA,EACA;AAEA,0BAAiB;;;;;;;;;ACrMjB,QAAI,WAAW,CAAA;AAEf,QAAI;AAEF,iBAAW,QAAQ,UAAU;AAAA,IAC/B,SAAS,GAAG;AAAA,IAEZ;AAEA,QAAI,SAAS,aAAa;AACxB,MAAAC,YAAW,QAAQ;AAAA,IACrB;AAEgC;AAC9B,uBAAiBA;AAAA,IACnB;AAMA,aAASA,YAAW,EAAE,eAAe,eAAe;AAClD,UAAI,CAAC,aAAa;AAChB;AAAA,MACJ;AAEE,kBAAY,GAAG,wBAAwB,CAAC,GAAG,YAAY;AACrD,eAAO,YAAY,EAAE,KAAK,WAAW,GAAG,QAAO,CAAE;AAAA,MACrD,CAAG;AAED,kBACG,OAAO,oBAAoB,EAAE,KAAK,aAAY,CAAE,EAEhD,MAAM,CAAC,MAAM,QAAQ,MAAM,IAAI;AAAA,QAC9B,4FAC0C,EAAE,OAAO;AAAA,MACzD,CAAK,CAAC;AAEJ,YAAM,cAAc;AAAA,QAClB,WAAW,SAAS;AAClB,cAAI;AACF,wBAAY,KAAK,oBAAoB,OAAO;AAAA,UACpD,SAAe,GAAG;AAEV,oBAAQ,MAAM,2BAA2B,GAAG,SAAS,OAAO;AAE5D,wBAAY,KAAK,oBAAoB;AAAA,cACnC,KAAK;AAAA,cACL,OAAO,EAAE,SAAS,uBAAG,SAAS,OAAO,uBAAG,MAAK;AAAA,cAC7C,WAAW;AAAA,YACrB,CAAS;AAAA,UACT;AAAA,QACA;AAAA,QAEI,OAAO,MAAM;AACX,sBAAY,WAAW,EAAE,MAAM,OAAO,OAAM,CAAE;AAAA,QACpD;AAAA;AAGE,iBAAW,SAAS,CAAC,SAAS,QAAQ,QAAQ,WAAW,SAAS,OAAO,GAAG;AAC1E,oBAAY,KAAK,IAAI,IAAI,SAAS,YAAY,WAAW;AAAA,UACvD;AAAA,UACA;AAAA,QACN,CAAK;AAAA,MACL;AAEE,UAAI,iBAAiB,QAAQ,iBAAiB;AAC5C,YAAI;AACF,wBAAc,kBAAkB,iBAAiB,WAAW;AAAA,QAClE,QAAY;AAAA,QAEZ;AAAA,MACA;AAEE,UAAI,OAAO,WAAW,UAAU;AAC9B,eAAO,gBAAgB;AAAA,MAC3B,OAAS;AAEL,wBAAgB;AAAA,MACpB;AAAA,IACA;AAAA;;;;;;;;AChFA,QAAM,KAAKlD;AACX,QAAML,MAAK;AACX,QAAMD,QAAOU;AACb,QAAM,sBAAsBC,0BAAA;AAE5B,MAAI,qBAAqB;AACzB,MAAI,wBAAwB;AAE5B,eAAiB;AAAA,IACf,WAAW;AAAA,MACT;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,SAAA8C,WAAU;AAAA,MACV,qBAAqB;AAAA,IACzB,GAAK;AACD,kBAAY,WAAW,MAAM;AAC3B,YAAI;AACF,cAAIA,UAAS;AACX,8BAAkB;AAAA,cAChB;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA,eAAeA;AAAA,YAC3B,CAAW;AAAA,UACX;AAEQ,cAAI,oBAAoB;AACtB,yCAA6B,EAAE,aAAa,QAAQ;AAAA,UAC9D;AAAA,QACA,SAAe,KAAK;AACZ,iBAAO,KAAK,GAAG;AAAA,QACvB;AAAA,MACA,CAAK;AAAA,IACL;AAAA;AAGA,WAAS,kBAAkB;AAAA,IACzB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,GAAG;AACD,QAAI,cAAc,OAAO,kBAAkB,WACvC,gBACA;AAEJ,QAAI,oBAAoB;AACtB,aAAO,KAAK,IAAI,MAAM,4CAA4C,EAAE,KAAK;AACzE;AAAA,IACJ;AAEE,yBAAqB;AAErB,QAAI;AACF,oBAAczD,MAAK;AAAA,QACjB;AAAA,QACA;AAAA;IAEN,QAAU;AAAA,IAEV;AAEE,QAAI,CAAC,eAAe,CAAC,GAAG,WAAW,WAAW,GAAG;AAC/C,oBAAcA,MAAK;AAAA,QACjB,YAAY,mBAAkB,KAAMC,IAAG,OAAM;AAAA,QAC7C;AAAA;AAEF,YAAM,cAAc;AAAA;AAAA,WAEb,oBAAoB,UAAU;AAAA;AAAA;AAAA;AAAA;AAKrC,SAAG,cAAc,aAAa,aAAa,MAAM;AAAA,IACrD;AAEE,gBAAY,0BAA0B;AAAA,MACpC,UAAU;AAAA,MACV;AAAA,MACA;AAAA,IACJ,CAAG;AAAA,EACH;AAEA,WAAS,6BAA6B,EAAE,aAAa,UAAU;AAC7D,QAAI,uBAAuB;AACzB,aAAO;AAAA,QACL,IAAI,MAAM,uDAAuD,EAAE;AAAA;AAErE;AAAA,IACJ;AAEE,4BAAwB;AAExB,UAAM,SAAS,CAAC,SAAS,QAAQ,QAAQ,OAAO;AAChD,gBAAY;AAAA,MACV;AAAA,MACA,CAAC,OAAO,OAAO,YAAY;AACzB,eAAO,eAAe;AAAA,UACpB,MAAM,CAAC,OAAO;AAAA,UACd,OAAO,OAAO,KAAK;AAAA,UACnB,WAAW,EAAE,aAAa,WAAU;AAAA,QAC5C,CAAO;AAAA,MACP;AAAA;EAEA;;;;;;;;AC7GA,UAAiB;AAEjB,WAAS,aAAa,QAAQ;AAC5B,WAAO,OAAO,iBAAiByD,QAAO;AAAA,MACpC,cAAc,EAAE,OAAO,IAAI,UAAU,KAAI;AAAA,MACzC,cAAc,EAAE,OAAO,MAAM,UAAU,KAAI;AAAA,MAC3C,gBAAgB,EAAE,OAAO,GAAG,UAAU,KAAI;AAAA,MAC1C,aAAa;AAAA,QACX,MAAM;AACJ,kBAAQ,OAAOA,OAAM,cAAY;AAAA,YAC/B,KAAK;AAAW,qBAAOA,OAAM,eAAeA,OAAM,iBAAiB;AAAA,YACnE,KAAK;AAAU,qBAAOA,OAAM;AAAA,YAC5B;AAAS,qBAAO;AAAA,UAC1B;AAAA,QACA;AAAA;IAEA,CAAG;AAED,aAASA,OAAM,OAAO;AACpB,MAAAA,OAAM,iBAAiB,KAAK,IAAIA,OAAM,gBAAgB,MAAM,MAAM;AAElE,YAAM,WAAW,CAAA;AACjB,iBAAW,SAAS,OAAO,QAAQ;AACjC,iBAAS,KAAK,IAAI,IAAI,MAAM,OAAO,QAAQ,GAAG,EAAE,OAAO,OAAO,MAAK,CAAE;AAAA,MAC3E;AACI,eAAS,MAAM,SAAS;AACxB,aAAO;AAAA,IACX;AAAA,EACA;;;;;;;;EC5BA,MAAM,UAAU;AAAA,IACd,YAAY,EAAE,kBAAkB;AAC9B,WAAK,iBAAiB;AACtB,WAAK,SAAS,CAAA;AACd,WAAK,UAAU;AAEf,WAAK,QAAQ,KAAK,MAAM,KAAK,IAAI;AACjC,WAAK,SAAS,KAAK,OAAO,KAAK,IAAI;AACnC,WAAK,SAAS,KAAK,OAAO,KAAK,IAAI;AAAA,IACvC;AAAA,IAEE,WAAW,SAAS;AAClB,WAAK,OAAO,KAAK,OAAO;AAAA,IAC5B;AAAA,IAEE,QAAQ;AACN,WAAK,UAAU,CAAA;AAAA,IACnB;AAAA,IAEE,SAAS;AACP,WAAK,UAAU;AACf,WAAK,OAAO,QAAQ,CAAC,SAAS,KAAK,eAAe,IAAI,CAAC;AACvD,WAAK,SAAS,CAAA;AAAA,IAClB;AAAA,IAEE,SAAS;AACP,WAAK,UAAU;AACf,WAAK,SAAS,CAAA;AAAA,IAClB;AAAA,EACA;AAEA,gBAAiB;;;;;;;;AC/BjB,QAAM,eAAepD,aAAA;AACrB,QAAM,YAAYG,iBAAA;AAUlB,QAAM,UAAN,MAAM,QAAO;AAAA,IAeX,YAAY;AAAA,MACV,oBAAoB;AAAA,MACpB,eAAe,CAAA;AAAA,MACf;AAAA,MACA;AAAA,MACA;AAAA,MACA,QAAQ;AAAA,MACR,SAAS,CAAC,SAAS,QAAQ,QAAQ,WAAW,SAAS,OAAO;AAAA,MAC9D;AAAA,MACA,qBAAqB,CAAA;AAAA,MACrB;AAAA,QACE,IAAI;AAvBR,0CAAe,CAAA;AACf,0CAAe;AACf,yCAAc;AACd,uCAAY,CAAA;AACZ,mCAAQ,CAAA;AACR,mCAAQ;AACR,oCAAS;AACT,mCAAQ;AACR,mCAAQ;AACR,wCAAa,CAAA;AACb,uCAAY,CAAA;AAcV,WAAK,WAAW,KAAK,SAAS,KAAK,IAAI;AACvC,WAAK,SAAS,KAAK,OAAO,KAAK,IAAI;AACnC,WAAK,aAAa,KAAK,WAAW,KAAK,IAAI;AAC3C,WAAK,UAAU,KAAK,QAAQ,KAAK,IAAI;AACrC,WAAK,iBAAiB,KAAK,eAAe,KAAK,IAAI;AAEnD,WAAK,oBAAoB;AACzB,WAAK,YAAY,IAAI,UAAU,IAAI;AACnC,WAAK,eAAe;AACpB,WAAK,eAAe;AACpB,WAAK,QAAQ;AACb,WAAK,SAAS;AACd,WAAK,QAAQ;AACb,WAAK,QAAQ,aAAa,IAAI;AAC9B,WAAK,qBAAqB;AAC1B,WAAK,YAAY,aAAa,CAAA;AAE9B,iBAAW,QAAQ,KAAK,QAAQ;AAC9B,aAAK,SAAS,MAAM,KAAK;AAAA,MAC/B;AACI,WAAK,MAAM,KAAK;AAChB,WAAK,UAAU,MAAM,KAAK;AAE1B,WAAK,eAAe;AACpB,mDAAc,WAAW,EAAE,GAAG,cAAc,OAAO,KAAK;AAExD,WAAK,cAAc;AACnB,iDAAa,WAAW,EAAE,GAAG,cAAc,QAAQ,KAAI;AAEvD,iBAAW,CAAC,MAAM,OAAO,KAAK,OAAO,QAAQ,kBAAkB,GAAG;AAChE,aAAK,WAAW,IAAI,IAAI,QAAQ,MAAM,YAAY;AAAA,MACxD;AAEI,cAAO,UAAU,KAAK,IAAI;AAAA,IAC9B;AAAA,IAEE,OAAO,YAAY,EAAE,SAAS;AAC5B,aAAO,KAAK,UAAU,KAAK,KAAK,KAAK,UAAU;AAAA,IACnD;AAAA,IAEE,SAAS,OAAO,QAAQ,KAAK,OAAO,QAAQ;AAC1C,UAAI,UAAU,OAAO;AACnB,aAAK,OAAO,OAAO,OAAO,GAAG,KAAK;AAAA,MACxC;AAEI,WAAK,KAAK,IAAI,IAAI,SAAS,KAAK,QAAQ,MAAM,EAAE,OAAO;AACvD,WAAK,UAAU,KAAK,IAAI,KAAK,KAAK;AAAA,IACtC;AAAA,IAEE,YAAYL,UAAS;AACnB,WAAK;AAAA,QACH;AAAA,UACE,MAAM,CAAC,6DAA6D;AAAA,UACpE,OAAO;AAAA;QAET,EAAE,YAAY,CAAC,SAAS,EAAC;AAAA;AAE3B,aAAO,KAAK,aAAa,cAAcA,QAAO;AAAA,IAClD;AAAA,IAEE,OAAOA,UAAS;AACd,UAAI,OAAOA,aAAY,UAAU;AAC/B,QAAAA,WAAU,EAAE,OAAOA,SAAO;AAAA,MAChC;AAEI,aAAO,IAAI,QAAO;AAAA,QAChB,cAAc,KAAK;AAAA,QACnB,cAAc,KAAK;AAAA,QACnB,cAAc,KAAK;AAAA,QACnB,OAAO,KAAK;AAAA,QACZ,oBAAoB,KAAK;AAAA,QACzB,WAAW,EAAE,GAAG,KAAK,UAAS;AAAA,QAC9B,GAAGA;AAAA,MACT,CAAK;AAAA,IACL;AAAA,IAEE,cAAc,WAAW,YAAY,SAAS,KAAK,QAAQ;AACzD,YAAM,OAAO,OAAO,QAAQ,SAAS;AACrC,YAAM,QAAQ,OAAO,QAAQ,UAAU;AAEvC,UAAI,UAAU,MAAM,SAAS,IAAI;AAC/B,eAAO;AAAA,MACb;AAEI,aAAO,SAAS;AAAA,IACpB;AAAA,IAEE,WAAWA,WAAU,IAAI;AACvB,WAAK,aAAa,EAAE,QAAQ,MAAM,GAAG,KAAK,cAAc,GAAGA,UAAS;AAAA,IACxE;AAAA,IAEE,QAAQ,MAAMA,WAAU,IAAI;AAC1B,UAAI,KAAK,UAAU,SAAS;AAC1B,aAAK,UAAU,WAAW,EAAE,MAAM,MAAM,oBAAI,KAAI,GAAI,GAAGA,UAAS;AAAA,MACtE,OAAW;AACL,aAAK,eAAe,EAAE,MAAM,GAAGA,SAAO,CAAE;AAAA,MAC9C;AAAA,IACA;AAAA,IAEE,eAAe,SAAS,EAAE,aAAa,KAAK,WAAU,IAAK,IAAI;AAC7D,UAAI,QAAQ,QAAQ,gBAAgB;AAClC,aAAK,aAAa,OAAO,QAAQ,OAAO;AAAA,UACtC,WAAW,QAAQ;AAAA,UACnB,aAAa;AAAA,UACb,YAAY,QAAQ,QAAQ,UAAU;AAAA,QAC9C,CAAO;AACD;AAAA,MACN;AAEI,UAAI,QAAQ,QAAQ;AACpB,UAAI,CAAC,KAAK,mBAAmB;AAC3B,gBAAQ,KAAK,OAAO,SAAS,QAAQ,KAAK,IAAI,QAAQ,QAAQ;AAAA,MACpE;AAEI,YAAM,oBAAoB;AAAA,QACxB,MAAM,oBAAI,KAAI;AAAA,QACd,OAAO,KAAK;AAAA,QACZ,GAAG;AAAA,QACH;AAAA,QACA,WAAW;AAAA,UACT,GAAG,KAAK;AAAA,UACR,GAAG,QAAQ;AAAA;;AAIf,iBAAW,CAAC,WAAW,OAAO,KAAK,KAAK,iBAAiB,UAAU,GAAG;AACpE,YAAI,OAAO,YAAY,cAAc,QAAQ,UAAU,OAAO;AAC5D;AAAA,QACR;AAEM,YAAI,CAAC,KAAK,cAAc,QAAQ,OAAO,QAAQ,KAAK,GAAG;AACrD;AAAA,QACR;AAEM,YAAI;AAEF,gBAAM,iBAAiB,KAAK,MAAM,OAAO,CAAC,KAAK,SAAS;AACtD,mBAAO,MAAM,KAAK,KAAK,SAAS,SAAS,IAAI;AAAA,UACvD,GAAW,iBAAiB;AAEpB,cAAI,gBAAgB;AAClB,oBAAQ,EAAE,GAAG,gBAAgB,MAAM,CAAC,GAAG,eAAe,IAAI,GAAG;AAAA,UACvE;AAAA,QACA,SAAe,GAAG;AACV,eAAK,uBAAuB,CAAC;AAAA,QACrC;AAAA,MACA;AAAA,IACA;AAAA,IAEE,uBAAuB,IAAI;AAAA,IAE7B;AAAA,IAEE,iBAAiB,aAAa,KAAK,YAAY;AAC7C,YAAM,iBAAiB,MAAM,QAAQ,UAAU,IAC3C,aACA,OAAO,QAAQ,UAAU;AAE7B,aAAO,eACJ,IAAI,CAAC,SAAS;AACb,gBAAQ,OAAO,MAAI;AAAA,UACjB,KAAK;AACH,mBAAO,KAAK,WAAW,IAAI,IAAI,CAAC,MAAM,KAAK,WAAW,IAAI,CAAC,IAAI;AAAA,UACjE,KAAK;AACH,mBAAO,CAAC,KAAK,MAAM,IAAI;AAAA,UACzB;AACE,mBAAO,MAAM,QAAQ,IAAI,IAAI,OAAO;AAAA,QAChD;AAAA,MACA,CAAO,EACA,OAAO,OAAO;AAAA,IACrB;AAAA,EACA;AArME,gBADI,SACG,aAAY,CAAA;AADrB,MAAM,SAAN;AAwMA,aAAiB;;;;;;;;ECnNjB,MAAM,aAAa;AAAA,IAOjB,YAAY;AAAA,MACV;AAAA,MACA,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,aAAa;AAAA,QACX,IAAI;AAXR;AACA,sCAAW;AACX;AACA;AACA,wCAAa;AAQX,WAAK,cAAc,KAAK,YAAY,KAAK,IAAI;AAC7C,WAAK,cAAc,KAAK,YAAY,KAAK,IAAI;AAC7C,WAAK,kBAAkB,KAAK,gBAAgB,KAAK,IAAI;AACrD,WAAK,WAAW,EAAE,aAAa,OAAO,SAAS,YAAY;AAC3D,WAAK,gBAAgB,KAAK,cAAc,KAAK,IAAI;AACjD,WAAK,eAAe,KAAK,aAAa,KAAK,IAAI;AAAA,IACnD;AAAA,IAEE,OAAO,OAAO;AAAA,MACZ,QAAQ,KAAK;AAAA,MACb,UAAU,KAAK;AAAA,MACf,cAAc;AAAA,MACd,aAAa,KAAK;AAAA,MAClB,YAAY;AAAA,QACV,IAAI;;AACN,cAAQ,eAAe,KAAK;AAE5B,UAAI;AACF,YAAI,OAAO,YAAY,YAAY;AACjC,gBAAM,aAAW,UAAK,gBAAL,mBAAkB,kBAAiB,CAAA;AACpD,gBAAM,cAAc,KAAK;AACzB,gBAAM,SAAS,QAAQ;AAAA,YACrB;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACV,CAAS;AACD,cAAI,WAAW,OAAO;AACpB;AAAA,UACV;AAAA,QACA;AAEM,oBAAY,MAAM,WAAW,KAAK,IAAI,MAAM,KAAK;AAEjD,YAAI,cAAc,CAAC,UAAU,SAAS,WAAW,KAAK,KAAK,aAAa;AACtE,eAAK,YAAY;AAAA,YACf,sCAAsC,WAAW;AAAA,YACjD,MAAM;AAAA;QAEhB;AAAA,MACA,QAAY;AACN,gBAAQ,MAAM,KAAK;AAAA,MACzB;AAAA,IACA;AAAA,IAEE,WAAW,EAAE,aAAa,OAAO,SAAS,WAAU,GAAI;AACtD,UAAI,OAAO,gBAAgB,UAAU;AACnC,aAAK,cAAc;AAAA,MACzB;AAEI,UAAI,OAAO,UAAU,YAAY;AAC/B,aAAK,QAAQ;AAAA,MACnB;AAEI,UAAI,OAAO,YAAY,YAAY;AACjC,aAAK,UAAU;AAAA,MACrB;AAEI,UAAI,OAAO,eAAe,WAAW;AACnC,aAAK,aAAa;AAAA,MACxB;AAAA,IACA;AAAA,IAEE,cAAc,EAAE,SAAS,WAAU,IAAK,CAAA,GAAI;AAC1C,UAAI,KAAK,UAAU;AACjB;AAAA,MACN;AAEI,WAAK,WAAW;AAChB,WAAK,WAAW,EAAE,SAAS,WAAU,CAAE;AACvC,cAAQ,GAAG,qBAAqB,KAAK,WAAW;AAChD,cAAQ,GAAG,sBAAsB,KAAK,eAAe;AAAA,IACzD;AAAA,IAEE,eAAe;AACb,WAAK,WAAW;AAChB,cAAQ,eAAe,qBAAqB,KAAK,WAAW;AAC5D,cAAQ,eAAe,sBAAsB,KAAK,eAAe;AAAA,IACrE;AAAA,IAEE,YAAY,SAAS,aAAa;;AAChC,iBAAK,gBAAL,mBAAkB;AAAA,QAChB,GAAG,OAAO,IAAI,IAAI,gBAAgB,WAAW,EAAE,SAAQ,CAAE;AAAA;AAAA,IAE/D;AAAA,IAEE,YAAY,OAAO;AACjB,WAAK,OAAO,OAAO,EAAE,WAAW,YAAW,CAAE;AAAA,IACjD;AAAA,IAEE,gBAAgB,QAAQ;AACtB,YAAM,QAAQ,kBAAkB,QAC5B,SACA,IAAI,MAAM,KAAK,UAAU,MAAM,CAAC;AACpC,WAAK,OAAO,OAAO,EAAE,WAAW,sBAAqB,CAAE;AAAA,IAC3D;AAAA,EACA;AAEA,WAAS,eAAe,GAAG;AACzB,QAAI,aAAa,OAAO;AACtB,aAAO;AAAA,IACX;AAEE,QAAI,KAAK,OAAO,MAAM,UAAU;AAC9B,UAAI,EAAE,SAAS;AACb,eAAO,OAAO,OAAO,IAAI,MAAM,EAAE,OAAO,GAAG,CAAC;AAAA,MAClD;AACI,UAAI;AACF,eAAO,IAAI,MAAM,KAAK,UAAU,CAAC,CAAC;AAAA,MACxC,SAAa,QAAQ;AACf,eAAO,IAAI,MAAM,4BAA4B,OAAO,CAAC,CAAC,KAAK,MAAM,EAAE;AAAA,MACzE;AAAA,IACA;AAEE,WAAO,IAAI,MAAM,yBAAyB,OAAO,CAAC,CAAC,EAAE;AAAA,EACvD;AAEA,mBAAiB;;;;;;;;ECnIjB,MAAM,YAAY;AAAA,IAiFhB,YAAYA,WAAU,IAAI;AAhF1B,uCAAY,CAAA;AACZ,oCAAS;AACT,wCAAa;AAAA,QACX,KAAK;AAAA,UACH,qBAAqB,CAAC,EAAE,WAAW;AACjC,mBAAO,KAAK,cAAc,KAAK,MAAM,GAAG,CAAC,GAAG;AAAA,cAC1C;AAAA,cACA;AAAA,cACA;AAAA,YACV,CAAS;AAAA,UACT;AAAA,UACM,sBAAsB,CAAC,EAAE,WAAW;AAClC,mBAAO,KAAK,WAAW,IAAI,KAAK,CAAC,IAAI;AAAA,UAC7C;AAAA,UACM,uBAAuB,CAAC,EAAE,MAAM,CAAC,aAAa,OAAO,EAAC,MAAO;AAC3D,mBAAO,WAAW,OAAO,YAAY,WACjC,EAAE,GAAG,SAAS,GAAG,KAAK,sBAAsB,WAAW,EAAC,IACxD,CAAA;AAAA,UACZ;AAAA;QAGI,aAAa;AAAA,UACX,mBAAmB,CAAC,EAAE,MAAM,CAAC,OAAO,SAAS,MAAM,QAAQ,QAAQ;AAEjE,gBAAI,QAAQ,GAAG;AACb,qBAAO;AAAA,YACjB;AAEQ,mBAAO,EAAE,SAAS,QAAQ,GAAG,QAAQ,IAAI,IAAI,GAAE;AAAA,UACvD;AAAA,UACM,iBAAiB,CAAC,EAAE,WAAW;AAC7B,mBAAO,KAAK,cAAc,MAAM;AAAA,cAC9B;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,YACV,CAAS;AAAA,UACT;AAAA,UACM,6BAA6B,CAAC,EAAE,WAAW;AACzC,mBAAO,KAAK,cAAc,MAAM;AAAA,cAC9B;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,YACV,CAAS;AAAA,UACT;AAAA,UACM,kBAAkB,CAAC,EAAE,WAAW;AAC9B,mBAAO,KAAK,cAAc,MAAM,CAAC,QAAQ,SAAS,CAAC;AAAA,UAC3D;AAAA,UACM,iBAAiB,CAAC,EAAE,WAAW;AAC7B,mBAAO,KAAK,cAAc,MAAM,CAAC,eAAe,OAAO,CAAC;AAAA,UAChE;AAAA;;AAIE,oCAAS;AAAA,QACP,KAAK;AAAA,UACH,qBAAqB;AAAA,UACrB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA;QAGzB,aAAa;AAAA;AAAA,UAEX,iBAAiB;AAAA,UACjB,6BAA6B;AAAA,UAC7B,kBAAkB;AAAA,UAClB,iBAAiB;AAAA,UACjB,gBAAgB;AAAA;;AAIpB;AACA,mCAAQ;AACR,mCAAQ;AAGN,WAAK,WAAWA,QAAO;AAAA,IAC3B;AAAA,IAEE,WAAW;AAAA,MACT;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,QAAAc;AAAA,MACA;AAAA,MACA,OAAAwC;AAAA,IACJ,GAAK;AACD,UAAI,OAAO,WAAW,UAAU;AAC9B,aAAK,SAAS;AAAA,MACpB;AAEI,UAAI,OAAO,gBAAgB,UAAU;AACnC,aAAK,cAAc;AAAA,MACzB;AAEI,UAAI,OAAO,UAAU,UAAU;AAC7B,aAAK,QAAQ;AAAA,MACnB;AAEI,UAAI,OAAO,WAAW,UAAU;AAC9B,aAAK,SAAS;AAAA,MACpB;AAEI,UAAI,OAAOxC,YAAW,YAAY,OAAOA,YAAW,YAAY;AAC9D,aAAK,SAASA;AAAA,MACpB;AAEI,UAAI,OAAO,eAAe,UAAU;AAClC,aAAK,aAAa;AAAA,MACxB;AAEI,UAAI,OAAOwC,WAAU,UAAU;AAC7B,aAAK,QAAQA;AAAA,MACnB;AAAA,IACA;AAAA,IAEE,aAAatD,WAAU,IAAI;AACzB,WAAK,WAAWA,QAAO;AAEvB,WAAK,iBAAgB;AAErB,iBAAW,aAAa,KAAK,cAAc,KAAK,OAAO,GAAG,GAAG;AAC3D,aAAK,UAAU;AAAA,UACb,KAAK,YAAY,WAAW,WAAW,IAAI,gBAAgB;AACzD,iBAAK,YAAY,EAAE,aAAa,OAAO,WAAW,aAAa;AAAA,UACzE,CAAS;AAAA;MAET;AAEI,iBAAW,aAAa,KAAK,cAAc,KAAK,OAAO,WAAW,GAAG;AACnE,aAAK,UAAU;AAAA,UACb,KAAK,YAAY;AAAA,YACf;AAAA,YACA,IAAI,gBAAgB;AAClB,mBAAK;AAAA,gBACH,EAAE,aAAa,eAAe,WAAW,YAAW;AAAA;YAElE;AAAA;;MAGA;AAAA,IACA;AAAA,IAEE,cAAc;AACZ,WAAK,iBAAgB;AAAA,IACzB;AAAA,IAEE,cAAc,OAAO,YAAY;AAC/B,YAAM,MAAM,CAAA;AAEZ,iBAAW,QAAQ,CAAC,WAAW,UAAU;AACvC,YAAI,SAAS,IAAI,MAAM,KAAK;AAAA,MAClC,CAAK;AAED,UAAI,MAAM,SAAS,WAAW,QAAQ;AACpC,YAAI,cAAc,MAAM,MAAM,WAAW,MAAM;AAAA,MACrD;AAEI,aAAO;AAAA,IACX;AAAA,IAEE,mBAAmB;AACjB,WAAK,UAAU,QAAQ,CAAC,aAAa,SAAQ,CAAE;AAC/C,WAAK,YAAY,CAAA;AAAA,IACrB;AAAA,IAEE,eAAe,EAAE,WAAW,aAAa,YAAW,GAAI;;AACtD,YAAM,CAAC,OAAO,GAAG,IAAI,IAAI;AACzB,UAAI,OAAO,KAAK,WAAW,YAAY;AACrC,eAAO,KAAK,OAAO,EAAE,MAAM,OAAO,WAAW,aAAa;AAAA,MAChE;AAEI,YAAM,aAAY,UAAK,WAAW,WAAW,MAA3B,mBAA+B;AACjD,UAAI,gBAAgB;AACpB,UAAI,OAAO,cAAc,YAAY;AACnC,wBAAgB,UAAU,EAAE,MAAM,OAAO,WAAW,aAAa;AAAA,MACvE;AAEI,UAAI,CAAC,eAAe;AAClB,eAAO;AAAA,MACb;AAEI,YAAM,YAAY,CAAA;AAElB,UAAI,MAAM,QAAQ,aAAa,GAAG;AAChC,kBAAU,OAAO;AAAA,MACvB,WAAe,OAAO,kBAAkB,UAAU;AAC5C,eAAO,OAAO,WAAW,aAAa;AAAA,MAC5C;AAEI,UAAI,gBAAgB,eAAe;AACjC,eAAO,OAAO,WAAW,KAAK,sBAAsB,+BAAO,MAAM,CAAC;AAAA,MACxE;AAEI,YAAM,QAAQ,KAAK,OAChB,QAAQ,iBAAiB,gBAAgB,QAAQ,QAAQ,aAAa,EACtE,QAAQ,eAAe,SAAS;AAEnC,aAAO,CAAC,OAAO,SAAS;AAAA,IAC5B;AAAA,IAEE,cAAc,UAAU;AACtB,UAAI,CAAC,YAAY,OAAO,aAAa,UAAU;AAC7C,eAAO,CAAA;AAAA,MACb;AAEI,aAAO,OAAO,QAAQ,QAAQ,EAC3B,OAAO,CAAC,CAAC,GAAG,MAAM,MAAM,MAAM,EAC9B,IAAI,CAAC,CAAC,SAAS,MAAM,SAAS;AAAA,IACrC;AAAA,IAEE,sBAAsB,aAAa;AACjC,UAAI,EAAC,2CAAa,UAAS;AACzB,eAAO,CAAA;AAAA,MACb;AAEI,UAAI;AACF,eAAO;AAAA,UACL,aAAa;AAAA,YACX,IAAI,YAAY;AAAA,YAChB,KAAK,YAAY,OAAM;AAAA;;MAGjC,QAAY;AACN,eAAO,CAAA;AAAA,MACb;AAAA,IACA;AAAA,IAEE,YAAY,EAAE,WAAW,aAAa,YAAW,GAAI;;AACnD,YAAMuD,OAAM,KAAK,eAAe,EAAE,WAAW,aAAa,aAAa;AACvE,UAAIA,MAAK;AACP,cAAM,SAAS,KAAK,QAAQ,KAAK,OAAO,MAAM,KAAK,KAAK,IAAI,KAAK;AACjE,+CAAS,KAAK,WAAd,gCAAuB,GAAGA;AAAA,MAChC;AAAA,IACA;AAAA,EACA;AAEA,kBAAiB;;;;;;;;ACpPjB,gBAAiB,EAAE,UAAS;AAE5B,WAAS,UAAU;AAAA,IACjB;AAAA,IACA;AAAA,IACA;AAAA,IAEA,eAAc,mCAAS,SAAQ,CAAA;AAAA,IAC/B,aAAa,uCAAW;AAAA,EAC1B,GAAG;AACD,WAAO,WAAW,OAAO,CAAC,MAAM,UAAU;AACxC,UAAI,OAAO,UAAU,YAAY;AAC/B,eAAO,MAAM,EAAE,MAAM,QAAQ,SAAS,UAAS,CAAE;AAAA,MACvD;AAEI,aAAO;AAAA,IACX,GAAK,WAAW;AAAA,EAChB;;;;;;;;ACjBA,QAAM,EAAE,UAAS,IAAKrD,iBAAA;AAEtB,WAAiB;AAAA,IACf;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IAEA,OAAO,EAAE,SAAS,QAAQ,WAAW,OAAO,mCAAS,QAAQ;AAC3D,cAAQ,OAAO,UAAU,QAAM;AAAA,QAC7B,KAAK,UAAU;AACb,iBAAO,UAAU;AAAA,YACf;AAAA,YACA;AAAA,YACA,YAAY,CAAC,iBAAiB,aAAa,UAAU;AAAA,YACrD;AAAA,YACA,aAAa,CAAC,UAAU,QAAQ,GAAG,IAAI;AAAA,UACjD,CAAS;AAAA,QACT;AAAA,QAEM,KAAK,YAAY;AACf,iBAAO,UAAU,OAAO;AAAA,YACtB;AAAA,YACA,QAAO,mCAAS,UAAS;AAAA,YACzB;AAAA,YACA;AAAA,YACA;AAAA,UACV,CAAS;AAAA,QACT;AAAA,QAEM,SAAS;AACP,iBAAO;AAAA,QACf;AAAA,MACA;AAAA,IACA;AAAA;AAWA,WAAS,0BAA0B,EAAE,QAAQ;AAC3C,QAAI,OAAO,KAAK,CAAC,MAAM,YAAY,OAAO,KAAK,CAAC,MAAM,UAAU;AAC9D,aAAO;AAAA,IACX;AAEE,QAAI,KAAK,CAAC,EAAE,MAAM,aAAa,GAAG;AAChC,aAAO;AAAA,IACX;AAEE,WAAO,CAAC,GAAG,KAAK,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,IAAI,GAAG,KAAK,MAAM,CAAC,CAAC;AAAA,EACnD;AAEA,WAAS,mBAAmB,eAAe;AACzC,UAAM,kBAAkB,KAAK,IAAI,aAAa;AAC9C,UAAM,OAAO,gBAAgB,IAAI,MAAM;AACvC,UAAM,QAAQ,KAAK,MAAM,kBAAkB,EAAE,EAAE,WAAW,SAAS,GAAG,GAAG;AACzE,UAAM,WAAW,kBAAkB,IAAI,SAAQ,EAAG,SAAS,GAAG,GAAG;AACjE,WAAO,GAAG,IAAI,GAAG,KAAK,IAAI,OAAO;AAAA,EACnC;AAEA,WAAS,YAAY,EAAE,MAAM,QAAQ,QAAO,GAAI;AAC9C,UAAM,EAAE,cAAc,YAAW,KAAK,iCAAQ,UAAS,CAAA;AACvD,UAAM,WAAW,KAAK,CAAC;AACvB,QAAI,QAAQ,QAAQ;AAEpB,QAAI,CAAC,OAAO;AACV,cAAQ;AAAA,IACZ;AAEE,QAAI;AACJ,QAAI,UAAU,IAAI;AAChB,kBAAY,cAAc,IAAI,GAAG,OAAO,cAAc,CAAC,IAAI;AAAA,IAC/D,WAAa,OAAO,UAAU,UAAU;AACpC,kBAAY,KAAK,KAAK,IAAI,OAAO,cAAc,CAAC;AAAA,IACpD,OAAS;AACL,kBAAY;AAAA,IAChB;AAEE,SAAK,CAAC,IAAI,SAAS,QAAQ,WAAW,SAAS;AAC/C,WAAO;AAAA,EACT;AAEA,WAAS,gBAAgB,EAAE,MAAM,WAAW;AAC1C,QAAI,WAAW,KAAK,CAAC;AACrB,QAAI,OAAO,aAAa,UAAU;AAChC,aAAO;AAAA,IACX;AAGE,eAAW,SAAS,QAAQ,YAAY,GAAG,QAAQ,KAAK,IAAI,OAAO,GAAG,GAAG,CAAC;AAE1E,UAAM,OAAO,QAAQ,QAAQ,oBAAI,KAAI;AACrC,SAAK,CAAC,IAAI,SACP,QAAQ,aAAa,CAAC,WAAW,SAAS;;AACzC,cAAQ,MAAI;AAAA,QACV,KAAK;AAAS,iBAAO,QAAQ,SAAS;AAAA,QACtC,KAAK;AAAS,iBAAO,QAAQ;AAAA,QAE7B,KAAK;AAAK,iBAAO,KAAK,YAAW,EAAG,SAAS,EAAE;AAAA,QAC/C,KAAK;AAAK,kBAAQ,KAAK,SAAQ,IAAK,GAAG,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG;AAAA,QACnE,KAAK;AAAK,iBAAO,KAAK,QAAO,EAAG,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG;AAAA,QAC5D,KAAK;AAAK,iBAAO,KAAK,SAAQ,EAAG,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG;AAAA,QAC7D,KAAK;AAAK,iBAAO,KAAK,WAAU,EAAG,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG;AAAA,QAC/D,KAAK;AAAK,iBAAO,KAAK,WAAU,EAAG,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG;AAAA,QAC/D,KAAK;AAAM,iBAAO,KAAK,gBAAe,EAAG,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG;AAAA,QACrE,KAAK;AAAK,iBAAO,mBAAmB,KAAK,kBAAiB,CAAE;AAAA,QAC5D,KAAK;AAAO,iBAAO,KAAK,YAAW;AAAA,QAEnC,SAAS;AACP,mBAAO,aAAQ,cAAR,mBAAoB,UAAS;AAAA,QAC9C;AAAA,MACA;AAAA,IACA,CAAK,EACA,KAAI;AAEP,WAAO;AAAA,EACT;AAEA,WAAS,WAAW,EAAE,QAAQ;AAC5B,UAAM,WAAW,KAAK,CAAC;AACvB,QAAI,OAAO,aAAa,UAAU;AAChC,aAAO;AAAA,IACX;AAEE,UAAM,kBAAkB,SAAS,YAAY,QAAQ;AACrD,QAAI,oBAAoB,SAAS,SAAS,GAAG;AAC3C,WAAK,CAAC,IAAI,SAAS,QAAQ,aAAa,EAAE;AAC1C,UAAI,KAAK,CAAC,MAAM,IAAI;AAClB,aAAK,MAAK;AAAA,MAChB;AAEI,aAAO;AAAA,IACX;AAEE,UAAM,iBAAiB,SAAS,MAAM,QAAQ;AAC9C,QAAI,SAAS,CAAA;AAEb,QAAI,eAAe,CAAC,MAAM,IAAI;AAC5B,aAAO,KAAK,eAAe,CAAC,CAAC;AAAA,IACjC;AAEE,aAAS,OAAO,OAAO,KAAK,MAAM,CAAC,CAAC;AAEpC,QAAI,eAAe,CAAC,MAAM,IAAI;AAC5B,aAAO,KAAK,eAAe,CAAC,CAAC;AAAA,IACjC;AAEE,WAAO;AAAA,EACT;;;;;;;;;AC1JA,UAAM,OAAOA;AAEb,WAAA,UAAiB;AAAA,MACf;AAAA,MAEA,SAAS,EAAE,MAAM,WAAW,SAAQ,uCAAW,UAAS,KAAK;AAC3D,YAAI,CAAC,MAAM;AACT,iBAAO;AAAA,QACb;AAEI,YAAI,QAAQ,GAAG;AACb,cAAI,MAAM,QAAQ,IAAI,EAAG,QAAO;AAChC,cAAI,OAAO,SAAS,YAAY,KAAM,QAAO;AAE7C,iBAAO;AAAA,QACb;AAEI,YAAI,MAAM,QAAQ,IAAI,GAAG;AACvB,iBAAO,KAAK,IAAI,CAAC,UAAU,OAAO,QAAQ,SAAS;AAAA,YACjD,MAAM;AAAA,YACN,OAAO,QAAQ;AAAA,UACvB,CAAO,CAAC;AAAA,QACR;AAEI,YAAI,OAAO,SAAS,UAAU;AAC5B,iBAAO;AAAA,QACb;AAEI,YAAI,QAAQ,OAAO,KAAK,gBAAgB,YAAY;AAClD,iBAAO;AAAA,QACb;AAGI,YAAI,SAAS,MAAM;AACjB,iBAAO;AAAA,QACb;AAEI,YAAI,gBAAgB,OAAO;AACzB,iBAAO;AAAA,QACb;AAEI,cAAM,UAAU,CAAA;AAChB,mBAAW,KAAK,MAAM;AACpB,cAAI,CAAC,OAAO,UAAU,eAAe,KAAK,MAAM,CAAC,EAAG;AACpD,kBAAQ,CAAC,IAAI,OAAO,QAAQ,SAAS;AAAA,YACnC,MAAM,KAAK,CAAC;AAAA,YACZ,OAAO,QAAQ;AAAA,UACvB,CAAO;AAAA,QACP;AAEI,eAAO;AAAA,MACX;AAAA,MAEE,OAAO,EAAE,QAAQ;AACf,eAAO,KAAK,MAAM,KAAK,UAAU,MAAM,iBAAgB,CAAE,CAAC;AAAA,MAC9D;AAAA,MAEE,SAAS,EAAE,MAAM,aAAa;AAC5B,cAAM,kBAAiB,uCAAW,mBAAkB,CAAA;AAEpD,cAAM,iBAAiB,KAAK,IAAI,CAAC,SAAS;AACxC,cAAI,SAAS,QAAW;AACtB,mBAAO;AAAA,UACf;AAEM,cAAI;AACF,kBAAM,MAAM,KAAK,UAAU,MAAM,iBAAgB,GAAI,IAAI;AACzD,mBAAO,QAAQ,SAAY,SAAY,KAAK,MAAM,GAAG;AAAA,UAC7D,SAAe,GAAG;AAGV,mBAAO;AAAA,UACf;AAAA,QACA,CAAK;AAED,eAAO,KAAK,kBAAkB,gBAAgB,GAAG,cAAc;AAAA,MACnE;AAAA;AAQA,aAAS,iBAAiBF,WAAU,IAAI;AACtC,YAAM,OAAO,oBAAI,QAAO;AAExB,aAAO,SAAU,KAAK,OAAO;AAC3B,YAAI,OAAO,UAAU,YAAY,UAAU,MAAM;AAC/C,cAAI,KAAK,IAAI,KAAK,GAAG;AACnB,mBAAO;AAAA,UACf;AAEM,eAAK,IAAI,KAAK;AAAA,QACpB;AAEI,eAAO,UAAU,KAAK,OAAOA,QAAO;AAAA,MACxC;AAAA,IACA;AAQA,aAAS,UAAU,KAAK,OAAOA,WAAU,CAAA,GAAI;AAC3C,YAAM,sBAAqBA,YAAA,gBAAAA,SAAS,wBAAuB;AAE3D,UAAI,iBAAiB,OAAO;AAC1B,eAAO,MAAM;AAAA,MACjB;AAEE,UAAI,CAAC,OAAO;AACV,eAAO;AAAA,MACX;AAEE,UAAI,OAAO,UAAU,YAAY;AAC/B,eAAO,cAAc,MAAM,SAAQ,CAAE;AAAA,MACzC;AAEE,UAAI,iBAAiB,MAAM;AACzB,eAAO,MAAM,YAAW;AAAA,MAC5B;AAEE,UAAI,sBAAsB,iBAAiB,OAAO,OAAO,aAAa;AACpE,eAAO,OAAO,YAAY,KAAK;AAAA,MACnC;AAEE,UAAI,sBAAsB,iBAAiB,OAAO,MAAM,MAAM;AAC5D,eAAO,MAAM,KAAK,KAAK;AAAA,MAC3B;AAEE,aAAO;AAAA,IACT;AAAA;;;;;;;;ACtIA,UAAiB;AAAA,IACf;AAAA,IAEA,gBAAgB,EAAE,QAAQ;AACxB,aAAO,gBAAgB,MAAM,aAAa,cAAc;AAAA,IAC5D;AAAA,IAEE,aAAa,EAAE,QAAQ;AACrB,aAAO,gBAAgB,MAAM,MAAM,EAAE;AAAA,IACzC;AAAA;AAGA,QAAM,cAAc;AAAA,IAClB,OAAO;AAAA,IACP,OAAO;AAAA,IACP,KAAK;AAAA,IACL,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,SAAS;AAAA,IACT,MAAM;AAAA,IACN,OAAO;AAAA,IACP,MAAM;AAAA;AAGR,WAAS,YAAYwD,QAAO;AAC1B,UAAM,QAAQA,OAAM,QAAQ,oBAAoB,IAAI,EAAE,YAAW;AACjE,WAAO,YAAY,KAAK,KAAK;AAAA,EAC/B;AAEA,WAAS,eAAe,QAAQ;AAC9B,WAAO,SAAS,YAAY;AAAA,EAC9B;AAEA,WAAS,gBAAgB,MAAM,cAAc,gBAAgB;AAC3D,UAAM,cAAc,CAAA;AAEpB,WAAO,KAAK,OAAO,CAAC,QAAQ,MAAM,OAAO,UAAU;AACjD,UAAI,YAAY,KAAK,GAAG;AACtB,eAAO;AAAA,MACb;AAEI,UAAI,OAAO,SAAS,UAAU;AAC5B,YAAI,aAAa;AACjB,YAAI,eAAe;AAEnB,eAAO,KAAK,QAAQ,gBAAgB,CAAC,UAAU;AAC7C,wBAAc;AAEd,cAAI,UAAU,MAAM;AAClB,mBAAO;AAAA,UACjB;AAEQ,gBAAMA,SAAQ,MAAM,UAAU;AAC9B,cAAI,OAAOA,WAAU,UAAU;AAC7B,wBAAY,UAAU,IAAI;AAC1B,2BAAe;AACf,mBAAO,aAAaA,QAAO,IAAI;AAAA,UACzC;AAEQ,iBAAO;AAAA,QACf,CAAO;AAED,YAAI,gBAAgB,gBAAgB;AAClC,iBAAO,eAAe,IAAI;AAAA,QAClC;AAAA,MACA;AAEI,aAAO,KAAK,IAAI;AAChB,aAAO;AAAA,IACX,GAAK,CAAA,CAAE;AAAA,EACP;;;;;;;;ACrEA,QAAM;AAAA,IACJ;AAAA,IACA,QAAA1C;AAAA,EACF,IAAIZ,cAAA;AACJ,QAAM,EAAE,UAAU,OAAA,IAAWG,cAAA;AAC7B,QAAM;AAAA,IACJ;AAAA,IACA;AAAA,EACF,IAAIC,aAAA;AACJ,QAAM,EAAE,UAAA,IAAcC,iBAAA;AAEtB,QAAM,iBAAiB;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,MAAM,QAAQ;AAAA,IACd,MAAM,QAAQ;AAAA,IACd,SAAS,QAAQ;AAAA,IACjB,OAAO,QAAQ;AAAA,IACf,OAAO,QAAQ;AAAA,IACf,KAAK,QAAQ;AAAA;AAGf,cAAiB;AAEjB,QAAM,YAAY,QAAQ,aAAa,UAAU,MAAM;AACvD,QAAM,iBAAiB,+BAA+B,SAAS;AAE/D,SAAO,OAAO,yBAAyB;AAAA,IACrC;AAAA,EACF,CAAC;AAED,WAAS,wBAAwB,QAAQ;AACvC,WAAO,OAAO,OAAO,WAAW;AAAA,MAC9B,UAAU;AAAA,QACR,OAAO;AAAA,QACP,MAAM;AAAA,QACN,MAAM;AAAA,QACN,SAAS;AAAA,QACT,OAAO;AAAA,QACP,OAAO;AAAA,QACP,SAAS;AAAA;MAEX,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,YAAY;AAAA,QACV;AAAA,QACAO;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA;MAEF,WAAW,QAAA,IAAY;AAAA,MAEvB,QAAQ,EAAE,WAAW;AACnB,cAAM,eAAe,eAAe,QAAQ,KAAK,KAAK,eAAe;AACrE,qBAAa,GAAG,QAAQ,IAAI;AAAA,MAAA;AAAA,IAC9B,CACD;AAED,aAAS,UAAU,SAAS;AAC1B,YAAM,OAAO,UAAU,EAAE,QAAQ,SAAS,WAAW;AACrD,gBAAU,QAAQ;AAAA,QAChB,SAAS,EAAE,GAAG,SAAS,KAAA;AAAA,MAAK,CAC7B;AAAA,IAAA;AAAA,EAEL;AAEA,WAAS,kBAAkB,EAAE,MAAM,SAAS,aAAa;AACvD,QACE,OAAO,UAAU,WAAW,YACzB,CAAC,UAAU,OAAO,SAAS,IAAI,GAClC;AACA,aAAO;AAAA,IAAA;AAGT,WAAO;AAAA,MACL,SAAS,aAAa,QAAQ,OAAO,SAAS,CAAC;AAAA,MAC/C;AAAA,MACA,GAAG;AAAA;EAEP;AAEA,WAAS,aAAa,eAAe,OAAO;AAC1C,QAAI,OAAO,kBAAkB,WAAW;AACtC,aAAO;AAAA,IAAA;AAGT,UAAM,YAAY,UAAU,WAAW,UAAU;AACjD,UAAMmB,UAAS,YAAY,QAAQ,SAAS,QAAQ;AACpD,WAAOA,WAAUA,QAAO;AAAA,EAC1B;AAEA,WAAS,aAAa,MAAM;AAC1B,UAAM,EAAE,SAAS,UAAA,IAAc;AAC/B,UAAM,YAAY,aAAa,UAAU,WAAW,QAAQ,KAAK;AACjE,UAAM,gBAAgB,YAAY,kBAAkB;AACpD,WAAO,cAAc,IAAI;AAAA,EAC3B;AAEA,WAAS,aAAa,OAAO,WAAW;AACtC,WAAO,UAAU,SAAS,KAAK,KAAK,UAAU,SAAS;AAAA,EACzD;;;;;;;;ACvGA,QAAMjB,gBAAed;AACrB,QAAM,KAAKG;AACX,QAAMR,MAAKS;AAAAA,EAEX,MAAM,aAAaU,cAAa;AAAA,IAS9B,YAAY;AAAA,MACV,MAAApB;AAAA,MACA,eAAe,EAAE,UAAU,QAAQ,MAAM,KAAK,MAAM,IAAK;AAAA,MACzD,aAAa;AAAA,IACjB,GAAK;AACD,YAAK;AAbP,6CAAkB,CAAA;AAClB,0CAAe;AACf,mDAAwB;AACxB,kCAAO;AACP;AACA,0CAAe;AACf,wCAAa;AASX,WAAK,OAAOA;AACZ,WAAK,eAAe;AACpB,WAAK,aAAa;AAAA,IACtB;AAAA,IAEE,IAAI,OAAO;AACT,aAAO,KAAK,QAAO;AAAA,IACvB;AAAA,IAEE,QAAQ;AACN,UAAI;AACF,WAAG,cAAc,KAAK,MAAM,IAAI;AAAA,UAC9B,MAAM,KAAK,aAAa;AAAA,UACxB,MAAM;AAAA,QACd,CAAO;AACD,aAAK,MAAK;AACV,eAAO;AAAA,MACb,SAAa,GAAG;AACV,YAAI,EAAE,SAAS,UAAU;AACvB,iBAAO;AAAA,QACf;AAEM,aAAK,KAAK,SAAS,GAAG,IAAI;AAC1B,eAAO;AAAA,MACb;AAAA,IACA;AAAA,IAEE,KAAK,YAAY;AACf,UAAI;AACF,cAAM,UAAU,oBAAoB,KAAK,MAAM,cAAc,IAAI;AACjE,aAAK,MAAK;AACV,aAAK,UAAU,gBAAgBC,IAAG,GAAG,GAAG,OAAO,EAAE;AAAA,MACvD,SAAa,GAAG;AACV,aAAK;AAAA,UACH;AAAA,UACA,IAAI,MAAM,sBAAsB,KAAK,IAAI,KAAK,EAAE,OAAO,EAAE;AAAA,UACzD;AAAA;MAER;AAAA,IACA;AAAA,IAEE,UAAU;AACR,UAAI,KAAK,gBAAgB,QAAW;AAClC,YAAI;AACF,gBAAM,QAAQ,GAAG,SAAS,KAAK,IAAI;AACnC,eAAK,cAAc,MAAM;AAAA,QACjC,SAAe,GAAG;AACV,eAAK,cAAc;AAAA,QAC3B;AAAA,MACA;AAEI,aAAO,KAAK,cAAc,KAAK;AAAA,IACnC;AAAA,IAEE,4BAA4B,MAAM;AAChC,WAAK,gBAAgB,OAAO,WAAW,MAAM,KAAK,aAAa,QAAQ;AAAA,IAC3E;AAAA,IAEE,SAAS;AACP,aAAO;AAAA,IACX;AAAA,IAEE,iBAAiB;AACf,YAAM4D,QAAO;AAEb,UAAI,KAAK,yBAAyB,KAAK,gBAAgB,WAAW,GAAG;AACnE;AAAA,MACN;AAEI,YAAM,OAAO,KAAK,gBAAgB,KAAK,EAAE;AACzC,WAAK,kBAAkB,CAAA;AACvB,WAAK,wBAAwB;AAE7B,SAAG,UAAU,KAAK,MAAM,MAAM,KAAK,cAAc,CAAC,MAAM;AACtD,QAAAA,MAAK,wBAAwB;AAE7B,YAAI,GAAG;AACL,UAAAA,MAAK;AAAA,YACH;AAAA,YACA,IAAI,MAAM,qBAAqBA,MAAK,IAAI,KAAK,EAAE,OAAO,EAAE;AAAA,YACxD;AAAA;QAEV,OAAa;AACL,UAAAA,MAAK,4BAA4B,IAAI;AAAA,QAC7C;AAEM,QAAAA,MAAK,eAAc;AAAA,MACzB,CAAK;AAAA,IACL;AAAA,IAEE,QAAQ;AACN,WAAK,cAAc;AACnB,WAAK,eAAe;AAAA,IACxB;AAAA,IAEE,WAAW;AACT,aAAO,KAAK;AAAA,IAChB;AAAA,IAEE,UAAU,MAAM;AACd,cAAQ5D,IAAG;AAEX,UAAI,KAAK,YAAY;AACnB,aAAK,gBAAgB,KAAK,IAAI;AAC9B,aAAK,eAAc;AACnB;AAAA,MACN;AAEI,UAAI;AACF,WAAG,cAAc,KAAK,MAAM,MAAM,KAAK,YAAY;AACnD,aAAK,4BAA4B,IAAI;AAAA,MAC3C,SAAa,GAAG;AACV,aAAK;AAAA,UACH;AAAA,UACA,IAAI,MAAM,qBAAqB,KAAK,IAAI,KAAK,EAAE,OAAO,EAAE;AAAA,UACxD;AAAA;MAER;AAAA,IACA;AAAA,EACA;AAEA,WAAiB;AAEjB,WAAS,oBAAoB,UAAU,YAAY;AACjD,UAAM,SAAS,OAAO,MAAM,UAAU;AACtC,UAAM,QAAQ,GAAG,SAAS,QAAQ;AAElC,UAAM,aAAa,KAAK,IAAI,MAAM,MAAM,UAAU;AAClD,UAAM,SAAS,KAAK,IAAI,GAAG,MAAM,OAAO,UAAU;AAElD,UAAM,KAAK,GAAG,SAAS,UAAU,GAAG;AACpC,UAAM,aAAa,GAAG,SAAS,IAAI,QAAQ,GAAG,YAAY,MAAM;AAChE,OAAG,UAAU,EAAE;AAEf,WAAO,OAAO,SAAS,QAAQ,GAAG,UAAU;AAAA,EAC9C;;;;;;;;AC3JA,QAAM,OAAOK,cAAA;AAAA,EAEb,MAAM,iBAAiB,KAAK;AAAA,IAC1B,QAAQ;AAAA,IAEV;AAAA,IAEE,OAAO;AAAA,IAET;AAAA,IAEE,UAAU;AACR,aAAO;AAAA,IACX;AAAA,IAEE,SAAS;AACP,aAAO;AAAA,IACX;AAAA,IAEE,YAAY;AAAA,IAEd;AAAA,EACA;AAEA,eAAiB;;;;;;;;ACxBjB,QAAMc,gBAAed;AACrB,QAAM,KAAKG;AACX,QAAMT,QAAOU;AACb,QAAM,OAAOC,cAAA;AACb,QAAM,WAAWI,gBAAA;AAAA,EAEjB,MAAM,qBAAqBK,cAAa;AAAA,IAGtC,cAAc;AACZ,YAAK;AAHP,mCAAQ,CAAA;AAIN,WAAK,YAAY,KAAK,UAAU,KAAK,IAAI;AAAA,IAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IASE,QAAQ,EAAE,UAAU,eAAe,CAAA,GAAI,aAAa,SAAS;AAC3D,UAAIyC;AACJ,UAAI;AACF,mBAAW7D,MAAK,QAAQ,QAAQ;AAEhC,YAAI,KAAK,MAAM,QAAQ,GAAG;AACxB,iBAAO,KAAK,MAAM,QAAQ;AAAA,QAClC;AAEM,QAAA6D,QAAO,KAAK,WAAW,EAAE,UAAU,cAAc,YAAY;AAAA,MACnE,SAAa,GAAG;AACV,QAAAA,QAAO,IAAI,SAAS,EAAE,MAAM,SAAQ,CAAE;AACtC,aAAK,UAAU,GAAGA,KAAI;AAAA,MAC5B;AAEI,MAAAA,MAAK,GAAG,SAAS,KAAK,SAAS;AAC/B,WAAK,MAAM,QAAQ,IAAIA;AACvB,aAAOA;AAAA,IACX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IASE,WAAW,EAAE,UAAU,cAAc,WAAU,GAAI;AACjD,WAAK,gBAAgB,EAAE,UAAU,aAAY,CAAE;AAC/C,aAAO,IAAI,KAAK,EAAE,MAAM,UAAU,cAAc,YAAY;AAAA,IAChE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOE,UAAU,OAAOA,OAAM;AACrB,WAAK,KAAK,SAAS,OAAOA,KAAI;AAAA,IAClC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOE,gBAAgB,EAAE,UAAU,gBAAgB;AAC1C,SAAG,UAAU7D,MAAK,QAAQ,QAAQ,GAAG,EAAE,WAAW,MAAM;AACxD,SAAG,cAAc,UAAU,IAAI,EAAE,MAAM,KAAK,MAAM,aAAa,MAAM;AAAA,IACzE;AAAA,EACA;AAEA,mBAAiB;;;;;;;;ACzEjB,QAAM,KAAKM;AACX,QAAML,MAAK;AACX,QAAMD,QAAOU;AACb,QAAM,eAAeC,oBAAA;AACrB,QAAM,EAAE,UAAS,IAAKI,iBAAA;AACtB,QAAM,EAAE,aAAY,IAAKC,aAAA;AACzB,QAAM;AAAA,IACJ,QAAAE;AAAA,IACA;AAAA,EACF,IAAII,cAAA;AACJ,QAAM,EAAE,SAAQ,IAAKkB,cAAA;AAErB,SAAiB;AAGjB,QAAM,iBAAiB,IAAI,aAAY;AAEvC,WAAS,qBACP,QACA,EAAE,WAAW,gBAAgB,YAAW,IAAK,CAAA,GAC7C;AAEA,QAAI;AAEJ,QAAI,SAAS,cAAc,OAAO,IAAI,GAAG;AACvC,eAAS,GAAG,SAAS,CAAC,GAAGqB,UAAS;AAChC,mBAAW,kBAAkBA,KAAI,IAAI,CAAC;AAAA,MAC5C,CAAK;AAAA,IACL;AAEE,WAAO,OAAO,OAAO,WAAW;AAAA,MAC9B,UAAU,mBAAmB,OAAO,UAAU,WAAW;AAAA,MACzD,QAAQ;AAAA,MACR;AAAA,MACA,gBAAgB,EAAE,OAAO,EAAC;AAAA,MAC1B,OAAO;AAAA,MACP,SAAS,QAAQ;AAAA,MACjB;AAAA,MACA,MAAM;AAAA,MACN,YAAY,CAAC,cAAc3C,SAAQ,2BAA2B,QAAQ;AAAA,MACtE,cAAc,EAAE,MAAM,KAAK,MAAM,KAAO,UAAU,OAAM;AAAA,MAExD,aAAa2C,OAAM;AACjB,cAAM,UAAUA,MAAK,SAAQ;AAC7B,cAAM,MAAM7D,MAAK,MAAM,OAAO;AAC9B,YAAI;AACF,aAAG,WAAW,SAASA,MAAK,KAAK,IAAI,KAAK,GAAG,IAAI,IAAI,OAAO,IAAI,GAAG,EAAE,CAAC;AAAA,QAC9E,SAAe,GAAG;AACV,qBAAW,wBAAwB,CAAC;AACpC,gBAAM,mBAAmB,KAAK,MAAM,UAAU,UAAU,CAAC;AACzD,UAAA6D,MAAK,KAAK,KAAK,IAAI,kBAAkB,MAAM,IAAI,CAAC;AAAA,QACxD;AAAA,MACA;AAAA,MAEI,cAAc,MAAM;AAClB,eAAO7D,MAAK,KAAK,KAAK,mBAAmB,KAAK,QAAQ;AAAA,MAC5D;AAAA,MAEI,WAAW,MAAM;AACf,eAAO,aAAa,YAAY,WAAW,IAAI;AAAA,MACrD;AAAA,IACA,CAAG;AAED,aAAS,UAAU,SAAS;AAC1B,YAAM6D,QAAO,QAAQ,OAAO;AAE5B,YAAM,kBAAkB,UAAU,UAAU,KACvCA,MAAK,OAAO,UAAU;AAE3B,UAAI,iBAAiB;AACnB,kBAAU,aAAaA,KAAI;AAC3B,QAAAA,MAAK,MAAK;AAAA,MAChB;AAEI,YAAM,UAAU,UAAU,EAAE,QAAQ,SAAS,UAAS,CAAE;AACxD,MAAAA,MAAK,UAAU,OAAO;AAAA,IAC1B;AAEE,aAAS,0BAA0B;AACjC,UAAI,eAAe;AACjB;AAAA,MACN;AAGI,sBAAgB,OAAO;AAAA,QACrB,OAAO;AAAA,QACP;AAAA,UACE,GAAG,OAAO;AAAA,YACR,YAAY,iBAAgB;AAAA;UAE9B,UAAU;AAAA,YACR,MAAM;AACJ,qBAAO,UAAU;AAAA,YAC7B;AAAA,YACU,YAAY;AAAA;;;AAKlB,UAAI,OAAO,UAAU,eAAe,YAAY;AAC9C,kBAAU,eAAe,UAAU;AACnC,mBAAW,oDAAoD;AAAA,MACrE;AAEI,UAAI,OAAO,UAAU,gBAAgB,YAAY;AAC/C,kBAAU,gBAAgB,UAAU;AACpC,mBAAW,sDAAsD;AAAA,MACvE;AAAA,IACA;AAEE,aAAS,WAAW,SAAS,QAAQ,MAAM,QAAQ,SAAS;AAC1D,YAAM,OAAO,CAAC,iCAAiC,OAAO,EAAE;AAExD,UAAI,OAAO;AACT,aAAK,KAAK,KAAK;AAAA,MACrB;AAEI,aAAO,WAAW,QAAQ,EAAE,MAAM,MAAM,oBAAI,QAAQ,OAAO;AAAA,IAC/D;AAEE,aAAS,QAAQ,KAAK;AACpB,8BAAuB;AAEvB,YAAM,WAAW,UAAU,cAAc,eAAe,GAAG;AAC3D,aAAO,SAAS,QAAQ;AAAA,QACtB;AAAA,QACA,YAAY,CAAC,UAAU;AAAA,QACvB,cAAc,UAAU;AAAA,MAC9B,CAAK;AAAA,IACL;AAEE,aAAS,YAAY,EAAE,aAAa,CAAC,MAAM,EAAE,SAAS,MAAM,EAAC,IAAK,IAAI;AACpE,8BAAuB;AACvB,YAAM,WAAW7D,MAAK,QAAQ,UAAU,cAAc,aAAa,CAAC;AAEpE,UAAI,CAAC,GAAG,WAAW,QAAQ,GAAG;AAC5B,eAAO,CAAA;AAAA,MACb;AAEI,aAAO,GAAG,YAAY,QAAQ,EAC3B,IAAI,CAAC,aAAaA,MAAK,KAAK,UAAU,QAAQ,CAAC,EAC/C,OAAO,UAAU,EACjB,IAAI,CAAC,YAAY;AAChB,YAAI;AACF,iBAAO;AAAA,YACL,MAAM;AAAA,YACN,OAAO,GAAG,aAAa,SAAS,MAAM,EAAE,MAAMC,IAAG,GAAG;AAAA;QAEhE,QAAgB;AACN,iBAAO;AAAA,QACjB;AAAA,MACA,CAAO,EACA,OAAO,OAAO;AAAA,IACrB;AAAA,EACA;AAEA,WAAS,mBAAmB,cAAc,QAAQ,MAAM;AACtD,YAAQ,aAAW;AAAA,MACjB,KAAK;AAAY,eAAO;AAAA,MACxB,KAAK;AAAU,eAAO;AAAA,MACtB;AAAS,eAAO;AAAA,IACpB;AAAA,EACA;;;;;;;;AClKA,QAAM,EAAE,UAAU,OAAM,IAAKK,cAAA;AAC7B,QAAM,EAAE,UAAS,IAAKG,iBAAA;AAEtB,QAAiB;AAOjB,WAAS,oBAAoB,QAAQ,EAAE,eAAe;AACpD,WAAO,OAAO,WAAW;AAAA,MACvB,OAAO;AAAA,MACP,SAAS;AAAA,MACT,OAAO,OAAO,QAAQ,UAAU;AAAA,MAChC,YAAY,CAAC,QAAQ,QAAQ;AAAA,IACjC,CAAG;AAED,YAAO,2CAAa,gBAAe,YAAY;AAE/C,aAAS,UAAU,SAAS;;AAC1B,YAAI,wCAAS,cAAT,mBAAoB,iBAAgB,YAAY;AAClD;AAAA,MACN;AAEI,iDAAa,QAAQ,UAAU,SAAS;AAAA,QACtC,GAAG;AAAA,QACH,MAAM,UAAU,EAAE,QAAQ,SAAS,UAAS,CAAE;AAAA,MACpD;AAAA,IACA;AAAA,EACA;;;;;;;;AC9BA,QAAM,OAAOH;AACb,QAAM,QAAQG;AACd,QAAM,EAAE,UAAS,IAAKC,iBAAA;AACtB,QAAM,EAAE,aAAY,IAAKC,aAAA;AACzB,QAAM,EAAE,QAAQ,SAAQ,IAAKI,cAAA;AAE7B,WAAiB;AAEjB,WAAS,uBAAuB,QAAQ;AACtC,WAAO,OAAO,OAAO,WAAW;AAAA,MAC9B,QAAQ,EAAE,MAAM,uBAAsB;AAAA,MACtC,OAAO;AAAA,MACP,OAAO;AAAA,MACP,gBAAgB,CAAA;AAAA,MAChB,YAAY,CAAC,cAAc,QAAQ,QAAQ;AAAA,MAE3C,WAAW,EAAE,WAAW;AACtB,eAAO,KAAK,UAAU;AAAA,UACpB,QAAQ,UAAU;AAAA,UAClB,MAAM,QAAQ;AAAA,UACd,MAAM,QAAQ,KAAK,QAAO;AAAA,UAC1B,OAAO,QAAQ;AAAA,UACf,OAAO,QAAQ;AAAA,UACf,WAAW,QAAQ;AAAA,QAC3B,CAAO;AAAA,MACP;AAAA,MAEI,eAAe,EAAE,SAAS;AACxB,eAAO;AAAA,UACL;AAAA,YACE,MAAM,CAAC,4BAA4B,UAAU,GAAG,IAAI,KAAK;AAAA,YACzD,OAAO;AAAA;UAET,EAAE,YAAY,CAAC,WAAW,MAAM,EAAC;AAAA;MAEzC;AAAA,MAEI,cAAc,EAAE,WAAW,gBAAgB,KAAI,GAAI;AACjD,cAAM,gBAAgB,UAAU,WAAW,QAAQ,IAAI,QAAQ;AAE/D,cAAM,UAAU,cAAc,QAAQ,WAAW;AAAA,UAC/C,QAAQ;AAAA,UACR,GAAG;AAAA,UACH,SAAS;AAAA,YACP,gBAAgB;AAAA,YAChB,kBAAkB,KAAK;AAAA,YACvB,GAAG,eAAe;AAAA;QAE5B,CAAO;AAED,gBAAQ,MAAM,IAAI;AAClB,gBAAQ,IAAG;AAEX,eAAO;AAAA,MACb;AAAA,IACA,CAAG;AAED,aAAS,UAAU,SAAS;AAC1B,UAAI,CAAC,UAAU,KAAK;AAClB;AAAA,MACN;AAEI,YAAM,OAAO,UAAU,WAAW;AAAA,QAChC;AAAA,QACA,SAAS,EAAE,GAAG,SAAS,MAAM,UAAU,EAAE,QAAQ,SAAS,UAAS,CAAE,EAAC;AAAA,QACtE;AAAA,MACN,CAAK;AAED,YAAM,UAAU,UAAU,cAAc;AAAA,QACtC,WAAW,UAAU;AAAA,QACrB,gBAAgB,UAAU;AAAA,QAC1B,MAAM,OAAO,KAAK,MAAM,MAAM;AAAA,MACpC,CAAK;AAED,cAAQ,GAAG,SAAS,CAAC,UAAU,UAAU,eAAe;AAAA,QACtD;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACN,CAAK,CAAC;AAAA,IACN;AAAA,EACA;;;;;;;;AClFA,QAAM,SAAST,cAAA;AACf,QAAM,eAAeG,oBAAA;AACrB,QAAM,cAAcC,mBAAA;AACpB,QAAM,mBAAmBC,eAAA;AACzB,QAAM,gBAAgBI,YAAA;AACtB,QAAM,eAAeC,WAAA;AACrB,QAAM,kBAAkBM,cAAA;AAExB,0BAAiB;AAEjB,WAAS,oBAAoB,EAAE,cAAc,gBAAgB;;AAC3D,UAAM,gBAAgB,IAAI,OAAO;AAAA,MAC/B;AAAA,MACA,cAAc,IAAI,aAAY;AAAA,MAC9B,aAAa,IAAI,YAAW;AAAA,MAC5B;AAAA,MACA,QAAO,kBAAa,gBAAb,mBAA0B;AAAA,MACjC,OAAO;AAAA,MACP,oBAAoB;AAAA,QAClB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,KAAK;AAAA,QACL,QAAQ;AAAA;MAEV,WAAW;AAAA,QACT,aAAa;AAAA;IAEnB,CAAG;AAED,kBAAc,UAAU;AACxB,kBAAc,SAAS;AAEvB,kBAAc,yBAAyB,CAAC,MAAM;AAC5C,oBAAc,WAAW,QAAQ,QAAQ;AAAA,QACvC,SAAS;AAAA,UACP,MAAM,CAAC,gCAAgC,CAAC;AAAA,UACxC,OAAO;AAAA;MAEf,CAAK;AAAA,IACL;AAEE,WAAO;AAAA,EACT;;;;;;;;AC1CA,QAAM,WAAWhB;AACjB,QAAM,sBAAsBG,2BAAA;AAC5B,QAAM,EAAE,YAAA+C,YAAU,IAAK9C,kBAAA;AACvB,QAAM,sBAAsBC,2BAAA;AAE5B,QAAM,cAAc,IAAI,oBAAoB,EAAE,SAAQ,CAAE;AACxD,QAAM,gBAAgB,oBAAoB;AAAA,IACxC,cAAc,EAAE,YAAW;AAAA,IAC3B,cAAc6C;AAAA,EAChB,CAAC;AAED,SAAiB;AAEjB,cAAY,MAAM,oBAAoB,CAAC,GAAG,YAAY;AACpD,QAAI,QAAQ,OAAO;AACjB,oBAAc,OAAO,YAAY,OAAO,EAAE,MAAM,QAAQ,KAAK;AAAA,IACjE;AAEE,UAAM,OAAO,IAAI,KAAK,QAAQ,IAAI;AAClC,mBAAe;AAAA,MACb,GAAG;AAAA,MACH,MAAM,KAAK,QAAO,IAAK,OAAO,oBAAI,KAAI;AAAA,IAC1C,CAAG;AAAA,EACH,CAAC;AAED,cAAY,YAAY,oBAAoB,CAAC,GAAG,EAAE,MAAM,IAAI,YAAY;AACtE,YAAQ,KAAG;AAAA,MACT,KAAK,cAAc;AACjB,cAAM,SAAS,cAAc,OAAO,YAAY,EAAE,MAAK,CAAE;AACzD,eAAO;AAAA,UACL,QAAQ,OAAO;AAAA,UACf;AAAA;MAER;AAAA,MAEI,SAAS;AACP,uBAAe,EAAE,MAAM,CAAC,gBAAgB,GAAG,GAAG,GAAG,OAAO,SAAS;AACjE,eAAO,CAAA;AAAA,MACb;AAAA,IACA;AAAA,EACA,CAAC;AAED,WAAS,eAAe,SAAS;;AAC/B,wBAAc,OAAO,YAAY,OAAO,MAAxC,mBAA2C,eAAe;AAAA,EAC5D;;;;;;;;AC5CA,QAAMM,QAAOxD,cAAA;AAEb,WAAiBwD;;;;;ACAjB,MAAM,OAAO;AAEN,SAAS,iBAAiB5D,MAAoB;AACnD,QAAM,SAAS,aAAa,OAAO,KAAsB,QAAwB;AAE/E,QAAI,UAAU,+BAA+B,GAAG;AAChD,QAAI,UAAU,gCAAgC,eAAe;AAC7D,QAAI,UAAU,gCAAgC,cAAc;AAE5D,QAAI,IAAI,WAAW,WAAW;AAC5B,UAAI,UAAU,GAAG;AACjB,UAAI,IAAA;AACJ;AAAA,IACF;AAEA,QAAI,IAAI,QAAQ,WAAW,IAAI,WAAW,QAAQ;AAChD,UAAI,OAAO;AACX,UAAI,GAAG,QAAQ,CAAA,UAAS,QAAQ,MAAM,UAAU;AAChD,UAAI,GAAG,OAAO,YAAY;AACxB,YAAI;AACF,gBAAM,EAAE,QAAA,IAAY,KAAK,MAAM,IAAI;AACnC,kBAAQ,IAAI,uCAAuC,OAAO,EAAE;AAG5D,gBAAM,QAAQ,MAAM,kBAAkBA,MAAK,OAAO;AAClD,kBAAQ;AAGR,cAAI,UAAU,KAAK,EAAE,gBAAgB,oBAAoB;AACzD,cAAI,IAAI,KAAK,UAAU,EAAE,MAAA,CAAO,CAAC;AAAA,QACnC,SAAS,GAAQ;AACf,kBAAQ,MAAM,CAAC;AACf,cAAI,UAAU,GAAG;AACjB,cAAI,IAAI,KAAK,UAAU,EAAE,OAAO,EAAE,WAAW,iBAAA,CAAkB,CAAC;AAAA,QAClE;AAAA,MACF,CAAC;AAAA,IACH,OAAO;AACL,UAAI,UAAU,GAAG;AACjB,UAAI,IAAI,WAAW;AAAA,IACrB;AAAA,EACF,CAAC;AAED,SAAO,OAAO,MAAM,aAAa,MAAM;AACrC,YAAQ,IAAI,yDAAyD,IAAI,EAAE;AAAA,EAC7E,CAAC;AAED,SAAO;AACT;AAEA,SAAS,kBAAkBA,MAAoB,SAAkC;AAC/E,SAAO,IAAI,QAAQ,CAAC,YAAY;AAE9B,IAAAA,KAAI,YAAY,KAAK,yBAAyB,OAAO;AAGrD,YAAQ,KAAK,0BAA0B,CAAC,QAAQ,UAAU;AACxD,cAAQ,KAAK;AAAA,IACf,CAAC;AAGD,eAAW,MAAM;AAAA,IAGjB,GAAG,GAAK;AAAA,EACV,CAAC;AACH;ACjDA,IAAI,WAAA;AACJ,IAAI,WAAW,KAAK,gBAAgB,MAAM,KAAK,KAAK,QAAQ,mBAAmB;AAC/E,OAAO,OAAO,SAAS,IAAI,SAAS;AAEpC,WAAA;AAGA,IAAI,GAAG,QAAA,EAAU,WAAW,KAAK;AAC/B,MAAI,4BAAA;AAGN,IAAI,QAAQ,aAAa;AACvB,MAAI,kBAAkB,IAAI,SAAS;AAGrC,IAAI,CAAC,IAAI,6BAA6B;AACpC,MAAI,KAAA;AACJ,UAAQ,KAAK,CAAC;AAChB,OAAO;AACL,MAAI,GAAG,mBAAmB,CAAC,OAAO,gBAAgB;AAChD,QAAI,KAAK;AACP,UAAI,IAAI,eAAe;AACrB,YAAI,QAAA;AAAA,MACN;AACA,UAAI,MAAA;AAAA,IACN;AAEA,oBAAgB,KAAK,YAAY,IAAA,KAAS,EAAE;AAAA,EAC9C,CAAC;AACH;AAEA,IAAI,GAAG,YAAY,CAAC,OAAO,QAAQ;AACjC,kBAAgB,KAAK,GAAG;AAC1B,CAAC;AAGD,IAAI,QAAQ,YAAY;AACtB,MAAI,QAAQ,KAAK,UAAU,GAAG;AAC5B,QAAI,2BAA2B,QAAQ,QAAQ,UAAU,CAAC,KAAK,QAAQ,QAAQ,KAAK,CAAC,CAAC,CAAC,CAAC;AAAA,EAC1F;AACF,OAAO;AACL,MAAI,2BAA2B,MAAM;AACvC;AAEA,IAAI,MAA4B;AAChC,MAAM,UAAU,KAAK,KAAKH,aAAW,sBAAsB;AAC3D,MAAM,YAAY,KAAK,KAAK,eAAe,YAAY;AAEvD,eAAe,UAAU;AACvB,MAAI,QAAQ,aAAa,SAAS;AAChC,eAAW,QAAQ,UAAU;AAAA,EAC/B,OAAO;AACL,YAAA,IAAY,OAAO,MAAM,kBAAA,EAAoB,MAAM,MAAM,YAAY,IAAI;AAAA,EAC3E;AAEA,MAAI,QAAQ,aAAa,UAAU;AACjC,mBAAe,QAAQ,UAAU;AAAA,EACnC;AAEA,wBAAA;AACA,eAAA;AACA,eAAA;AACA,gBAAc,GAAI;AAgBlB,YAAU,YAAY,SAAS,MAAM;AACnC,QAAK,YAAY,KAAK,WAAW;AAAA,EACnC,CAAC;AAED,YAAU,YAAY,UAAU,MAAM;AACpC,QAAK,YAAY,KAAK,YAAY;AAAA,EACpC,CAAC;AAED,YAAU,0BAA0B,CAAC,YAAY;AAC/C,QAAI,qBAAqB;AACvB,cAAQ,IAAI,6BAA6B,OAAO;AAAA,IAClD;AAEA,YAAQ,QAAQ,MAAA;AAAA,MACd,KAAK;AAAA,MACL,KAAK;AACH,sBAAA;AACA;AAAA,IACF;AAAA,EAEJ,CAAC;AACH;AAEA,eAAsB,eAAe;AACnC,QAAM,IAAI,cAAc;AAAA,IACtB,OAAO;AAAA,IACP,MAAM,KAAK,KAAK,QAAA,IAAY,aAAa,aAAa;AAAA,IACtD,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,WAAW;AAAA,IACX,UAAU;AAAA,IACV,gBAAgB;AAAA,MACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAA;AAAA,EAOF,CACD;AAGD,MAAI,qBAAqB;AACvB,QAAI,QAAQ,mBAAmB;AAE/B,QAAI,YAAY,aAAA;AAAA,EAClB,OAAO;AACL,QAAI,QAAQ,IAAI;AAChB,QAAI,SAAS,SAAS;AAAA,EACxB;AAGA,mBAAiB,GAAG;AAGpB,MAAI,YAAY,GAAG,mBAAmB,MAAM;AAC1C,+BAAK,YAAY,KAAK,6CAA4B,KAAA,GAAO;EAC3D,CAAC;AAGD,MAAI,YAAY,qBAAqB,CAAC,EAAE,UAAU;AAChD,QAAI,IAAI,WAAW,QAAQ;AACzB,YAAM,aAAa,GAAG;AAExB,WAAO,EAAE,QAAQ,OAAA;AAAA,EACnB,CAAC;AAED,MAAI,GAAG,SAAS,CAAC,UAAU;AACzB,QAAI,CAAC4C,WAAS,YAAY;AACxB,YAAM,eAAA;AACN,iCAAK;AACL,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT,CAAC;AAGD,SAAO,GAAG;AAGV,QAAM,sBAAsB,iBAAiB,IAAI,eAAe;AAChE,MAAI,QAAQ,aAAa,YAAY,qBAAqB;AACxD,aAAS,GAAG;AACZA,eAAS,cAAc,KAAK;AAAA,EAC9B;AAGA,aAAW,GAAG;AAEd,QAAM,mBAAmB,iBAAiB,IAAI,YAAY;AAC1D,MAAI,qBAAqB;AAAA,IACvB,aAAa;AAAA,IACb,cAAc;AAAA,EAAA,CACf;AACH;AAEA,IAAI,UAAA,EAAY,KAAK,OAAO;AAE5B,IAAI,GAAG,QAAQ,YAAY;AACzB,QAAM,QAAA;AACR,CAAC;AAED,IAAI,GAAG,qBAAqB,YAAY;AACtC,QAAM;AAEN,MAAI,QAAQ,aAAa,YAAYA,WAAS,YAAY;AACxD,QAAI,KAAA;AAAA,EACN;AACF,CAAC;AAED,IAAI,GAAG,mBAAmB,MAAM;AAC9B,MAAI,KAAK;AAEP,QAAI,IAAI,YAAA;AACN,UAAI,QAAA;AAEN,QAAI,MAAA;AAAA,EACN;AACF,CAAC;AAED,IAAI,GAAG,eAAe,MAAM;AAC1BA,aAAS,cAAc,IAAI;AAC7B,CAAC;AAED,IAAI,GAAG,YAAY,MAAM;AACvB,QAAM,aAAa,cAAc,cAAA;AACjC,MAAI,WAAW,QAAQ;AACrB,eAAW,CAAC,EAAE,KAAA;AACd,eAAW,CAAC,EAAE,MAAA;AAAA,EAChB,OAAO;AACL,QAAI,KAAK;AACP,UAAI,KAAA;AAAA,IACN,OAAO;AACL,mBAAA;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAGD,QAAQ,OAAO,YAAY,CAAC,GAAG,QAAQ;AACrC,QAAM,cAAc,IAAI,cAAc;AAAA,IACpC,gBAAgB;AAAA,MACd;AAAA,MACA,iBAAiB;AAAA,MACjB,kBAAkB;AAAA,IAAA;AAAA,EACpB,CACD;AAED,MAAI,qBAAqB;AACvB,gBAAY,QAAQ,GAAG,mBAAmB,IAAI,GAAG,EAAE;AAAA,EACrD,OAAO;AACL,gBAAY,SAAS,WAAW,EAAE,MAAM,KAAK;AAAA,EAC/C;AACF,CAAC;","x_google_ignoreList":[1,7,8,9,10,11,12,13,14,15,16,17,18,19,27,28,29,30,31,32,33,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64]}